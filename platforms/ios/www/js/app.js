"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Registrar(e){this.$state=e,this.currentStepIndex=0,this.resolveStepIndex()}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tb(){}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var MODULE_NAME="pyc",BRAND_COLOR="#285d63",ENABLE_BUGSNAG=!1;angular.module(MODULE_NAME,["akoenig.deckgrid","angulartics","angulartics.debug","angulartics.google.analytics","cfp.loadingBar","easypiechart","LocalStorageModule","mp.autoFocus","ngAnimate","ngCordova","ngMaterial","ngMorph","ngResize","ngRoute","ngStorage","ng-timeago","oc.lazyLoad","pusher-angular","toaster","toolbox.api","toolbox.authenticatable","toolbox.flaggable","toolbox.picturable","toolbox.searchable","ui.bootstrap","ui.router","ui.select","ui.utils","xeditable","wysiwyg.module"]),function(){function e(){return ENABLE_BUGSNAG?function(e,t){try{throw window.hasOwnProperty("Bugsnag")&&void 0!==Bugsnag&&Bugsnag.notifyException(e,{diagnostics:{cause:t}}),e}catch(e){throw e}}:e}angular.module(MODULE_NAME).factory("$exceptionHandler",e),e.$inject=[]}(),function(){function e(e){Pusher.log=function(t){window.console&&window.console.log&&e.config("TESTING").LOG_PUSHER&&(console.groupCollapsed("%cPUSHER","color: #2470B2; font-size: x-small"),console.log(t),console.groupEnd())},window.client=new Pusher(e.config("PUSHER")[e.config("ENV")])}angular.module(MODULE_NAME).run(e),e.$inject=["Helpers"]}(),function(){function e(e){return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"templates/common/app-brand.html",replace:!0}}angular.module(MODULE_NAME).directive("appBrand",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t){function n(){e.app={name:"Pour Your Cup",description:"Pour Your Cup fosters a culture of generosity by making it easier for people to help one another",year:(new Date).getFullYear(),sidebar:{isOffscreen:!0},settings:{isOffScreen:!1},footer:{hidden:!1},theme:{name:"primary",sidebar:"bg-white",sidebarHeader:"bg-primary bg-light",brand:"bg-primary",topbar:"bg-white"}}}function o(){angular.isDefined(t.settings)?e.app=t.settings:t.settings=e.app,e.$watch("app.layout",function(){t.settings=e.app},!0)}var i=this;i.init=n,i.loadAndWatch=o}angular.module(MODULE_NAME).service("AppSettings",e),e.$inject=["$rootScope","$localStorage"]}(),function(){function e(e,t,n,o,i,r,a,s){s.enabled(!1);var c=angular.module("pyc");r.firstPageview(!0),r.withAutoBase(!0),a.TESTING.DISABLE_ANALYTICS&&r.developerMode(!0),t.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|blob|content):|data:image\//),c.controller=e.register,c.directive=t.directive,c.filter=n.register,c.factory=o.factory,c.service=o.service,c.constant=o.constant,c.value=o.value,i.defaults.useXDomain=!0,delete i.defaults.headers.common["X-Requested-With"]}function t(e){var t="285d63",n="5381ac",o="e34e35";e.definePalette("primary",{50:t,100:t,200:t,300:t,400:t,500:t,600:t,700:t,800:t,900:t,A100:n,A200:n,A400:n,A700:n,contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.definePalette("secondary",{50:n,100:n,200:n,300:n,400:n,500:n,600:n,700:n,800:n,900:n,A100:n,A200:n,A400:n,A700:n,contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.definePalette("warn",{50:o,100:o,200:o,300:o,400:o,500:o,600:o,700:o,800:o,900:o,A100:o,A200:o,A400:o,A700:o,contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.theme("default").primaryPalette("primary").accentPalette("secondary").warnPalette("warn")}angular.module(MODULE_NAME).config(e).config(t),e.$inject=["$controllerProvider","$compileProvider","$filterProvider","$provide","$httpProvider","$analyticsProvider","APP_CONFIG","$sceProvider"],t.$inject=["$mdThemingProvider"]}(),function(){function e(e,t,n,o,i,r,a,s,c){function u(){var t=e.frame.forDevicesOfType();e.fixedSidebar="phone"!==t,e.media_query="phone"!==t?t:"tablet",e.isMobile="tablet"===e.media_query}e.pageTitle=function(){return e.app.name+" - "+e.app.description},t.listen(e),e.frame=o.make(n),e.frame.handleResizeEvents(e,function(){u()}),u(),e.isLocal=a.config("API.USE_LOCALLY"),e.serverUrl=a.config("API")[a.config("API.REQUEST_FROM_SERVER")+"_SERVER_URL"],e.networkErrorMessage=a.config("API.NETWORK_ERROR_MESSAGE"),e.setTemporaryAuth=function(t){e.authenticated=t},e.$on("auth::updated",function(){e.authenticated&&e.authenticated.resolveProfilePicPath()}),e.showSettings=!1,e.changeSettings=function(){e.app.settings.isOffScreen=!e.app.settings.isOffScreen},e.setLastViewedCard=function(t){e.lastViewedCard=t},r.globalListeners(e,i),e.trackEvent=function(t,n){a.track(t,n,e.authenticated)},a.bindToScope(e),e.authenticated&&e.authenticated.current_location&&LocationTracker.start(function(t){Log.object("Location Found",angular.copy(t)),Request.api("locations/capture").bind(t).post({success:function(t){e.authenticated.current_location=t.success.data.location},error:function(){}})},3e5),e.closeDeck=function(){},e.updateDeckFilters=function(){$("#closeDeckFilters").trigger("click"),c(function(){e.searchMenu=!1},500),e.$broadcast("changeSettings")},e.morphReferral=s.make("connections.referral-search","closeReferral").build(),e.morphNotification=s.make("notifications.show","closeNotification").build(),e.morphSearch=s.make("decks.filter-search","closeDeckFilters").buildModal()}angular.module(MODULE_NAME).controller("CoreController",e),e.$inject=["$rootScope","Poll","$window","Frame","toaster","feedback","Helpers","LayerMorph","$timeout"]}(),function(){function e(e){function t(){return $(".toast").length>0}function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}var o={success:{},info:{},wait:{method:"loading",title:"Loading..."},error:{title:"Something went wrong...",message:"There was a connection error. Please try again."}};this.globalListeners=function(i,r){var a,s=1e3;_.each(o,function(o,c){var u=(o.method?o.method:c)+"Toast";i[u]=function(e,n){return!e&&o.title&&(e=o.title),!n&&o.message&&(n=o.message),t()&&a===c?void(s+=600):(s-=600,a=c,void("Searching..."==e?r.pop(c,e,n,0):r.pop(c,e,n)))},i["lazy"+n(u)]=function(t,n){e(function(){r.pop(c,t,n)},s)}}),i.clearToast=function(){e(function(){"wait"===a&&r.clear()},s)}}}angular.module(MODULE_NAME).service("feedback",e),e.$inject=["$timeout"]}(),function(){function e(e,t){function n(e,t,n){e.channel=window.client.subscribe("users."+t.user_id+"."+e.suffix),e.channel.bind(e.eventName,function(t){e.handle(t,n)})}function o(e){e.channel=null}var i=[{suffix:"messages",eventName:"Toolbox\\Communicatable\\Events\\NewMessageSent",handle:function(e,t){t.lazySuccessToast("New Message from "+e.sender.goes_by,e.message.content),t.$state.is("app.mailbox.show")&&t.$stateParams.conversationId===e.conversation.conversation_id&&t.$broadcast("message_received",{message:e.message})}},{suffix:"notifications",eventName:"Toolbox\\Notifiable\\Events\\NewNotificationSent",handle:function(e,t){t.lazySuccessToast("New Notification",e.message),(t.$state.is("app.notifications")||t.$state.is("app.notifications.show"))&&t.$broadcast("notification_received")}},{suffix:"unread",eventName:"App\\Events\\UserUnreadAccountChanged",handle:function(t,n){e(function(){MobileDevice.current.updateBadgeNumber(t.user.notifiers.new_messages+t.user.notifiers.new_notifications),n.authenticated.notifiers=angular.copy(t.user.notifiers)})}}];this.listen=function(e,t){for(var r=e?n:o,a=0,s=i.length;a<s;a++)r(i[a],e,t)}}angular.module(MODULE_NAME).service("notifier",e),e.$inject=["$timeout","$rootScope"]}(),function(){function e(e,t,n,o,i,r,a,s,c,u,l,d){function f(e){n(function(){try{window.hasOwnProperty("Bugsnag")&&"undefined"!==Bugsnag&&e(Bugsnag)}catch(t){console.log(t)}})}function p(e){var t={height:e,overflow:"hidden"};$("html").css(t),$("body").css(t),$(".modal.fade").css({height:e}),$("#create-referral-container").css({height:e})}e.$state=t,e.$stateParams=i,e.cordovaSet=!1,App.make(MODULE_NAME,{$scope:e,$injector:r,$state:t,$stateParams:i,$http:a,config:{APP:s,LOCATION:c}}),u.init(),f(function(e){e.releaseStage=l.config("ENV").toString(),e.notifyReleaseStages=["production"]}),MobileDevice.boot(),MobileDevice.current.onLoad(function(t){function i(e){p(s)}function r(e){p(s-e.keyboardHeight),n(function(){var t=$(":focus"),n=$("[handle-keyboard]");n&&(t.toggleClass("force-redraw"),a=o(function(){t.toggleClass("force-redraw")},100),n.animate({scrollTop:t.offset().top-(s-e.keyboardHeight-120)},500,function(){t.toggleClass("force-redraw"),a.invalidate(),a=null}))})}if(f(function(e){e.metaData={device:t.info()}}),t.registerForPushNotifications(),t.isAppleDevice()){t.disableKeyboardAutoScroll();var a,s=$("html").height();window.addEventListener("native.keyboardshow",r),window.addEventListener("native.keyboardhide",i),$(document).click(function(e){var n=t.cordovaKeyboard();n&&n.isVisible()&&document.activeElement.blur()})}e.cordovaSet=!0,window.prompt=function(e){return d.prompt(e,null)}})}angular.module(MODULE_NAME).run(e),e.$inject=["$rootScope","$state","$timeout","$interval","$stateParams","$injector","$http","APP_CONFIG","LOCATION_CONFIG","AppSettings","Helpers","$cordovaDialogs"]}();var LOCAL_MAC_SERVER_URL="http://192.168.0.24:8000",LOCAL_PC_SERVER_URL="http://192.168.0.37:8000",DEVELOPMENT_SERVER_URL="http://52.3.20.243";!function(){angular.module(MODULE_NAME).constant("APP_CONFIG",{ENV:"production",PUSHER:{development:"4a68d9269774bec074af",production:"4a68d9269774bec074af",staging:"4a68d9269774bec074af"},NOTIFICATIONS:{ANDROID_SENDER_ID:"385232377982"},API:{USE_LOCALLY:!1,REQUEST_FROM_SERVER:"PRODUCTION",PRODUCTION_SERVER_URL:"https://pouryourcup.com",LOCAL_SERVER_URL:LOCAL_PC_SERVER_URL,URL:"/api/v1/",NETWORK_ERROR_MESSAGE:"There was a connection error. Please try again."},PATHS:{BASE_URL:"app/",VIEWS:"views/",IMAGES:"img/",LOGO_IMAGE:"logo-intro.png"},TESTING:{ENABLE_TEMPLATE_CACHE:!0,LOG_PUSHER:!1,HIDE_API_REQUESTS:!0,HIDE_APP_NAVIGATION:!0,DISABLE_ANALYTICS:!1,DISABLE_WALKTHROUGHS:!0,ALWAYS_SHOW_WALKTHROUGHS:!1}})}(),function(){angular.module(MODULE_NAME).constant("LOCATION_CONFIG",{REQUIRED:{CITY:!0,STREET_ADDRESS:!0,ALL:!1}})}(),function(){angular.module(MODULE_NAME).constant("MEDIA_QUERY",{desktopLG:1300,desktop:1e3,tablet:768,mobile:480})}(),function(){angular.module(MODULE_NAME).constant("MIDDLEWARE_CONFIG",{ACTIVATE:!0,AUTH_CLASS:"User",DEFAULT_STATUS:"guest",RULES:{guest:{DEFAULT_STATE:"guest.intro",APPLIES:function(e){return!e||!e.hasOwnProperty("user_id")}},invalidEmail:{DEFAULT_STATE:"requireEmail",APPLIES:function(e){return!e.default_email}},unverified:{DEFAULT_STATE:"verify",APPLIES:function(e){return!e.settings.is_verified}},unregistered:{DEFAULT_STATE:"register",APPLIES:function(e){return!e.settings.is_registered}},auth:{DEFAULT_STATE:"app.decks",APPLIES:function(e){return e.hasOwnProperty("user_id")&&e.settings.is_verified&&e.settings.is_registered}}}})}(),function(){function e(){return function(e,t){return e.length>t?e.substr(0,t)+"...":e}}angular.module(MODULE_NAME).filter("ellipsis",e),e.$inject=[]}(),function(){angular.module(MODULE_NAME).filter("htmlToPlainText",function(){return function(e){return e?String(e).replace(/<[^>]+>/gm,""):""}})}(),function(e){return e.module(MODULE_NAME).filter("orderObjectBy",function(){return function(t,n,o){function i(e){return!isNaN(parseFloat(e))&&isFinite(e)}function r(e,t){return e[t]}var a=[];return e.forEach(t,function(e,t){e.key=t,a.push(e)}),a.sort(function(e,t){var o,a=n.split(".").reduce(r,e),s=n.split(".").reduce(r,t);return i(a)&&i(s)&&(a=Number(a),s=Number(s)),o=a===s?0:a>s?1:-1}),o&&a.reverse(),a}})}(angular),function(){function e(e){return{restrict:"A",link:function(t,n,o){t.$watch(e.parseAsHtml(o.ngTrustHtml),function(e){n.html(e||"")})}}}angular.module(MODULE_NAME).directive("ngTrustHtml",e),e.$inject=["$sce"]}(),function(){function e(e){return function(t){return e.trustAsResourceUrl(t)}}angular.module(MODULE_NAME).filter("trustUrl",e),e.$inject=["$sce"]}(),function(){function e(){return function(e){return e=e||"",e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}}angular.module(MODULE_NAME).filter("titlecase",e)}(),function(){function e(e,t){e.containerClass={container:t.is("app.settings.terms")||t.is("app.settings.privacy")||t.is("guest.privacy.mobile-index")||t.is("guest.privacy")},e.leave=function(){t.is("app.settings.terms")||t.is("app.settings.privacy")?t.go("app.settings"):t.is("register.terms")||t.is("register.privacy")?t.go("register.info"):t.is("guest.privacy")&&t.go("guest.intro")}}angular.module(MODULE_NAME).controller("LegalController",e),e.$inject=["$scope","$state"]}(),function(){function e(e,t,n){t.otherwise("/loading"),e.state("loading",{url:"/loading",views:{app:{templateUrl:n.base("layout/loading.html"),loading:!0}}}).state("add-email-from-invitation",{url:"/add-email-from-invitation/:invitationId/:emailAddress",views:{app:{templateUrl:n.base("add-email-from-invitation.html"),controller:"AddEmailFromInviteController"}},navigation:{uses_menu_drawer:!0}}).state("app.transition",{url:"transition/:destination/:paramName/:paramValue",controller:function(e,t){var n={};n[t.paramName]=t.paramValue,e.go(t.destination,n)}}).state("verify",{url:"/verify",views:{app:{templateUrl:n.base("guest/email-verification/index.html"),controller:"EmailVerificationController"}},middleware:"unverified"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","$urlRouterProvider","RouteProvider"]}(),function(){function e(e){this.base=function(t){return e.PATHS.VIEWS+t},this.require=function(){var e=arguments;return["$ocLazyLoad","$q",function(t,n){function o(e){if("function"==typeof e)return i.then(e)}for(var i=n.when(1),r=0,a=e.length;r<a;r++)i=o(e[r]);return i}]},this.splitForMobile=function(e,t,n,o){o||""==o||(o="content@app");var i={};return i[o]={templateUrl:this.base(e+"/container.html")},void 0!==n&&"string"==typeof n&&(i[o].controller=n),i["desktop@"+t]={templateUrl:this.base(e+"/desktop-index.html")},i["mobile@"+t]={templateUrl:this.base(e+"/mobile-index.html")},i["settings@app"]={template:""},i},this.$get=function(){}}angular.module(MODULE_NAME).provider("Route",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n,o,i){n.TESTING.ENABLE_TEMPLATE_CACHE||t.activate(),e.$on("$stateChangeStart",function(t,n,o,i,r){e.clearToast()}),e.$on("auth::updated",function(){i.listen(e.authenticated,e);try{window.hasOwnProperty("Bugsnag")&&"undefined"!==Bugsnag&&(Bugsnag.user=e.authenticated)}catch(t){console.log(t)}}),e.resetNotifiers=function(){e.newMessages=!1,e.newNotifications=!1},e.resetNotifiers()}angular.module(MODULE_NAME).run(e),e.$inject=["$rootScope","cacheDisabler","APP_CONFIG","$analytics","notifier"]}(),function(){angular.module(MODULE_NAME).constant("METRICS_TEXT",{MAP_INFO:["The map displays the impact you've made - the ripple effect of your help and referrals - through six degrees of separation. ","Gratitude measure the ripple effect of the help you've given to others. The lines indicate members saying thank you to each other. Red lines indicate the gratitude that you've received and change to yellow the further away from you that gratitude is exchanged.","Reach measures the ripple effect of your referrals. The lines indicate successful connections between members that were referred to one another. Green indicates connections more directly related to your referrals and change to blue the further away from you that successful referrals are made."]})}(),function(){angular.module(MODULE_NAME).constant("MISC_TEXT",{REGISTRATION_WELCOME:["Pour Your Cup fosters a culture of generosity by making it easier for people to help one another"]})}(),function(){angular.module(MODULE_NAME).constant("PROFILE_TEXT",{IMAGE:"They say a picture tells a thousand words. Select a picture that captures the real you. Remember that others may see something in you that you don’t see yourself. Candid, full-length photos might work well.",NETWORKS:"Networks are communities that you may belong to or have some affiliation with. The schools you went to, current or previous employers, clubs, associations, and charitable and volunteer organizations are examples of networks. Selecting networks that are important to you can help you find others with common affiliations and for them to find you. You can add and delete networks later.",COULD_OFFER:{TITLE:" someone help with...",INFO:"We all have things that we’re good at and love to do. Sharing them might make someone’s life a little bit better. Don’t worry, no one will contact you unless you choose one another. You can always change it later."},COULD_USE:{TITLE:" some help with...",INFO:"Everyone could use a little assistance every now and then. What is something you could use that might make your life a little better or a little easier? Don’t worry. No one will contact you unless you choose one another. You can always change it later."}})}(),function(){angular.module(MODULE_NAME).constant("PYC_TEXT",{TITLE:"Pour Your Cup",SLOGAN:"The MicroGenerosity app for the Generosity Economy"})}(),function(){angular.module(MODULE_NAME).constant("SETTINGS_TEXT",{POUR_MORE:{BENEFICIARY:"Share some love (and dollars) with your favorite non-profit institutions and organizations. Each time you view an ad, you have the option to share advertising revenue with the non-profit of your choice by clicking on the heart icon. Or just click on the gift box to give directly using <b>Paypal</b>."}})}(),function(){angular.module(MODULE_NAME).constant("WALKTHROUGHS_TEXT",{APP:{WELCOME:"Welcome to PYC",PROFILE:"Edit your profile and settings",DECKS:"Find and connect with others",CONNECTIONS:"View all your connections",METRICS:"See how far your reach goes",CONVERSATIONS:"View your conversations or create new ones",NOTIFICATIONS:"View notifications for new connections and thankyous",FINISH:{TITLE:"Select from the list of decks to get started.",CONTENT:'Each deck has filters to help you find users with similar networks, interests, or location. If you aren\'t sure where to start, click on the "Recommended" deck.'}},CARDS:{START:"Let's Start Connecting",CARD:{DESKTOP:"Here you can view profiles of other users.",MOBILE:"Swipe through profiles and details of other members."},CARD_BUTTONS:{DESKTOP:"Make a connection or refer a friend to connect.",MOBILE:"If you find someone you can help or be helped by, click Connect. Or if you know someone else that can, click Refer"},FILTERS:"Use filters to search for others with things in common.",FINISH:{TITLE:"You're All Set",CONTENT:"Swipe Through to Start Connecting. It's Okay to Swipe Right or Left"}}})}(),function(){function e(e,t){var n=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);n&&e.infoToast("You are using Safari Web Browser. Please ensure pop-up blocking is disabled to access all content on Pour Your Cup.");var o=$("header")[0].clientHeight,i=angular.element("ul.nav").querySelectorAll("li").length-1;e.dynamicHeight=function(){var e=t.innerHeight-o,n=e-75*i-20;return{height:Math.max(n,130),width:"100%",position:"relative"}}}angular.module(MODULE_NAME).controller("SidebarAdsController",e),e.$inject=["$scope","$window"]}(),function(){function e(e,t){this.activate=function(){e.$on("$viewContentLoaded",function(){t.remove("templates/*")})}}angular.module(MODULE_NAME).service("cacheDisabler",e),e.$inject=["$rootScope","$templateCache"]}(),function(){function e(e,t){function n(e){this.url=e,this.isRelative="/"===e[0]}function o(t,n,o,i){void 0!==n&&t.$on("$cordovaInAppBrowser:loadstart",function(t,o){var i=n(o.url.toString(),o);i===!1&&e.close()}),void 0!==o&&t.$on("$cordovaInAppBrowser:loadstart",function(t,o){var i=n(o.url.toString(),o);i===!1&&e.close()}),t.$on("$cordovaInAppBrowser:loaderror",function(i,r){if(void 0!==o){var a=n(r.url.toString(),r);a===!1&&e.close()}else e.close(),t.errorToast()}),void 0!==i&&t.$on("$cordovaInAppBrowser:exit",function(e,t){i(t.url.toString(),t)})}return n.prototype.open=function(e){return e?this.cordovaBrowser():this.webBrowser()},n.prototype.webBrowser=function(){if(this.isRelative)t.location.replace(this.url);else{var e=t.open(this.url,"_blank");e.focus()}},n.prototype.cordovaBrowser=function(t,n,i,r){e.open(this.url,"_blank",{location:"no",clearcache:"yes",toolbar:"no"}).then(function(e){console.log(e)})["catch"](function(e){console.log(e)}),void 0!==t&&o(t,n,i,r)},n.prototype.cordovaBrowserWithNoCache=function(t,n,i,r){e.open(this.url,"_blank",{location:"no",clearcache:"no",toolbar:"no"}).then(function(e){console.log(e)})["catch"](function(e){console.log(e)}),void 0!==t&&o(t,n,i,r)},n.make=function(e){return new n(e)},n}angular.module(MODULE_NAME).service("ExternalLink",e),e.$inject=["$cordovaInAppBrowser","$window"]}(),function(){function e(e,t){function n(e){this.window=e,r=this.height()}function o(t){switch(!0){case t<=e.tablet:default:return"phone";case t>e.tablet&&t<=e.desktop:return"tablet";case t>e.desktop&&t<=e.desktopLG:return"desktop";case t>e.desktopLG:return"lgDesktop"}}var i=50,r=0,a="phone";return n.prototype.navbarHeight=function(){return 0!=$(".navbar").length?$(".navbar")[0].clientHeight:0},n.prototype.height=function(){return this.window.innerHeight},n.prototype.width=function(){return this.window.innerWidth},n.prototype.containerHeight=function(e,t){void 0===e&&(e=i);var n=this.window.innerHeight;return t||this.isMobile()||(e=0),n-e-this.navbarHeight()},n.prototype.containerStyling=function(e){return{minHeight:this.containerHeight(e)}},n.prototype.isMobile=function(){return"tablet"===a||"phone"===a},n.prototype.forDevicesOfType=function(){return a},n.prototype.handleResizeEvents=function(e,t){a=o(this.width()),t();var n=this;angular.element(this.window).bind("resize",function(i){a=o(n.width()),t(),n.height()<r?$(".fixed-bottom").hide():$(".fixed-bottom").show(),e.$digest()})},n.make=function(e){return new n(e)},n}angular.module(MODULE_NAME).factory("Frame",e),e.$inject=["MEDIA_QUERY","$timeout"]}(),function(){function e(e,t,n,o,i,r){var a={};return a.arrayGet=function(e,t){var n=e,o=t.split(".");for(var i in o){if(!n.hasOwnProperty(o[i]))return;n=n[o[i]]}return n},a.config=function(t){return a.arrayGet(e,t)},a.view=function(t){return e.PATHS.VIEWS+t.replace(/\./g,"/")+".html"},a.text=function(e){var t=e.split("."),n=r.get(t[0]+="_TEXT");return t.shift(),a.arrayGet(n,t.join("."))},a.image=function(t){return e.PATHS.IMAGES+t},a.modal=function(e,t,i,r){o.set(t);var s=a.view(e),c=n.open({templateUrl:s,controller:"ModalController"});c.result.then(function(){i()},function(){void 0!==r&&r()})},a.alert=function(e,t){var n=r.get("AlertDialog");return n.make(e,t)},a.go=function(e,n){return t.go(e,n)},a.back=function(){window.history.back()},a.cancel=function(e){e.preventDefault(),e.stopPropagation()},a.track=function(e,t,n){return i.setAlias(n.user_id),i.setUsername(n.first_name+n.last_name),i.eventTrack("App Event",{category:e,label:t})},a.absolute=function(e){return e.indexOf("http")==-1&&(e="http://"+e),e},a.bindToScope=function(e){e.$config=a.config,e.$text=a.text,e.$view=a.view,e.$image=a.image,e.$modal=a.modal,e.$alert=a.alert,e.$go=a.go,e.$back=a.back,e.$cancel=a.cancel,e.$absolute=a.absolute},a}angular.module(MODULE_NAME).service("Helpers",e),e.$inject=["APP_CONFIG","$state","$modal","modalWindowData","$analytics","$injector"]}(),function(){function e(e){function t(){}function n(e,t){_.forIn(e,function(e,n){_.forEach(e,function(e){$(document.body).on(e,n,function(){a&&t()})})})}var o,i,r,a=!1,s=!1;return document.addEventListener("deviceready",function(){a=!0,o&&o()}),n({input:["focus","keyup"],textarea:["focus","keyup"]},function(){s=!0,i&&i()}),n({input:["blur"],textarea:["blur"]},function(){s=!1,r&&r()}),t.prototype.onLoad=function(e){o=e,a&&e()},t.prototype.onToggleSoftKeyboard=function(e,t){i=e,r=t},t.prototype.info=function(){return{device:e.getDevice(),cordova:e.getCordova(),model:e.getModel(),platform:e.getPlatform(),uuid:e.getUUID(),version:e.getVersion()}},t.prototype.hasLoaded=function(){return a},t.prototype.isAppleDevice=function(){return"platform: iOS"===e.getPlatform()},t.prototype.isShowingKeyboard=function(){return s},t.setup=function(){return new t},t}angular.module(MODULE_NAME).factory("MobileDevice",e),e.$inject=["$cordovaDevice"]}(),function(){function e(e,t,n){return this.listen=function(e){n(function(){},2e3);var o=this;t.on("pollResponse",function(t){o.handleResponse(e,t.message)})},this.handleResponse=function(t,n){e.post(t,"poll-response",n,function(e){})},this}angular.module(MODULE_NAME).service("Poll",e),e.$inject=["APIPostService","$document","$timeout"]}(),function(){function e(e){var t;this.fetch=function(){return t=e.getFromServer("connections").success(function(e){if(e.hasOwnProperty("success")&&e.success.hasOwnProperty("data")&&e.success.data.hasOwnProperty("connections"))return e.success.data.connections})},this.all=function(){return t&&t.status?t:this.fetch()},this.get=function(e){return t||(t=this.fetch()),t.success(function(t){if(t=t.success.data.connections,!t)return null;for(var n=0;n<t.length;n++)if(t[n].user_id==e)return t[n];return null})},this.clear=function(){t=null},this.findStateParamForConversation=function(e){return e.conversation&&"create"!==e.conversation?e.conversation:"create-"+e.user_id}}angular.module(MODULE_NAME).service("connectionsFactory",e),e.$inject=["APIFactory"]}(),function(){function e(){function e(e,t,n,o){this.type=e,this.referredUser=t,this.email=n,this.message=o}var t=500;return e.prototype.hasType=function(){return void 0!==this.type},e.prototype.formMessage=function(){return"email"===this.type?"Enter the email address of the person to whom you would like to refer "+this.referredUser.name+".":"Refer "+this.referredUser.name+" to connect to "+this.otherUser.name+"?"},e.prototype.setOtherUser=function(e){this.otherUser=e},e.prototype.postCreateAPIRoute=function(){return"users/"+this.referredUser.user_id+"/refer"+("email"===this.type?"/email":"")},e.prototype.formattedPostData=function(){var e={};return void 0!==this.otherUser&&(e.user_id=this.otherUser.user_id),this.email&&this.email.length&&(e.email=this.email),this.message&&this.message.length&&(e.message=this.message),e},e.prototype.restrictMessageLength=function(){this.message&&this.message.length>t&&(this.message=this.message.substring(0,t))},e.prototype.charactersLeft=function(){return this.message?t-this.message.length:t},e.prototype.charactersLeftMessage=function(){var e=this.charactersLeft();return(e?e:"No")+" character"+(1!==e?"s":"")+" left"},e.prototype.requiresEmail=function(){return"email"===this.type||this.requiresEmailForValidation()},e.prototype.requiresEmailForValidation=function(){return"create"===this.type&&!this.referredUser.isConnected},e.blank=function(){return new e((void 0),(void 0),"","")},e.make=function(t,n,o,i){return new e(t,n,o,i)},e}angular.module(MODULE_NAME).factory("Referral",e),e.$inject=[]}(),function(){function e(e){function t(e){for(var t in e)this[t]=e[t]}return t.prototype.hasLinks=function(){if(!this.hasOwnProperty("links"))return!1;for(var e in this.links)if(this.links.hasOwnProperty(e))return!0;return!1},t.prototype.showRequestToJoinForm=function(e,t){e.request={};var n={group:this,request:e.request};e.$modal("group-requests.join-modal",n,function(){e.trackEvent("Private Group Request To Join",e.authenticated.default_email),t(e.request)},function(){e.request={}})},t.prototype.iconClassForLink=function(e){switch(e){case"facebook":return"fa-facebook-square";case"googleplus":return"fa-google-plus-square";case"linkedin":return"fa-linkedin-square";case"twitter":return"fa-twitter-square";case"website":return"fa-external-link-square"}return!1},t.build=function(e){return new t(e)},t}angular.module(MODULE_NAME).service("Group",e),e.$inject=["APIPostService"]}(),function(){function e(e){this.getSlug=function(t){return e.quickGet("groups/"+t+"/match-slug").then(function(e){if(e.success.data.hasOwnProperty("group_slug"))return e.success.data.group_slug})}}angular.module(MODULE_NAME).service("groupsFactory",e),e.$inject=["apiFactory"]}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Deck=function(){function e(){_classCallCheck(this,e),this.owner=ngTB.app("angular.$scope").authenticated,this.presets=tb.collect({}),this.filters={}}return _createClass(e,[{key:"load",value:function(t,n){var o=this;Request.api("decks").get({success:function(n){o.presets=tb.collect(n.presets).transform(function(e){return PresetDeck.make(e)}).keyBy("slug"),o.defaultFilters=tb.collect(n.filters).transform(function(e,t){return DeckFilter.make(t,e)}).all(),o.filters=angular.copy(o.defaultFilters),e.loaded=!0,t(o)}})}},{key:"getPresets",value:function(e,t){this.presets.isEmpty()&&this.load(function(t){e(t.presets)}),e(this.presets)}},{key:"clearFilters",value:function(){this.filters=angular.copy(this.defaultFilters)}},{key:"selectPreset",value:function(e){var t=this;tb.collect(e.settings).each(function(e,n){var o=t.filters[n];o?tb.reflect(e).isNumber()?o.is_active=1==e:tb.collect(e).each(function(e,t){o.options[t].is_active=1==e.is_active;
}):o={is_active:e},t.filters[n]=o})}},{key:"selectOption",value:function(e,t){this.filters[t.filter].options[t.key].is_active=!0}},{key:"updateFilter",value:function(e,t,n){this.filters.recommended&&delete this.filters.recommended,this.filters[t]||(this.filters[t]={}),n?(this.filters[t].options||(this.filters[t].options={}),this.filters[t].options[n.key]||(this.filters[t].options[n.key]=n),this.filters[t].options[n.key].is_active=e):this.filters[t].is_active=e}},{key:"controllableFilters",value:function(){return tb.collect(this.filters).filter(function(e){return e.name})}},{key:"filterParams",value:function(){var e={};return tb.collect(this.filters).each(function(t,n){if(t.hasOwnProperty("is_active"))t.is_active&&(e[n]=1);else{var o=tb.collect(t.options).filter(function(e){return e.is_active}).pluck("key");o.isEmpty()||(e[n]=o.all())}}),e}},{key:"addCards",value:function(e){Request.api("cards").bind(this.filterParams()).get({success:function(t){e(tb.collect(t.hasOwnProperty("cards")?t.cards:[]))},error:function(){this.locked=!1}})}}],[{key:"current",value:function(){if(void 0===e.session){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];e.session=new(Function.prototype.bind.apply(e,[null].concat(n)))}return e.session}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),DeckFilter=function(){function e(t,n){_classCallCheck(this,e),this.key=t;for(var o in n)this[o]=n[o];this.hasOptions()?tb.collect(this.options).each(function(e){e.is_active=!1}):this.is_active=!1}return _createClass(e,[{key:"hasOptions",value:function(){return this.options&&!tb.collect(this.options).isEmpty()}}],[{key:"make",value:function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return new(Function.prototype.bind.apply(e,[null].concat(n)))}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),PresetDeck=function(){function e(t){_classCallCheck(this,e);for(var n in t)this[n]=t[n]}return _createClass(e,[{key:"disabledErrorMessage",value:function(){return this.disabled_message}},{key:"select",value:function(){Deck.current().selectPreset(this)}},{key:"selectOption",value:function(e){Deck.current().selectOption(this,e)}},{key:"hasOptions",value:function(){return this.options&&this.options.length>0}},{key:"optionKey",get:function(){if(this.hasOptions()){var e=void 0;return tb.collect(this.options[0]).each(function(t,n){n.indexOf("id")===n.length-"id".length&&(e=n)}),e}}},{key:"cssClass",get:function(){return this.theme.icon+" text-"+this.theme.color}}],[{key:"make",value:function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return new(Function.prototype.bind.apply(e,[null].concat(n)))}},{key:"selectionGrid",value:function(e){angular.element(document).ready(function(){$(".carddeck").each(function(t,n){e(t,n)})})}},{key:"showAll",value:function(t){ngTB.time().delay(function(){e.selectionGrid(function(e,n){$(".carddeck").each(function(e,t){var n=.5+.1*e;$(t).animo({animation:"fadeInUp",duration:n,timing:"ease-in-out",keep:!1})}),!!t&&t()})},.2)}},{key:"hideAll",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.selectionGrid(function(e,o){var i=.5,r="fadeOut",a=void 0;n!==!1&&(i+=.1*e,r="fadeOutDownBig",a=function(){$("#"+n).animo({animation:r,duration:1,keep:!0},function(){t()})}),$(o).attr("id")!==n&&$(o).animo({animation:r,duration:i,keep:!0},function(){a?a():t()})})}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),PresetSelectionBackBtn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"exists",value:function(){return this.el.length>0}},{key:"reset",value:function(){this.el.animo("cleanse")}},{key:"show",value:function(){this.fade({animation:"fadeInUp",timing:"ease-in-out",keep:!1})}},{key:"hide",value:function(){this.fade({animation:"fadeOutDownBig",keep:!0})}},{key:"fade",value:function(e){this.exists()&&(this.reset(),e.duration=.5,this.el.animo(e))}},{key:"el",get:function(){return $("#goBack")}}],[{key:"resolve",value:function(){return new e}}]),e}();!function(e){function t(e,t){e.help={subject:null,message:null},e.subjectOptions=["I have a question","I'm having technical issues","I'd like to leave feedback","Other"],e.submitHelpForm=function(){t.post(e,"poll-response",e.help,function(t){e.lazySuccessToast("Thanks! We received your message and will be in touch."),e.$state.go("app.decks")})}}e.module(MODULE_NAME).controller("HelpController",t),t.$inject=["$scope","APIPostService"]}(angular),function(){function e(e,t,n,o){return{restrict:"E",scope:!1,templateUrl:t.PATHS.VIEWS+"templates/interests/interests-form.html",link:function(t,i,r){function a(e,n){var o=[];if(e!=[]&&e.hasOwnProperty("interests")&&(o=angular.copy(e.interests)),n&&s(o,n)){var i=t.frame.isMobile()?"Tap here to add":"Press enter to add";t.customInterest={interest_id:null,name:_.startCase(n),hint:"<i>"+i+" <b>"+_.startCase(n)+"</b>...</i>"},o.unshift(t.customInterest)}else t.customInterest="";var r=_.map(t.currentInterests,"name");return _.filter(o,function(e){return _.indexOf(r,e.name)===-1})}function s(e,t){return!_.includes(_.map(e,"name"),_.startCase(t))}function c(){return angular.copy(t.editingAuthenticated.interests_list||[])}var u=r.formType?r.formType:"edit",l=!!t.editingAuthenticated;switch(console.log("EDITING "+l),u){default:case"edit":t.formTitle="Edit Interests";break;case"add":t.formTitle="Add Interests"}t.tabIndex=0,t.currentInterests=c(),t.search="",t.hasChangedInput=!1,t.interestsResults=[],t.interestsForQuery=function(){n.search(t,"search","interests/search",function(e){t.interestsResults=a(e,t.search),t.tabIndex=0})},t.handleKeyPress=function(e){return 13===e.which?(t.tabIndex>=0&&t.tabIndex<=t.interestsResults.length-1&&t.addInterest(t.interestsResults[t.tabIndex]),e.preventDefault(),!1):38===e.which?(e.preventDefault(),t.tabIndex>0&&t.tabIndex--,!1):40===e.which?(e.preventDefault(),t.tabIndex<t.interestsResults.length-1&&t.tabIndex++,!1):void 0},t.saveInterests=function(){l?t.$parent.finishEditing():t.$parent.closeMenu(0)},t.removeInterest=function(e){o(function(){t.currentInterests.splice(t.currentInterests.indexOf(e),1),t.formatUserInterests()})},t.addInterest=function(e){o(function(){t.currentInterests.push(e),t.search="",t.interestsResults=[],t.formatUserInterests()})},t.formatUserInterests=function(){t.hasChangedInput=!0,t.editingAuthenticated.interests_list=_.sortBy(t.currentInterests,"name"),t.editingAuthenticated.interests=_.map(t.currentInterests,"name").join(", "),e.$broadcast("profile_info_changed")},t.interestsForQuery()}}}angular.module(MODULE_NAME).directive("interestsForm",e),e.$inject=["$rootScope","APP_CONFIG","APISearchService","$timeout"]}(),function(){function e(e,t,n){function o(e,t){var n=[];e!=[]&&e.hasOwnProperty("interests")&&(n=angular.copy(e.interests)),t&&i(n,t)&&n.unshift({interest_id:null,name:_.startCase(t),hint:"<i>Press enter to add <b>"+_.startCase(t)+"</b>...</i>"});var o=_.map(a,"name");return _.filter(n,function(e){return _.indexOf(o,e.name)===-1}).concat(a)}function i(e,t){return!_.includes(_.map(e,"name"),_.startCase(t))}e.interests=[],e.searchQuery="";var r,a=e.editingAuthenticated.interests_list,s=[];e.interestsForQuery=function(i){r&&t.cancel(r),e.interestsResults=o(s,i),r=t(function(){n.get(e,i,"interests/search",function(t){e.interestsResults=o(t,i)},{interests:a})},500)},e.formatUserInterests=function(t){a=t.interests_list,e.$parent.editingAuthenticated.interests_list=_.sortBy(t.interests_list,"name"),e.$parent.editingAuthenticated.interests=_.map(t.interests_list,"name").join(", "),"function"==typeof e.$parent.inputHasChanged&&e.$parent.inputHasChanged()},e.interestsForQuery()}angular.module(MODULE_NAME).controller("SearchInterestsController",e),e.$inject=["$scope","$timeout","APISearchService"]}(),function(){function e(){var e=this;return e.build=function(t,n,o){var i={name:void 0===o?e.getName(t):t.name,email:null,phone:null,image:n};return o?(i.email=t.email,i):(t.emails&&t.emails.length&&(i.email=t.emails[0].value),t.phoneNumbers&&t.phoneNumbers.length&&(i.phone=t.phoneNumbers[0].value),t.photos&&t.photos.length&&(i.image=t.photos[0].value),i)},e.getName=function(e){var t=e.displayName;return t?t:e.name.formatted?e.name.formatted:e.name.givenName&&e.name.familyName?e.name.givenName+" "+e.name.familyName:null},e}angular.module(MODULE_NAME).service("ContactsFactory",e),e.$inject=[]}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Location=function(){function e(t,n){if(_classCallCheck(this,e),this.config=ngTB.app().config("LOCATION.REQUIRED"),this.geocode=angular.copy(t),this.geocode.hasOwnProperty("address_components")){if(n)for(var o in n)this[o]=n[o];for(var i={street_number:"street_number",route:"street",locality:"city",administrative_area_level_1:"state_province",country:"country",postal_code:"zip"},r=this.geocode.address_components,a=0,s=r.length;a<s;a++)i.hasOwnProperty(r[a].types[0])&&(this[i[r[a].types[0]]]=r[a].short_name);this.hasOwnProperty("street_number")&&(this.street=this.street_number+" "+this.street),""===this.name&&(this.name=this.city+", "+this.state_province),this.latitude=this.geocode.geometry.location.lat(),this.longitude=this.geocode.geometry.location.lng()}}return _createClass(e,[{key:"isValid",value:function(){if(this.geocode.hasOwnProperty("address_components")){if(this.config.ALL&&this.geocode.length>0)return!0;if(!this.geocode.hasOwnProperty("address_components")||!this.geocode.address_components.length>0)return this.error=e.ErrorNotSelected,!1;var t="city";return!!this.hasOwnProperty(t)||(this.error=e.ErrorNotSpecific,!1)}}}],[{key:"make",value:function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return new(Function.prototype.bind.apply(e,[null].concat(n)))}}]),e}();Location.ErrorNotSelected=0,Location.ErrorNotSpecific=1;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),LocationTracker=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"stop",value:function(){e.runInterval&&(e.$interval.cancel(e.runInterval),e.runInterval=null)}},{key:"start",value:function(t,n){var o=ngTB.app("angular.$injector");if(o){var i=o.get("$interval");e.$interval=i,null!=e.runInterval&&e.stop(),e.run(t),e.runInterval=e.$interval(function(){e.run(t)},n)}}},{key:"run",value:function(t){var n=MobileDevice.current;return e.foundCallback=t,n.loaded?void n.checkForLocationPermission(e.getUserDevicePosition,null):e.getUserPosition()}},{key:"getUserDevicePosition",value:function(){var t=MobileDevice.current,n=t.cordovaGeolocation();return n?void n.getCurrentPosition({timeout:1e4,enableHighAccuracy:!1}).then(function(t){e.geocodePosition(t)},function(t){e.foundCallback()}):e.getUserPosition()}},{key:"getUserPosition",value:function(){window.navigator.geolocation.getCurrentPosition(e.geocodePosition)}},{key:"geocodePosition",value:function(t){var n=t.coords.latitude,o=t.coords.longitude,i=new google.maps.Geocoder,r=new google.maps.LatLng(n,o);i.geocode({latLng:r},function(t,n){(n!=google.maps.GeocoderStatus.OK||t.length<=0)&&e.foundCallback();for(var o=0,i=!1,r=0;r<t.length;r++)if(t[r]&&t[r].types&&"street_address"===t[r].types[0]){i=!1;break}return i?e.foundCallback():void e.foundCallback(Location.make(t[o]))})}}]),e}();!function(){function e(e,t,n){return{restrict:"E",scope:{location:"=",geocode:"=",add:"&"},templateUrl:e.PATHS.VIEWS+"locations/create.html",link:function(e,t,n){e.$parent.locationForm=e.locationForm,e.hasChangedInput=!1;var o=e.location.name||"",i=e.location.address?e.location.address.full||"":"";e.location.formattedAddress=i,e.$watch("location",function(t){""===e.location.formattedAddress||void 0===e.hasChangedInput||e.location.name===o&&e.location.formattedAddress===i?""==e.location.formattedAddress&&(e.location.geocode={},e.hasChangedInput=!1):e.hasChangedInput=!0,e.error=""},!0),e.addLocation=function(t,n){var o=Location.make(n,{name:t.name});return o.isValid()?void e.add({location:o}):void(o.error==Location.ErrorNotSelected?e.error="Please select an address for the location, ex. city, street.":o.error==Location.ErrorNotSpecific&&(e.error="Please select a more specific location, ex. city, street."))}}}}angular.module(MODULE_NAME).directive("locationEditFormFields",e),e.$inject=["APP_CONFIG","$rootScope","$timeout"]}(),$(document).on({DOMNodeInserted:function(){$(".pac-item, .pac-item span",this).addClass("needsclick")}},".pac-container"),function(){function e(e,t,n,o,i){return{restrict:"E",templateUrl:t.PATHS.VIEWS+"locations/manage.html",link:function(t,i,r){var a=r.formType?r.formType:"edit",s=t.editingAuthenticated?t.editingAuthenticated:t.authenticated;switch(a){default:case"edit":t.formTitle="Edit Your Location";break;case"add":t.formTitle="Add Your Location"}t.geocodeDetails={},t.newLocation={},t.locations=angular.copy(s.locations||[]),t.locations.allowLocationTracking=!!s.current_location,t.isTogglingLocationTracking=!1,t.addLocation=function(o){n.post(e,"locations/store",o,function(e){t.locations=e.locations,s.locations=t.locations,t.newLocation={},t.geocodeDetails={},t.lazySuccessToast("Success!","Your location was added."),$("#add-location-btn").blur()})},t.removeLocation=function(e){n.post(t,"locations/"+e.location_id+"/delete",e,function(e){o(function(){t.locations=e.locations,s.locations=t.locations,t.lazySuccessToast("Success!","Your location was removed.")})})},t.setPrimaryLocation=function(e){n.post(t,"locations/"+e.location_id+"/set-primary",e,function(e){o(function(){t.locations=e.locations,s.locations=t.locations,t.lazySuccessToast("Success!","Your primary location was updated.")})})},t.getCurrent=function(){e.loadingToast("Finding Location"),LocationTracker.run(function(n){n?(Log.object("Location Found",angular.copy(n)),e.clearToast(),t.geocodeDetails=n.geocode,t.newLocation.formattedAddress=n.geocode.formatted_address,t.locationForm.geocode.$setViewValue(n.geocode.formatted_address),t.locationForm.geocode.$render()):(e.clearToast(),e.lazyErrorToast("Sorry...","We weren't able to find your location. Try searching..."))})};var c=!1;t.toggleLocationTracking=function(){t.locations.allowLocationTracking||null===s.current_location?null===s.current_location&&(t.isTogglingLocationTracking=!0,LocationTracker.start(function(e){e&&(Log.object("Location Found",angular.copy(e)),Request.api("locations/capture").bind(e).post({success:function(e){c||(t.lazySuccessToast("Success!","Location tracking enabled."),c=!0),t.authenticated.current_location=e.location,s.current_location=e.location},error:function(){t.authenticated.current_location||(t.locations.allowLocationTracking=!1,LocationTracker.stop(),t.lazyErrorToast())},always:function(){t.isTogglingLocationTracking=!1}}))},6e4)):(t.isTogglingLocationTracking=!0,Request.api("locations/capture/clear").post({success:function(e){s.current_location=null,c=!1,t.lazySuccessToast("Success!","Location tracking disabled."),LocationTracker.stop()},error:function(){t.lazyErrorToast()},always:function(){t.isTogglingLocationTracking=!1}}))}}}}angular.module(MODULE_NAME).directive("locationsForm",e),e.$inject=["$rootScope","APP_CONFIG","APIPostService","$timeout","toaster"]}(),function(){function e(e,t,n){return{restrict:"E",scope:{locations:"=",showEdit:"=",link:"="},templateUrl:e.PATHS.VIEWS+"locations/panel.html",link:function(e,o,i){e.isCurrentUser="app.profile"==n.current.name,e.editImagePath=t.$image("svg/edit-primary.svg"),e.primaryImagePath=t.$image("svg/star.svg"),e.locationLink=function(e){return"https://maps.google.com/?q="+e.address.full}}}}angular.module(MODULE_NAME).directive("locationsPanel",e),e.$inject=["APP_CONFIG","$rootScope","$state"]}(),function(){function e(){return{require:"ngModel",scope:{ngModel:"=",options:"=?",details:"=?"},link:function(e,t,n,o){var i,r=!1,a=function(){i={},e.options&&(r=e.options.watchEnter===!0,e.options.types?(i.types=[],i.types.push(e.options.types),e.gPlace.setTypes(i.types)):e.gPlace.setTypes([]),e.options.bounds?(i.bounds=e.options.bounds,e.gPlace.setBounds(i.bounds)):e.gPlace.setBounds(null),e.options.country?(i.componentRestrictions={country:e.options.country},e.gPlace.setComponentRestrictions(i.componentRestrictions)):e.gPlace.setComponentRestrictions(null))};void 0==e.gPlace&&(e.gPlace=new google.maps.places.Autocomplete(t[0],{})),google.maps.event.addListener(e.gPlace,"place_changed",function(){var n=e.gPlace.getPlace();void 0!==n&&(void 0!==n.address_components?e.$apply(function(){e.details=n,o.$setViewValue(t.val())}):r&&s(n))});var s=function(n){var i=new google.maps.places.AutocompleteService;n.name.length>0&&i.getPlacePredictions({input:n.name,offset:n.name.length},function(n,i){if(null==n||0==n.length)e.$apply(function(){e.details=null});else{var r=new google.maps.places.PlacesService(t[0]);r.getDetails({reference:n[0].reference},function(n,i){i==google.maps.GeocoderStatus.OK&&e.$apply(function(){o.$setViewValue(n.formatted_address),t.val(n.formatted_address),e.details=n;t.on("focusout",function(e){t.val(n.formatted_address),t.unbind("focusout")})})})}})};o.$render=function(){var e=o.$viewValue;t.val(e)},e.watchOptions=function(){return e.options},e.$watch(e.watchOptions,function(){a()},!0)}}}angular.module(MODULE_NAME).directive("ngAutocomplete",e),e.$inject=[]}(),function(){function e(){this.detailViewParams=function(e){var t="";return angular.forEach(e.message,function(e){t+=e.text}),{link:"",title:t,message:e.message_detail}}}angular.module(MODULE_NAME).service("notificationsFactory",e)}(),function(){function e(){return this.direct=function(e){return e.level_1},this.indirect=function(e){for(var t=0,n=2,o=e.total_levels;n<o;n++)t+=e["level_"+n];return t},this}angular.module(MODULE_NAME).service("metricsFactory",e)}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Passwords=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(e,t){this.password=e,this.confirmed=t}},{key:"valid",value:function(){return this.password.length>=6&&this.password===this.confirmed}}]),e}();!function(){function e(e){return{restrict:"E",replace:!0,scope:!1,templateUrl:function(t,n){return e.view("registration.components."+(n.mobile?"mobile-":"")+"nav-buttons")}}}angular.module(MODULE_NAME).directive("registrationControls",e),e.$inject=["Helpers"]}(),Registrar.steps=["register","register.info","register.image","register.location","register.networks","register.offer_use"],Registrar.sideStates=["register.networks.search","register.privacy","register.info.bio","register.info.interests","register.terms"],Registrar.prototype.onSideState=function(){return Registrar.sideStates.indexOf(this.$state.current.name)!==-1},Registrar.prototype.isRunning=function(){return Registrar.steps.concat(Registrar.sideStates).indexOf(this.$state.current.name)!==-1},Registrar.prototype.resolveStepIndex=function(){this.onSideState()||this.currentStep()===this.$state.current.name||(this.currentStepIndex=Registrar.steps.indexOf(this.$state.current.name))},Registrar.prototype.isActive=function(){return this.$state.includes("register")},Registrar.prototype.isShowingLegalDocs=function(){return this.$state.is("register.privacy")||this.$state.is("register.terms")},Registrar.prototype.currentStep=function(){return Registrar.steps[this.currentStepIndex]},Registrar.prototype.hasNextStep=function(){return void 0!==Registrar.steps[this.currentStepIndex+1]},Registrar.prototype.nextStep=function(){this.resolveStepIndex(),this.currentStepIndex++,this.toCurrent()},Registrar.prototype.prevStep=function(){this.resolveStepIndex(),this.currentStepIndex--,this.toCurrent()},Registrar.prototype.toCurrent=function(){this.$state.go(this.currentStep())},function(){function e(e,t,n,o,i){e.openThankyouMessageForm=function(n){e.thankyou={},i.set({user:n,thankyou:e.thankyou});var o=t.open({templateUrl:e.$view("connections.thank"),controller:"ModalController"});o.result.then(function(){e.giveThanks(e.user,e.thankyou)},function(){e.thankyou={}})},e.giveThanks=function(i,r){e.trackEvent("New Thankyou",e.authenticated.default_email),o.post(e.$parent,"users/"+i.user_id+"/thank",r,function(o){e.successToast("You sent a Thank You. We appreciate it."),n(function(){var n=t.open({templateUrl:e.$view("auth.invites.index"),controller:"InvitesController"});n.result.then(function(){n.close()})},1e3)})}}angular.module(MODULE_NAME).controller("CreateThankyouController",e),e.$inject=["$scope","$modal","$timeout","APIPostService","modalWindowData"]}(),function(){function e(e,t){function n(e){for(var t in e)this[t]=e[t]}return n.DEFAULT_PROFILE_IMAGE_PATH=t.image("default_user.jpg"),n.prototype.canBeMessaged=function(){return this.isConnectedToAuth()},n.prototype.canBeThanked=function(){return this.isConnectedToAuth()},n.prototype.isConnectedToAuth=function(){return this.relationship&&this.relationship.is_connected},n.prototype.wasLastViewedCard=function(){return e.lastViewedCard&&e.lastViewedCard.user_id==this.user_id},n.prototype.requestToConnect=function(){this.relationship.was_requested_to_connect=!0,this.wasLastViewedCard()&&(e.lastViewedCard.relationship=this.relationship)},n.prototype.cancelRequestToConnect=function(){this.relationship.was_requested_to_connect=!1,this.wasLastViewedCard()&&(e.lastViewedCard.relationship=this.relationship)},n.prototype.hasBeenRequestedToConnect=function(){return this.relationship&&this.relationship.was_requested_to_connect},n.prototype.wasReferredToAuth=function(){return this.relationship&&this.relationship.num_referrals_to_connect>0},n.prototype.referredToAuthBy=function(){var e="";for(var t in this.relationship.referrals)e.length&&(e+=", and "),e+=this.relationship.referrals[t].goes_by;return e},n.build=function(e){return new n(e)},n}angular.module(MODULE_NAME).service("PYCUser",e),e.$inject=["$rootScope","Helpers"]}(),function(){function e(t,n,o){function i(e,t){for(var n=0,o=t.length;n<o;n++)if(t[n].group_id===e)return n;return!1}return e=t,e.prototype.resolveSettings=function(){return this.hasOwnProperty("settings")||(this.settings={uses_alias:!1}),this},e.prototype.resolveProfilePicPath=function(){return this.hasOwnProperty("profile_image_path")&&this.profile_image_path.indexOf("default")===-1||(this.profile_image_path=o.DEFAULT_PROFILE_IMAGE_PATH),this.profile_image_path=this.profile_image_path+"?"+(new Date).getTime(),this},e.prototype.belongsToGroup=function(e){return!!this.hasOwnProperty("groups")&&i(e,this.groups)},e.prototype.joinGroup=function(e,t){e.hasOwnProperty("slug")&&(e.group_slug=e.slug),t?(e.invite_sent=(new Date).toString(),e.is_pending=!0):e.joined=(new Date).toString(),this.groups||(this.groups=[]),this.groups.push(e)},e.prototype.leaveGroupWithId=function(e){var t=this.groups;this.groups=_.filter(t,function(t){return t.group_id!==e})},e.prototype.highlightMutualGroups=function(e){var t=this.groups;return _.filter(e,function(e){return e.is_shared=_.includes(_.map(t,"group_id"),e.group_id),e})},e.prototype.totalSocialAccounts=function(){var e=0;for(var t in this.settings.social_accounts)this.settings.social_accounts[t]&&e++;return e},e.prototype.hasStoredLocation=function(){return this.hasOwnProperty("location")},e.prototype.privacySetting=function(e){return _.findIndex(this.settings.privacy,{is_active:!0})},e.prototype.updatePrivacySetting=function(e){_.forEach(this.settings.privacy,function(t,n){e===n?t.is_active=!0:t.is_active&&(t.is_active=!1)})},e.prototype.totalActiveNotificationSettings=function(){return _.remove(_.values(this.settings.notifications),function(e){return e}).length},e}angular.module(MODULE_NAME).service("User",e),e.$inject=["Auth","Helpers","PYCUser"]}(),function(){function e(){var e=0;this.check=function(t){return t.username&&(e=t.username.length),!e&&!t.settings.uses_alias||e>=6&&e<=14}}angular.module(MODULE_NAME).service("usernameValidator",e)}(),function(){function e(t,n){function o(e,t){return{hideIcon:e,isRound:e}}return e.build=function(){var e=t.make("main"),i=n.text("WALKTHROUGHS.APP");return e.dialogStep("branded-info",{title:i.WELCOME,buttonTitle:"Show Me Around"},"start"),e.addStep("side-profile",i.PROFILE,o(!1)).addStep("side-decks",i.DECKS,o(!1)).addStep("side-connections",i.CONNECTIONS,o(!1)).addStep("side-metrics",i.METRICS,o(!1)).addStep("messages-element",i.CONVERSATIONS,o(!0)).addStep("notifications-element",i.NOTIFICATIONS,o(!0)).dialogStep("info",{title:i.FINISH.TITLE,content:i.FINISH.CONTENT,buttonTitle:"Ok, Got it!"},"finish"),e},e}angular.module(MODULE_NAME).factory("AppWalkthrough",e),e.$inject=["Walkthrough","Helpers"]}(),function(){function e(t,n){function o(e,t,n,o){var i={dialog:n||e.isMobile()?t:null};return void 0===o&&(o={}),_.forIn(o,function(e,t){i[t]=e}),i}return e.build=function(e){var i=t.make("decks"),r=n.text("WALKTHROUGHS.CARDS");return i.dialog("info",{content:r.CARD.MOBILE,icon:"icons/Swipe_Right.png"},"card").dialog("info",r.CARD_BUTTONS.MOBILE,"footer").dialog("info",r.FILTERS,"settings"),i.dialogStep("branded-info",{title:r.START,buttonTitle:"Start"},"start").addStep("card-container",r.CARD.DESKTOP,o(e,"card")).addStep("card-footer-container",r.CARD_BUTTONS.DESKTOP,o(e,"footer")).addStep(e.isMobile()?"settings-button":"settings-wrapper",r.FILTERS,o(e,"settings",!1,{openSettings:!e.isMobile()})).dialogStep("info",{title:r.FINISH.TITLE,content:r.FINISH.CONTENT,buttonTitle:"Ok, Got it!",icon:"icons/Swipe_Left.png",iconClass:"left"},"finish"),i},e}angular.module(MODULE_NAME).factory("CardsWalkthrough",e),e.$inject=["Walkthrough","Helpers"]}(),function(){function e(e,t){var n=0,o=25,i=10;this.getIcon=function(e){var t="arrow"==e?"":"img/icons/"+e+".png";return t},this.getTextDimensions=function(n,i,r){var a,s,c=this.getOffsetCoordinates(n),u=this.getOffsetCoordinates(r);switch(this.calculateWindowQuadrant(r)){case"TOP":a=u.top-c.height,s=u.left+u.width/2-c.width/2;break;case"LEFT":a=u.middle-c.height/2,s=u.left-c.width;break;case"RIGHT":a=u.middle-c.height+o,s=u.right;break;default:case"BOTTOM":a=u.top+u.height+10,s="tablet"==e.media_query?t.innerWidth-c.width-o:u.left+u.width/2-c.width/2;break;case"BOTTOMLEFT":a=u.top+u.height+50,s="tablet"==e.media_query?0:u.left-c.width}return"position: absolute;top:"+a+"px;left:"+s+"px;"},this.getButtonDimensions=function(e,t,n){var o,i,r=this.getOffsetCoordinates(t),a=this.getOffsetCoordinates(e);switch(this.calculateWindowQuadrant(n)){case"RIGHT":case"TOP":case"BOTTOM":o=r.middle-a.height/2,i=r.left+r.width;break;default:case"LEFT":case"BOTTOMLEFT":o=r.bottom,i=r.left+r.width/2-a.width/2}return"position: absolute;left:"+i+"px;top:"+o+"px;"},this.getArrowDimensions=function(t,n){var i,r,a,s,c=this.getOffsetCoordinates(t),u=this.getOffsetCoordinates(n);switch(this.calculateWindowQuadrant(n)){default:case"BOTTOM":case"LEFT":case"BOTTOMLEFT":i=c.top+o;var l=i-15;s=u.middle>l?l:u.middle,a=u.left-25,r=c.left+c.width/2;break;case"RIGHTTOP":i=c.top,a=u.left+u.width+25,s=i-75,r=u.left+u.width+50;break;case"RIGHT":i=c.bottom-o,a=u.right+25,s=i+15,r=c.left+c.width/2;break;case"TOP":return null}var d;return"tablet"!=e.media_query&&(d='<svg id="arrowSVG" width="100%" height="100%"><defs><marker id="arrow" markerWidth="13" markerHeight="13" refx="2" refy="6" orient="auto"><path d="M2,1 L2,10 L10,6 L2,2" style="fill:#fff;" /></marker></defs><path d="M'+r+","+i+" Q"+r+","+s+" "+a+","+s+'"style="stroke:#fff; stroke-width: 2px; fill: none;marker-end: url(#arrow);"/></svg>'),d},this.calculateWindowQuadrant=function(e){var n=this.getOpenArea(e),o="",i=Math.max(n.right,n.left,n.top,n.bottom);return(n.top>.75*t.innerHeight||n.top==i)&&(o+="TOP"),(n.bottom>.75*t.innerHeight||n.bottom==i)&&(o+="BOTTOM"),(n.right>.75*t.innerWidth||n.right==i)&&(o+="RIGHT"),(n.left>.75*t.innerWidth||n.left==i)&&(o+="LEFT"),o},this.getOpenArea=function(n){var o=this.getOffsetCoordinates(n),i="tablet"!=e.media_query?300:0,r=-(o.right-t.innerWidth),a=o.left-i,s=o.top,c=-(o.bottom-t.innerHeight);return{top:s,left:a,bottom:c,right:r}},this.isRound=function(e){var t=this.getOffsetCoordinates(e),n=40;return t.height<n&&t.width<n},this.getFocusDimensions=function(e,t){var o=this.getOffsetCoordinates(e),i=o.top,r=o.left,a=o.height,s=o.width;if(0==i)i=6,r+=4,a-=5,s=a;else if(t){var c=Math.max(s,a);r-=(s-c)/2,i=i+(a-c)/2-3,s=c,a=c}var u="left:"+(r-n)+"px;top:"+(i-n)+"px;width:"+(s+2*n)+"px;height:"+(a+2*n)+"px;";return u},this.isOverlapping=function(e,t){var n=this.getOffsetCoordinates(e),o=this.getOffsetCoordinates(t),r=!1;return n.right-i<o.left||n.left+i>o.right||n.bottom-i<o.top||n.top+i>o.bottom||(r=!0),r},this.getOffsetCoordinates=function(e){for(var t=e[0].offsetWidth,n=e[0].offsetHeight,o=e[0].offsetLeft,i=e[0].offsetTop,r=e[0].offsetParent;r;)o+=r.offsetLeft,i+=r.offsetTop,r=r.offsetParent;return{top:i,left:o,bottom:i+n,right:o+t,middle:i+n/2,height:n,width:t}}}angular.module(MODULE_NAME).service("tourFactory",e),e.$inject=["$rootScope","$window"]}(),function(){function e(e,t,n,o){function i(e){this.name=e,this.currentStepIndex=0,this.steps=[],this.dialogs={},this.isRunning=!1,this.wasShown=!1}var r={main:!1,decks:!1,profile:!1};return i.prototype.addStep=function(e,t,n){var o={active:!1,focusElement:e,content:t};return _.forIn(n,function(e,t){o[t]=e}),this.steps.push(o),this},i.prototype.load=function(e){this.onChangeStep=e,this.isRunning=!0;var t=this;n(function(){o.cancel(),t.nextStep()},1e3)},i.prototype.shouldShow=function(){return!e.config("TESTING.DISABLE_WALKTHROUGHS")&&(!i.storage()[this.name]||e.config("TESTING.ALWAYS_SHOW_WALKTHROUGHS"))},i.prototype.openDialog=function(e){this.dialogs[e].show()},i.prototype.nextStep=function(){if(this.currentStepIndex<this.steps.length){var e=this.currentStepIndex;this.steps[e].active=!0,this.steps[e].dialog&&this.openDialog(this.steps[e].dialog),this.onChangeStep(this.steps[e],e),e++,this.currentStepIndex=e}else this.markViewed(),this.isRunning=!1,this.wasShown=!0;return this},i.prototype.dialogStep=function(e,t,n){return void 0===n&&(n=e),this.dialog(e,t,n),this.steps.push({dialog:n}),this},i.prototype.currentStep=function(){return this.steps[this.currentStepIndex]},i.prototype.dialog=function(e,t,n){var i=this;return"string"==typeof t&&(t={content:t}),t.onClose=function(){var e=i.currentStep();e&&(e.active=!1),i.nextStep()},this.dialogs[n]=o.make(e,t),this},i.make=function(e,t){return new i(e,t)},i.STORAGE_KEY="walkthroughShown",i.storage=function(){var e=t.get(i.STORAGE_KEY);return e||(e=r),e},i.prototype.markViewed=function(){var e=i.storage();e[this.name]=!0,t.set("walkthroughShown",e)},i}angular.module(MODULE_NAME).factory("Walkthrough",e),e.$inject=["Helpers","localStorageService","$timeout","AlertDialog"]}(),function(){function e(e,t){function n(e,t,n){this.link=e,this.imagePaths=t,this.adId=n}var o={LARGE:"lg",MEDIUM:"md",SMALL:"sm",EXTRA_SMALL:"xs"};return n.prototype.formattedLink=function(){var n=this.link.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);
if(this.isLinkInternal()&&"string"==typeof n[5]&&n[5].length>0)return n[5];var o=e.API.PRODUCTION_SERVER_URL;return null!=t.host()&&t.host().indexOf("demo")!==-1&&(o=t.protocol()+"://"+t.host()),o+"/ads/"+this.adId+"/capture-click?ad_uri="+this.link},n.prototype.isLinkInternal=function(){return this.link.indexOf("/app/#/app/")!==-1},n.prototype.target=function(){return this.isLinkInternal()?"_parent":"_system"},n.prototype.imageOfSize=function(e){return this.imagePaths[o[e]+"_image_path"]},n.build=function(e,t,o){return new n(e,t,o)},n}angular.module(MODULE_NAME).factory("Ad",e),e.$inject=["APP_CONFIG","$location"]}(),function(){function e(e){function t(e,t){this.link=e,this.imagePaths=t}var n={LARGE:"lg",MEDIUM:"md",SMALL:"sm",EXTRA_SMALL:"xs"};return t.prototype.formattedLink=function(t){if("string"==typeof this.link)return this.link;var o=e.API.USE_LOCALLY?"":e.API.PRODUCTION_SERVER_URL;return o+"/ads/"+this.link+"/sizes/"+n[t]+"/click"},t.prototype.imageOfSize=function(e){return this.imagePaths[n[e]]},t.build=function(e,n){return new t(e,n)},t}angular.module(MODULE_NAME).service("AdBanner",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n){var o={SideBar:{id:1,defaultBanner:n.build("http://pouryourcup.com",{lg:e.PATHS.IMAGES+"default_ads/side_banner.png"})},ProfileCard:{id:2,defaultBanner:n.build("http://pouryourcup.com",{lg:e.PATHS.IMAGES+"default_ads/card_banner_1000x450.png",md:e.PATHS.IMAGES+"default_ads/card_banner_800x500.png",sm:e.PATHS.IMAGES+"default_ads/card_banner_350x450.png",xs:e.PATHS.IMAGES+"default_ads/card_banner_350x360.png"})}};this.getForZone=function(e,i){t.get("ad-zones/"+o[e].id+"/advertisement",function(e){if(0===e.length)return i();var t=n.build(e.link,e.image_paths,e.advertisement_id);i(t)})}}angular.module(MODULE_NAME).service("AdsFactory",e),e.$inject=["APP_CONFIG","APIGetService","Ad"]}(),function(){function e(e,t,n){return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"ads/profile-card-ad-zone.html",replace:!0,link:function(e,o,i){e.captureClick=function(){t.get(e,"../../ads/"+e.advertisement.adId+"/capture-click",function(t){e.openAdLink()})},e.openAdLink=function(){n.open(e.advertisement.formattedLink(),e.advertisement.target())}}}}angular.module(MODULE_NAME).directive("profileCardAdZone",e),e.$inject=["APP_CONFIG","APIGetService","$window"]}(),function(){function e(e,t,n,o){return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"ads/sidebar-ad-zone.html",replace:!0,link:function(e,i,r){t.getForZone("SideBar",function(t){void 0!==t&&(e.sideBarAdvertisement=t)}),e.captureClick=function(){n.get(e,"../../ads/"+e.sideBarAdvertisement.adId+"/capture-click",function(t){e.openAdLink()})},e.openAdLink=function(){o.open(e.sideBarAdvertisement.formattedLink(),e.sideBarAdvertisement.target())}}}}angular.module(MODULE_NAME).directive("sidebarAdZone",e),e.$inject=["APP_CONFIG","AdsFactory","APIGetService","$window"]}(),function(){function e(e,t){return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"ads/sidebar-pour-more.html",replace:!0}}angular.module(MODULE_NAME).directive("adsSidebarPourMore",e),e.$inject=["APP_CONFIG","$window"]}(),function(){function e(e){function t(e,t,n){console.log(e,t,n),this.httpMethod=e,this.url=t,this.params=n}return t.prototype.shouldLog=function(){return!e.TESTING.HIDE_API_REQUESTS},t.prototype.request=function(){return this.shouldLog()?(console.log("API CALL - Method: "+this.httpMethod+", Route: "+this.url),this.params&&console.log(parameters),this):this},t.prototype.response=function(e,t,n,o){if(this.shouldLog())return console.log(e),this},t.make=function(e,n,o){return new t(e,n,o)},t}angular.module(MODULE_NAME).service("APIRequestLogger",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n,o,i){function r(t,i){this.url=e.API.URL+n.forStateParams(t,o,i),this.requestData=i,this.logger=null}r.ERROR_CODE_UNAUTHORIZED=401,r.ERROR_CODE_RESTRICTED=403,r.ERROR_CODE_NOT_FOUND=404,r.ERROR_CODE_CONFLICT=409,r.ERROR_CODE_SERVER=500,r.ERROR_CODE_EMPTY_DATA=1200;var a=e.API.USE_LOCALLY?"":e.API[e.API.REQUEST_FROM_SERVER+"_SERVER_URL"];return r.prototype.get=function(e,t,n){return this.send("GET",e,t,n)},r.prototype.send=function(e,n,o,r){this.requestError=null,void 0!==n?_.isFunction(n)?(r=o,o=n,n={}):n.running=!0:n={},n.running=!0,this.logger=t.make(e,a+this.url,this.requestData).request();var s=this;return i[e.toLowerCase()](a+this.url,this.requestData).success(function(e,t,i,a){return n.running=!1,s.response(e,t,i,o,r),e}).error(function(e,t,i,a){return n.running=!1,s.response(e,t,i,o,r),e})},r.prototype.response=function(e,t,n,o,i){return this.logger.response(e,t,n),e.hasOwnProperty("success")?e.success.hasOwnProperty("data")&&0!==e.success.data.length?o(e.success.data):this.errorResponse(e,this.ERROR_CODE_EMPTY_DATA,i,e.success.message):this.errorResponse(e,t,i)},r.prototype.errorResponse=function(e,t,n,o){void 0===o&&(o=e.hasOwnProperty("error")&&e.error.hasOwnProperty("message")?e.error.message:void 0),this.requestError={code:t,message:o},_.isFunction(n)&&n(e,this.requestError)},r.make=function(e,t){return new r(e,t)},r}angular.module(MODULE_NAME).service("APIRequest",e),e.$inject=["APP_CONFIG","APIRequestLogger","UrlParser","$stateParams","$http"]}(),function(){function e(e,t){function n(){return{transformRequest:angular.identity,headers:{"Content-Type":void 0}}}function o(e,t,n){r&&(console.log("API CALL - Method: "+e+", Route: "+a+t),n&&console.log(n))}var i=null,r=e.TESTING.HIDE_API_REQUESTS,a=e.API.USE_LOCALLY?e.API.URL:e.API[e.API.REQUEST_FROM_SERVER+"_SERVER_URL"]+e.API.URL;this.getBaseURL=function(){return a},this.getFromServer=function(e,n){return o("GET",e,n),t.get(a+e,n).success(function(e,t,n,o){return r&&console.log(e),e}).error(function(e,t,n,o){return e})},this.quickGet=function(e){return o("GET",e),t.get(a+e).then(function(e){return e.data})},this.postToServer=function(e,s,c){return o("POST",e,s),i=c?n():null,t.post(a+e,s,i).success(function(e,t,n,o){return r&&console.log(e),e}).error(function(e,t,n,o){return e})},this.shouldShowNetworkErrorMessage=function(e,t){return!t||e.hasOwnProperty("error")&&!e.error.hasOwnProperty("message")},this.shouldShowCustomErrorMessage=function(e){return e.hasOwnProperty("error")&&e.error.hasOwnProperty("message")}}angular.module(MODULE_NAME).service("apiFactory",e),e.$inject=["APP_CONFIG","$http"]}(),function(){function e(e,t){return{restrict:"E",scope:{},templateUrl:e.PATHS.VIEWS+"templates/common/empty-data.html",link:function(n,o,i){n.message=i.message,n.moreInfo=i.moreInfo,n.image=e.PATHS.IMAGES+(i.image?i.image:"logo-intro.png"),i.btnTitle&&(n.btnTitle=i.btnTitle.toUpperCase()),n.goToState=function(){t.go(i.btnLink)}}}}angular.module(MODULE_NAME).directive("emptyData",e),e.$inject=["APP_CONFIG","$state"]}(),function(){function e(e){return{restrict:"E",scope:!1,replace:!0,templateUrl:e.PATHS.VIEWS+"templates/common/not-found.html",link:function(e,t,n){}}}angular.module(MODULE_NAME).directive("notFound",e),e.$inject=["APP_CONFIG"]}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){function e(e,t){for(;;){var n=e.indexOf(":");if(n===-1)break;var o=e.indexOf("/",n),i=e.substring(n,o!==-1?o:void 0);e=e.replace(i,t[i.substring(1)])}return e}function t(e){var t=[];for(var n in e)if(""!==e[n]&&e[n]!==[]){var o=e[n];o instanceof Array&&(o=o.join(",")),t.push(n+"="+o)}return t}return this.forStateParams=function(n,o,i){if(n=e(n,o),"object"===("undefined"==typeof i?"undefined":_typeof(i))){var r=t(i);0!==r.length&&(n+="?"+r.join("&"))}return n},this}angular.module(MODULE_NAME).service("UrlParser",e),e.$inject=[]}(),function(){function e(){var e,t=this,n=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/i.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:n[0]||""}};if(e=n(window.navigator.userAgent),e.browser&&(t[e.browser]=!0,t.version=e.version,t.versionNumber=parseInt(e.version)),e.platform&&(t[e.platform]=!0),(t.android||t.ipad||t.iphone||t["windows phone"])&&(t.mobile=!0),(t.cros||t.mac||t.linux||t.win)&&(t.desktop=!0),(t.chrome||t.opr||t.safari)&&(t.webkit=!0),t.rv){var o="msie";e.browser=o,t[o]=!0}if(t.opr){var i="opera";e.browser=i,t[i]=!0}if(t.safari&&t.android){var r="android";e.browser=r,t[r]=!0}return t.name=e.browser,t.platform=e.platform,t}angular.module(MODULE_NAME).service("browser",e)}(),function(){function e(e,t){var n=this,o=e[0];return n.transition=function(){function e(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}return e()}(),n.animation=function(){var e=function(){var e,t=o.body||o.documentElement,n={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(e in n)if(void 0!==t.style[e])return n[e]}();return e&&{end:e}}(),n.touch="ontouchstart"in window&&navigator.userAgent.toLowerCase().match(/mobile|tablet/)||t.DocumentTouch&&document instanceof t.DocumentTouch||t.navigator.msPointerEnabled&&t.navigator.msMaxTouchPoints>0||t.navigator.pointerEnabled&&t.navigator.maxTouchPoints>0||!1,n}angular.module(MODULE_NAME).service("support",e),e.$inject=["$document","$window"]}(),function(){function e(e,t){var n=this;n.touchHandler=function(e){var t=e.changedTouches[0],n=document.createEvent("MouseEvent");n.initMouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n),e.preventDefault()},n.addTo=function(n){n=n||e,t.mobile&&(n.addEventListener("touchstart",this.touchHandler,!0),n.addEventListener("touchmove",this.touchHandler,!0),n.addEventListener("touchend",this.touchHandler,!0),n.addEventListener("touchcancel",this.touchHandler,!0))}}angular.module(MODULE_NAME).service("touchDrag",e),e.$inject=["$document","browser"]}(),function(){function e(e){function t(t){e.onpopstate=function(e){return e.preventDefault(),n(t)},e.onbeforeunload=function(e){var o=n(t);if(o)return o}}function n(e){var t=!1;return _.forIn(e,function(e,n){var o=e();o&&(t=o)}),t}var o={};this.subscribe=function(e,n){o[e]=n,t(o)},this.unsubscribe=function(e){_.unset(o,e),t(o)}}angular.module(MODULE_NAME).service("WindowLeaveEvent",e),e.$inject=["$window"]}(),function(){function e(e,t){return{restrict:"E",replace:!0,scope:{formCancel:"&",disableCancel:"=",disableSubmit:"="},templateUrl:function(t,n){return e.view("components.forms."+(n.mobile?"mobile-":"")+"control-buttons")},link:function(e,n,o){e.isMobile=t.frame.isMobile(),e.$watch(function(){return t.frame.isMobile()},function(t){e.isMobile=t})}}}angular.module(MODULE_NAME).directive("formControlButtons",e),e.$inject=["Helpers","$rootScope"]}(),function(){function e(e){return{restrict:"E",replace:!0,scope:!0,template:'<div class="textarea-container"><textarea type="text" placeholder="Type your message..." ng-model="message.content" ng-disabled="isSaving"></textarea><div class="textarea-size"></div></div>',link:function(e,t,n){var o,i,r,a,s,c,u=function(){i.innerHTML=r.value+"\n",""!=r&&c!=s.clientHeight&&s.clientHeight>60&&(c=s.clientHeight,$(a).css({bottom:c}),e.animateScrollContainerToBottom())};s=document.querySelector(".chat-form-container"),c=s.clientHeight,a=document.querySelector(".message-container"),o=document.querySelector(".textarea-container"),i=o.querySelector(".textarea-size"),r=o.querySelector("textarea"),u(),r.addEventListener("input",u)}}}angular.module(MODULE_NAME).directive("elastic",e),e.$inject=["$timeout"]}(),function(){function e(e){function t(t,o){this.loaded=!1,this.source=t,this.onLoadCallback=o.loaded?o.loaded:function(){},this.onFailLoadCallback=o.failed?o.failed:function(){},this.alwaysCallback=o.always?o.always:function(){},this.image=new Image;var i=this;this.image.onload=function(){i.loaded=!0,i.onLoadCallback(),i.alwaysCallback()},this.image.src=this.source,e(function(){i.didLoad()||i.onFailLoadCallback(),i.loaded||i.alwaysCallback()},n)}var n=3e3;return t.prototype.didLoad=function(){return this.image.complete||"undefined"!=typeof this.image.naturalWidth&&0!==this.image.naturalWidth},t.make=function(e,n){return new t(e,n)},t}angular.module(MODULE_NAME).factory("ImageResource",e),e.$inject=["$timeout"]}(),function(){function e(){return{restrict:"A",link:function(e,t,n){var o=n.loadedclass;t.bind("load",function(e){angular.element(t).addClass(o)})}}}angular.module(MODULE_NAME).directive("imageloaded",e)}(),function(){function e(){return{restrict:"A",link:function(e,t,n){t.bind("load",function(){null!=n.imageonload&&e.$apply(n.imageonload)}),t.bind("error",function(){angular.element(this).attr("src",n.fallbacksrc)})}}}angular.module(MODULE_NAME).directive("imageonload",e)}(),function(){function e(e){return{restrict:"E",replace:!0,scope:!0,template:'<div id="imageLoader" class="animated animated-delay"><div class="spinner"></div></div>',link:function(t,n,o){function i(){e(function(){c&&(s=300),$(n[0]).css("z-index","50"),$(u).removeClass("ng-hide"),$(u).addClass("fadeIn"),r()})}function r(){e(function(){a()},2*s)}function a(){e(function(){$(n[0]).remove(),t.$destroy()},10*s)}var s=150,c=!1;e(function(){c=!c},500);var u=n[0].nextElementSibling;if($(u).addClass("ng-hide"),"undefined"!=o.imagesrc){var l=new Image;l.src=o.imagesrc,l.onload=i()}else $(u).bind("load",i());$(u).onerror=function(){this.src=t.$image("placeholder.png")}}}}angular.module(MODULE_NAME).directive("thumbnailProgress",e),e.$inject=["$timeout"]}(),function(){function e(){function e(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),o=new Uint8Array(n),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);return new Blob([n],{type:"image/png"})}function t(e,t){var n=document.createElement("canvas");return n.width=t[4],n.height=t[5],n.getContext("2d").drawImage(e,t[0],t[1],t[4],t[5],0,0,t[4],t[5]),n}return this.format=function(n,o,i,r){var a=new FormData;if(void 0!==r){var s=t(document.getElementsByClassName(r.imageElementClass)[0],r.dimensions);o=s.toDataURL("image/png")}if(a.append(n,e(o)),void 0!==i)for(var c in i)a.append(c,i[c]);return a},this}angular.module(MODULE_NAME).service("ImageUploaderFormatter",e),e.$inject=[]}(),function(){function e(){return{restrict:"A",link:function(e,t,n){function o(e){if(parseInt(e.w)>0){var t=l/e.w,n=d/e.h;u.css({width:Math.round(t*r)+"px",maxWidth:Math.round(t*r)+"px",height:Math.round(n*a)+"px",maxHeight:Math.round(n*a)+"px",marginLeft:"-"+Math.round(t*e.x)+"px",marginTop:"-"+Math.round(n*e.y)+"px"})}}var i,r,a,s=$("#preview-pane"),c=$("#preview-pane .preview-container"),u=$("#preview-pane .preview-container img"),l=c.width(),d=c.height();$(t).Jcrop({onChange:o,onSelect:o,minSize:[80,80],maxSize:[299.9,299.9],bgOpacity:.4,bgColor:"white",addClass:"jcrop-dark"},function(){var e=this.getBounds();r=e[0],a=e[1],i=this,s.appendTo(i.ui.holder)})}}}angular.module(MODULE_NAME).directive("jcrop",e)}(),function(){function e(e,t,n){var o={};this.set=function(e){o=e},this.get=function(){return o}}angular.module(MODULE_NAME).service("modalWindowData",e),e.$inject=["$rootScope","$state","$timeout"]}(),function(){function e(e,t,n){e.data=n.get(),e.ok=function(){e.data.hasOwnProperty("validate")&&!e.data.validate(e.data)||t.close("closed")},e.cancel=function(){t.dismiss("cancel")}}angular.module(MODULE_NAME).controller("ModalController",e),e.$inject=["$scope","$modalInstance","modalWindowData"]}(),function(){function e(e){return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"templates/common/close-profile-button.html",link:function(e,t,n){e.iconClass={"text-success":"success"===n.iconColor}}}}angular.module(MODULE_NAME).directive("closeProfileButton",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n,o,i){function r(t){return!e.is_arrow_button}function a(e){return!e||!e.hasOwnProperty("name")}function s(e,t,n){return!(!a(e)&&e.name===t.name)||!l(e.params,n)}function c(e,t,n){return e.name===t.name&&l(e.params,n)}function u(e,t,n){if(!e.hasOwnProperty(t.name))return!0;var o=e[t.name];return"function"==typeof o?!o(n):!o}function l(e,t){return _.forIn(e,function(e,n){if(!t.hasOwnProperty("key")||t[n]!==e)return!1}),!0}function d(e,t,n,o,i,r,a){f(),console.log(e),console.log("fromState",o.name,i),console.log("toState",t.name,n),console.log("backButtonLinkedState",r),console.log("windowHistory",a),f()}function f(){console.log("=================================================")}e.is_arrow_button=!1,t.previousStateName="app.decks";var p,h=[],m={"app.notifications.show":!0,"app.mailbox.show":function(e){return 0===e.conversationId.indexOf("create-")}};e.navigate=function(){return e.is_arrow_button?p&&p.hasOwnProperty("name")?void n.go(p.name,p.params):void o.history.back():void(e.app.sidebar.isOffscreen=!e.app.sidebar.isOffscreen)},t.$on("$stateChangeStart",function(n,o,a,l,f){"app.cards"===l.name&&"app.decks"!==o.name?t.hasOpenDeck=!0:t.hasOpenDeck=!1,void 0!==o.navigation&&(e.is_arrow_button=!o.navigation.uses_menu_drawer);var g;r(p)?(g="goingToRoot",h=[],p=null,t.previousStateName="app.decks",t.previousStateParams=null):s(p,o,a)?(g="goingDeeper",u(m,l,f)&&(p&&h.push(p),p={name:l.name,params:f},t.previousStateName=l.name,t.previousStateParams=f)):c(p,o,a)&&(g="goingBack",p=h[h.length-1],p&&(t.previousStateName=p.name,t.previousStateParams=p.params),h.pop()),i.TESTING.HIDE_APP_NAVIGATION||d(g,o,a,l,f,p,h)})}angular.module(MODULE_NAME).controller("NavigationController",e),e.$inject=["$scope","$rootScope","$state","$window","APP_CONFIG"]}(),function(){function e(e,t,n,o){function i(n,i){function r(t){e.app.sidebar.isOffscreen=!0}function a(){return s.width()<o.tablet}var s=$(t);i.on("click",r),i.find("a").each(function(e,t){$(t).on("click",r)}),e.$on("$stateChangeStart",function(){a()&&(e.app.sidebar.isOffscreen=!0)})}return{restrict:"A",link:i}}angular.module(MODULE_NAME).directive("sidebar",e),e.$inject=["$rootScope","$window","$timeout","MEDIA_QUERY"]}(),function(){function e(e,t){e.findConversationWithConnection=function(e){return e.hasOwnProperty("conversation")?void t.go("app.mailbox.show",{conversationId:e.conversation.conversation_id}):void t.go("app.mailbox.show",{conversationId:"create-"+e.user_id})}}angular.module(MODULE_NAME).controller("FindConversationController",e),e.$inject=["$scope","$state"]}(),function(){function e(e,t,n,o,i){function r(){e.index=_.findIndex(e.conversations,{conversation_id:i.conversationId}),e.activeConversation=e.conversations[e.index],e.showActiveConversation=!0}e.conversations=[],e.showActiveConversation=!1,e.searchingConnections=!1,o.get(e,"conversations",{},function(t){return t.conversations&&(e.conversations=t.conversations),e.conversations.length&&!i.conversationId?void e.viewConversation(e.conversations[0],!0):void r()}),e.$on("$stateChangeSuccess",function(t,n,o,r,a){"app.mailbox"==n.name&&!o.conversationId&&e.conversations.length&&"tablet"!=e.media_query?e.viewConversation(e.conversations[0],!1):o.conversationId&&(i=o)}),e.viewConversation=function(o,i){t.go("app.mailbox.show",{conversationId:o.conversation_id}),n(function(){o.new_messages=0,e.authenticated.notifiers.new_messages-=o.new_messages},i?0:1500)},e.selectConversation=function(e){t.go("app.mailbox.show",{conversationId:e.conversation_id})},e.finishSearching=function(e){t.go("app.mailbox.show",{conversationId:e}),r()},e.startSearching=function(){return t.is("app.mailbox.search")?e.viewConversation(e.conversations[0],!0):void t.go("app.mailbox.search")},e.$on("message_received",function(t,n){e.activeConversation.updated_at=new Date,e.activeConversation.last_message=params.message})}angular.module(MODULE_NAME).controller("ConversationsController",e),e.$inject=["$scope","$state","$timeout","APIGetService","$stateParams"]}(),function(){function e(e,t,n,o,i){function r(t){e.canSubmit=!1,o.post(i,"conversations/:conversationId/messages/create",t,function(t){e.message={},e.conversations&&(e.conversations=angular.copy(a(e.conversations,t.message))),e.$parent.conversations&&(e.$parent.conversations=angular.copy(a(e.$parent.conversations,t.message))),e.messages.push(t.message),e.$parent.animateScrollContainerToBottom(),e.canSubmit=!0})}function a(e,n){if(e&&e.length){var o=_.findIndex(e,{conversation_id:t.conversationId}),i=e[o];e.splice(o,1),i.updated_at=(new Date).getTime(),i.last_message=n.content,e.unshift(i)}return e}function s(t){o.post(e,"conversations/create",t,function(t){e.message={},n.go("app.mailbox.show",{conversationId:t.conversation.conversation_id})})}e.message={};var c="create"==t.conversationId.substring(0,6);e.$watch("message.content",function(t,n){e.canSubmit=t&&""!==t}),e.sendMessage=function(e){return c?(e.user_id=t.conversationId.substring(7),void s(e)):void r(e)}}angular.module(MODULE_NAME).controller("CreateMessageController",e),e.$inject=["$scope","$stateParams","$state","APIPostService","$rootScope"]}(),function(){function e(e,t,n,o,i){function r(t){var n="conversations/"+t+"/messages?skip="+a;i.get(e,n,{},function(t){if(s=t.messages,e.messenger=t.messenger,!a)return e.messages=s,a=e.messages.length,void o(function(){e.animateScrollContainerToBottom()},500);e.authenticated.notifiers.new_messages-=data.success.messages.length;for(var n=0,i=s.length;n<i;n++)e.messages.push(s[n]);o(function(){e.animateScrollContainerToBottom()},500)})}e.messages=[],e.messenger=[],e.networkError=!1,e.messageOffset=e.frame.isMobile()?85:60,e.sendHeight=e.messageOffset-(e.frame.isMobile()?45:20);var a=0,s=[];t.conversationId?t.conversationId.includes("create")||r(t.conversationId):t.conversationId=e.$parent.activeConversation.conversation_id,e.$watch("newMessages",function(n){n&&(r(t.conversationId),e.resetNotifiers())}),$(".textarea-container textarea").on("focus",function(){o(function(){e.animateScrollContainerToBottom()},500)}),$(".textarea-container textarea").on("blur",function(){o(function(){e.animateScrollContainerToBottom()},500)}),e.$watch(function(){return $(".textarea-container")[0].clientHeight},function(t){void 0!==t&&t!=e.messageOffset+(e.frame.isMobile()?45:20)?(e.messageOffset=t+(e.frame.isMobile()?45:20),e.sendHeight=t):e.messageOffset=e.frame.isMobile()?85:60}),e.$on("message_received",function(t,n){e.messages.push(n.message)}),e.animateScrollContainerToBottom=function(){a++,e.frame.isMobile()&&$("#reverse-scroll").animate({scrollTop:$("#reverse-scroll")[0].scrollHeight},"slow")}}angular.module(MODULE_NAME).controller("ConversationController",e),e.$inject=["$scope","$stateParams","$state","$timeout","APIGetService"]}(),function(){function e(e){function t(t,n){this.viewPath=e.view(t),this.closeBtnElementId="#"+n}return t.prototype.build=function(){var e=this;return{closeEl:e.closeBtnElementId,target:"body",overlay:{templateUrl:e.viewPath,scroll:!0}}},t.prototype.buildModal=function(){var e=this;return{closeEl:e.closeBtnElementId,target:"#app",manual:!0,overlay:{templateUrl:e.viewPath,scroll:!0}}},t.make=function(e,n){return new t(e,n)},t}angular.module(MODULE_NAME).factory("LayerMorph",e),e.$inject=["Helpers"]}(),function(){function e(){return{replace:!0,template:'<span style="display:none"></span>',scope:{},link:function(e,t){t.remove(),e.$destroy()}}}angular.module(MODULE_NAME).directive("mdTooltip",e),e.$inject=[]}(),function(){function e(e,t){var n=0,o=e.isMobile;return o&&(n=1),[t[n]]}angular.module(MODULE_NAME).decorator("mdTooltipDirective",e),e.$inject=["$rootScope","$delegate"]}(),function(){function e(e){return{restrict:"A",scope:{item:"=",onSelect:"=?"},templateUrl:function(t,n){return e.PATHS.VIEWS+"conversations/list-item/"+(n.mobile?"mobile":"desktop")+".html"},link:function(e,t,n){e.conversation=e.item}}}angular.module(MODULE_NAME).directive("conversationListItem",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t){return{restrict:"E",scope:{list:"=",onSelectItem:"=",currentItem:"=?"},templateUrl:function(t,n){return e.PATHS.VIEWS+"conversations/list/"+(n.mobile?"mobile":"desktop")+".html"},link:function(e,n,o){e.conversations=e.list,e.currentConversation=e.currentItem,e.activeConversation=function(e){return t.conversationId==e}},replace:!0}}angular.module(MODULE_NAME).directive("conversationList",e),e.$inject=["APP_CONFIG","$stateParams"]}(),function(){function e(e,t){return{restrict:"A",scope:{item:"=",auth:"=",messenger:"="},templateUrl:e.PATHS.VIEWS+"conversations/message-list-item.html",link:function(e,n,o){e.message=e.item,e.showProfile=function(n){n||t.go("app.user",{userId:e.messenger.user_id})}}}}angular.module(MODULE_NAME).directive("messageListItem",e),e.$inject=["APP_CONFIG","$state"]}(),function(){function e(e,t,n,o){return{restrict:"E",scope:{list:"=",auth:"=",messenger:"="},replace:!0,templateUrl:e.PATHS.VIEWS+"conversations/message-list.html",link:function(e,t,o){e.messages=e.list,e.authenticated=e.auth,e.$state=e.$state;var i=$("#reverse-scroll");i[0],n.innerHeight;e.$watch(function(){return e.messages.length},function(e,t){"undefined"!==e&&0!=e&&$("#chat-scroll").animate({scrollTop:$("#chat-scroll").prop("scrollHeight")},"slow")})}}}angular.module(MODULE_NAME).directive("messageList",e),e.$inject=["APP_CONFIG","$state","$window","$timeout"]}(),function(){function e(e,t,n){e.begin=function(){e.$state.go("app.connections.auto-connect.step",{step:"goals"})}}angular.module(MODULE_NAME).controller("AutoConnectFormController",e),e.$inject=["$scope","APIPostService","$timeout"]}(),function(){function e(e,t,n){function o(n,o,i){t.post(e.$parent,"users/"+n.user_id+"/"+o,{},function(e){i(n)})}function i(t){n.modal("connections.delete-request-modal",{user:t},function(){e.cancelRequest(t)})}e.makeRequest=function(t){return t.hasBeenRequestedToConnect()?i(t):void o(t,"connect",function(t){e.trackEvent("New Request to Connect",e.authenticated.default_email),e.successToast("Thank you!","We will notify you when a connection is made"),t.requestToConnect()})},e.cancelRequest=function(t){o(t,"connect/cancel",function(t){e.infoToast("Connection Canceled"),t.cancelRequestToConnect()})}}angular.module(MODULE_NAME).controller("CreateConnectionController",e),e.$inject=["$scope","APIPostService","Helpers"]}(),function(){function e(e,t,n,o){function i(){return t.includes("app.mailbox")}function r(o){var i=n.findStateParamForConversation(o);"tablet"!=e.media_query?e.$parent.finishSearching(i):t.go("app.mailbox.show",{conversationId:i})}function a(){return"app.connections"===c}function s(e){t.go("app.user",{userId:e.user_id})}e.connections=[],e.networkError=!1,e.userHasConnections=!1,e.loadingContent=!0;var c=t.current.name;n.all().success(function(t){t=t.success.data.connections,e.userHasConnections=void 0!==t&&t.length,e.connections=_.groupBy(t,function(e){return e.name.substring(0,1).toLowerCase()}),e.allConnections=t,e.handleImages(),e.loadingContent=!1}).error(function(t){e.networkError=!0,e.loadingContent=!1}),e.handleImages=function(){var t=new Array;angular.forEach(e.allConnections,function(e,n){t[n]=new Image,t[n].onload=function(){e.imageLoaded=!0},t[n].src=e.profile_image_path,o(function(){e.imageLoaded=!0},1e3)})},e.selectConnection=function(e){i()?r(e):a()&&s(e)}}angular.module(MODULE_NAME).controller("ConnectionsController",e),e.$inject=["$scope","$state","connectionsFactory","$timeout"]}(),function(){function e(e,t,n,o){e.clearToast();var i=e.$watch("referral.message",function(){e.referral.restrictMessageLength()});e.refer=function(o,r){e.trackEvent("New Refferal",e.authenticated.default_email),n.post(t,r.postCreateAPIRoute(),r.formattedPostData(),function(t){i(),e.lazySuccessToast("Got it!","Thank you for making a referral."),e.closeReferral(!0)})}}angular.module(MODULE_NAME).controller("CreateReferralController",e),e.$inject=["$scope","$rootScope","APIPostService","$timeout"]}(),function(){function e(e,t,n,o,i){e.referredUser={},t.referral=o.blank(),e.setReferredUser=function(t){e.referredUser=t},t.closeReferral=function(n){i(function(){t.referral.hasType()&&n&&e.$broadcast("morphToggle"),t.referral=o.blank()},250)},t.openEmailForm=function(e,n){t.createReferral(e,null,!0),t.referral.email=n},t.createReferral=function(i,r,a){var s=o.make(a?"email":"create",e.referredUser);return r?(s.setOtherUser(r),void n.get().success(function(e){var n=e.success.data.connections;if(!n)return void(t.referral=s);for(var o=0;o<n.length;o++)if(n[o].user_id==r.user_id){s.referredUser.isConnected=!0;break}t.referral=s})):void(t.referral=s)}}angular.module(MODULE_NAME).controller("ReferralsController",e),e.$inject=["$rootScope","$scope","connectionsFactory","Referral","$timeout"]}(),function(){function e(e,t,n,o){function i(n){t.post(e.$parent,"user/groups/"+n.group_id+"/join",{},function(t){e.trackEvent("Group Member Added",n.name),e.authenticated.joinGroup(n),e.lazySuccessToast("Success","You were added to "+n.name),e.$parent.cancelSearch()})}function r(o){n.build(o).showRequestToJoinForm(e,function(n){t.post(e.$parent,"groups/"+o.slug+"/requests/join",n,function(t){e.authenticated.joinGroup(o,!0),e.$parent.cancelSearch()})})}function a(e,t,o,i,r){e.$view=o.$view,e.showPreview=!0,e.group={},i.get(e,"groups/"+r,{},function(t){e.group=n.build(t.group),e.trackEvent("Group Preview View",e.group.name)}),e.closeDialog=function(){t.hide()}}e.joinGroup=function(e){return e.is_locked?r(e):void i(e)},e.showNetworkDetails=function(t,n){n?e.$state.go("app.network",{groupSlug:t.slug}):e.previewNetwork(t.slug)},e.previewNetwork=function(t){o.show({templateUrl:e.$view("templates.groups._preview"),controller:a,locals:{previewGroupSlug:t}})},a.$inject=["$scope","$mdDialog","$rootScope","APIGetService","previewGroupSlug"]}angular.module(MODULE_NAME).controller("JoinGroupController",e),e.$inject=["$scope","APIPostService","Group","$mdDialog"]}(),function(){function e(e,t){e.leaveGroup=function(n){var o=n.is_pending?"groups/"+encodeURIComponent(n.group_slug)+"/requests/join/delete":"user/groups/"+n.group_id+"/leave";t.post(e.$parent,o,{},function(t){e.trackEvent("Group Member Removed",n.name),e.authenticated.leaveGroupWithId(n.group_id),e.infoToast("Success","You were removed from "+n.name),e.authenticated.groups.length||(e.$parent.collapseCurrentGroups=!0)})}}angular.module(MODULE_NAME).controller("LeaveGroupController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t,n){e.openRequestForm=function(t){e.request={name:t};var o={request:e.request};e.$modal("group-requests.create-modal",o,function(){n.post(e.$parent,"groups/requests/create",e.request,function(t){e.$parent.cancelSearch(),e.lazySuccessToast("Your request to create a new network has been sent.")})},function(){e.request={}})}}angular.module(MODULE_NAME).controller("RequestToCreateGroupController",e),e.$inject=["$scope","Group","APIPostService"]}(),function(){function e(e,t,n){e.openRequestForm=function(o){t.build(o).showRequestToJoinForm(e,function(t){n.post(e.$parent,"groups/"+encodeURIComponent(o.slug)+"/requests/join",t,function(t){e.authenticated.joinGroup(o,!0),e.lazySuccessToast("Success","You're request to become a member was sent!")})})}}angular.module(MODULE_NAME).controller("RequestToJoinGroupController",e),e.$inject=["$scope","Group","APIPostService"]}(),function(){function e(e,t,n,o){e.openRequestForm=function(o){e.request={contact_info:e.authenticated.default_email},n.set({group:o,request:e.request});var i=t.open({templateUrl:e.$view("group-requests.moderate-modal"),
controller:"ModalController"});i.result.then(function(){e.sendRequest(e.request)},function(){e.request={}})},e.sendRequest=function(t){e.trackEvent("Group Request To Moderate",e.authenticated.default_email),o.post(e.$parent,"groups/:groupSlug/requests/ownership",t,"You're request for moderator permissions was sent!")}}angular.module(MODULE_NAME).controller("RequestToModerateGroupController",e),e.$inject=["$scope","$modal","modalWindowData","APIPostService"]}(),function(){function e(e,t,n,o){e.search="",e.searchResults=[],e.is_searching=!1,e.cancelSearch=function(){e.search="",e.searchResults=[],n(function(){return e.$parent.registrar?e.$parent.registrar.toCurrent():t.go("app.profile.groups")},1e3)},e.toggleSearching=function(){n(function(){e.is_searching=!e.is_searching})},o.search(e,"search","groups/search?only_public=1",function(t){""!=e.search&&(e.searchResults=t.groups)}),e.$watch("search",function(t){""==t&&(e.searchResults=[])})}angular.module(MODULE_NAME).controller("SearchGroupsController",e),e.$inject=["$scope","$state","$timeout","APISearchService"]}(),function(){function e(e,t,n,o){e.group={},o.$$path.includes("fromSignup")?t.get(e,"groups/:groupSlug",{subdomain:e.$stateParams.groupPageSubdomain},function(t){e.group=n.build(t.group),console.log(e.group),e.trackEvent("Group Page View",e.group.name);var o={group:e.group,pending:e.authenticated.groups[e.authenticated.belongsToGroup(e.group.group_id)].is_pending};e.$modal("templates.groups._from_signup_modal",o,function(){},function(){})}):t.get(e,"groups/:groupSlug",{},function(t){e.group=n.build(t.group),e.trackEvent("Group Page View",e.group.name)})}angular.module(MODULE_NAME).controller("GroupController",e),e.$inject=["$scope","APIGetService","Group","$location"]}(),function(){function e(e){return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"templates/groups/_auth_groups_list_item.html"}}angular.module(MODULE_NAME).directive("authGroupsListItem",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e){return{restrict:"E",scope:{item:"="},templateUrl:e.PATHS.VIEWS+"templates/groups/_members_list_item.html",link:function(e,t,n){e.user=e.item}}}angular.module(MODULE_NAME).directive("groupMembersListItem",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e){return{restrict:"E",scope:!1,replace:!0,templateUrl:e.view("templates.groups.search-form"),link:function(e,t,n){}}}angular.module(MODULE_NAME).directive("groupsSearchForm",e),e.$inject=["Helpers"]}(),function(){function e(e,t){return{restrict:"A",scope:!1,templateUrl:e.view("templates.groups._search_result_item"),link:function(e,n,o){var i=new Registrar(t);e.showGroupLink=!i.isActive()}}}angular.module(MODULE_NAME).directive("groupSearchResultItem",e),e.$inject=["Helpers","$state"]}(),function(){function e(e,t){return{restrict:"E",scope:{item:"="},templateUrl:e.PATHS.VIEWS+"templates/groups/_user_groups_list_item.html",link:function(e,n,o){e.group=e.item,e.viewGroup=function(e){t.go("app.network",{groupSlug:e})}}}}angular.module(MODULE_NAME).directive("userGroupsListItem",e),e.$inject=["APP_CONFIG","$state"]}(),function(){function e(e,t,n,o,i,r,a,s,c,u,l){function d(t){t&&(e.loadingContent=!0,e.userCards=[],e.deckIsLocked=!0,e.deckNeverEnds=!1,e.currentCardUser=null,e.prevCardUser=null,e.nextCardUser=null,g=0,v=!1,y=[],w={}),e.isGetting=!0,h.addCards(function(t){return t.isEmpty()?(e.isGetting=!1,e.loadingContent=!1):(e.isGetting=!1,void f(t.all()))})}function f(t){!e.userCards.length&&e.lastViewedCard&&e.lastViewedCard.hasOwnProperty("user_id")&&t.length&&t[0].user_id!==e.lastViewedCard.user_id&&e.userCards.push(e.lastViewedCard),t.length>4&&(t=a.removePossibleDuplicates(t,e.userCards)),e.userCards=e.userCards.concat(t),E?i.insertAds(e.userCards,e.authenticated,function(n){e.userCards=n,p(t)}):p(t)}function p(n){y=y.concat(_.map(n,"user_id")),e.deckNeverEnds=g===e.userCards.length,g=e.userCards.length,e.deckIsLocked=!1,r.activate(n,o.fixedSidebar,o.media_query,function(){t(function(){e.loadingContent=!1},1e3)})}if(!Deck.loaded)return e.$state.go("app.decks");var h=Deck.current();o.refferingUser=!0,o.deckOpen=!0,e.$state.current.name.indexOf("refer")!==-1&&e.$state.go("app.user",{userId:e.$stateParams.userId});var m=l.build(e.frame),g=0,v=!1,y=[],w={},b={},E=!0;i.getAdvertisement(function(e){void 0!==e?b=e:E=!1}),d(!0),s.addListenersForScope(e),window.onbeforeunload=function(t){e.setLastViewedCard(w),i.updateDeck(y)},e.$on("changeSettings",function(e,t){console.log("changing deck"),d(!0)}),e.setCurrentCardUser=function(t,n,r){m.wasShown||m.isRunning||!m.shouldShow()||(o.walkthrough=m,o.walkthrough.load(function(t,n){t.openSettings&&"tablet"!=e.media_query?o.app.settings.isOffScreen=!0:o.app.settings.isOffScreen&&(o.app.settings.isOffScreen=!1)})),o.currentCardIsAd="advertisement"===t.card_type,o.currentCardIsAd?(o.advertisement=b,i.getAdvertisement(function(e){b=e})):o.advertisement={},angular.isDefined(t)&&(y=a.updatedNotViewed(y,t.user_id,w.user_id,n),w=t,e.currentCardUser=u.build(w),e.prevCardUser=e.userCards[r-1],e.nextCardUser=e.userCards[r+1],y.length<=5&&!e.isGetting&&d(!1),y.length<=1&&e.isGetting&&(e.deckIsLocked=!0))},e.setEnabled=function(e){v=e},e.viewProfile=function(t){v&&e.$state.go("app.user",{userId:t})},e.$on("$destroy",function(){e.setLastViewedCard(w),i.updateDeck(y)});var k=e.$watch("loadingContent",function(n){!n&&e.userCards.length&&t(function(){o.cardsLoaded=!0,k()})});e.swipeNext=function(){var e=!1;return s.mouseEvents(e)},e.swipePrev=function(){var e=!0;return s.mouseEvents(e)}}angular.module(MODULE_NAME).controller("CardsController",e),e.$inject=["$scope","$timeout","APIGetService","$rootScope","cardsFactory","cardsImageCacher","cardsOrganizer","swipeHandler","localStorageService","PYCUser","CardsWalkthrough"]}(),function(){function e(e){e.$watch("currentCardIsAd",function(){e.currentCardIsAd?e.hideFooter():e.showFooter()}),e.showFooter=function(){$("#card-footer").velocity({translateY:"0%"})},e.hideFooter=function(){if("desktop"==e.media_query){var t=$("#card-footer");t.animo("cleanse"),t.velocity({translateY:"65%"})}}}angular.module(MODULE_NAME).controller("DeckFooterController",e),e.$inject=["$scope"]}(),function(){function e(e,t,n,o){t.setLastViewedCard(),t.loadingContent=!0;var i=o.build();i.shouldShow()&&(e.walkthrough=i,e.walkthrough.load(function(e,n){e.isRound&&!t.app.sidebar.isOffscreen?t.app.sidebar.isOffscreen=!0:t.app.sidebar.isOffscreen&&(t.app.sidebar.isOffscreen=!1)})),t.showDecks=function(){t.loadingContent=!0,PresetDeck.showAll(function(){t.loadingContent=!1})},Deck.current().load(function(e){t.decks=e.presets.all(),t.showDecks()},!0),t.selectDeck=function(e,o){if(e.is_disabled)return t.errorToast("Sorry...",e.disabledErrorMessage());t.trackEvent("Deck Selected",e.name),e.select();var i=void 0;e.hasOptions()&&(i="decks-"+o),PresetDeck.hideAll(function(){e.hasOptions()?n.go("app.decks.show",{deckSlug:o}):n.go("app.cards")},i)}}angular.module(MODULE_NAME).controller("DecksController",e),e.$inject=["$rootScope","$scope","$state","AppWalkthrough"]}(),function(){function e(e,t,n,o,i){function r(){var t=tb.collect(angular.copy(e.currentDeck.filters));u=[];var n=[];t.each(function(e,t){if("recommended"!==t){var o=c(t);e.hasOwnProperty("options")?tb.collect(e.options).each(function(e){e.is_active&&n.push({type:t,icon:o,key:e.key,name:e.name,relevance:e.relevance})}):e.is_active&&(n.push({type:t,icon:o,key:e.key,name:e.name}),u.push({type:t,icon:o,key:e.key,name:e.name}))}}),e.filterItems=n,a()}function a(){3==e.filtersShown&&e.filterItems.length>3?e.filtersShowMessage="plus "+(e.filterItems.length-3)+" more...":e.filtersShowMessage="show less..."}function s(){$("#closeDeckFilters").click()}function c(e){switch(e){case"group":case"groups":return"fa-users";case"interest":case"interests":return"fa-book";case"referrals":return"fa-send";case"locations":return"fa-map-marker";case"user":return"fa-user"}}e.currentDeck=Deck.current(),e.search="",e.filtersShown=3,e.filtersShowMessage;var u=[];r(),i.search(e,"search","app/search",function(t){e.items=tb.collect(t.results).transform(function(t){if(t.icon=c(t.type),t.key=t.id,"user"===t.type)return t.filterable=!1,t;switch(t.filterable=!0,t.type){case"group":t.type="groups";break;case"interest":t.type="interests"}return t.is_active=!tb.collect(angular.copy(e.filterItems)).where("key",t.key).where("type",t.type).isEmpty(),t}).all(),e.items&&tb.collect(u).each(function(t){t.name.toLowerCase().indexOf(e.search.toLowerCase())!==-1&&(t.filterable=!0,t.is_active=!tb.collect(angular.copy(e.filterItems)).where("key",t.key).where("type",t.type).isEmpty(),e.items.splice(0,0,t))})}),e.selectSearchItem=function(t){return e.search="",e.items=null,"user"===t.type?n.go("app.user",{userId:t.id}):t.is_active?e.removeFilterItem(t):("groups"!==t.type&&"interests"!==t.type||(t.relevance="Added"),e.filterItems.push(t),a(),t.is_active=!0,void 0)},e.removeFilterItem=function(t){t.is_active=!1;var n=e.filterItems;tb.collect(n).each(function(e,o){(void 0===e||e.key==t.key&&e.type==t.type)&&n.splice(o,1)}),e.filterItems=n,a()},e.update=function(){e.currentDeck.clearFilters(),tb.collect(e.filterItems).each(function(t,n){var o=t.key!==t.type?t:null;e.currentDeck.updateFilter(!0,t.type,o)}),o.$broadcast("changeSettings"),s()},e.cancel=function(){s(),r()},e.toggleMoreFilters=function(){3==e.filtersShown&&e.filterItems.length>3?e.filtersShown=e.filterItems.length:e.filtersShown=3,a()},e.closeDeck=function(){e.currentDeck.clearFilters(),t(function(){s(),n.go("app.decks")},500)}}angular.module(MODULE_NAME).controller("SearchFilterController",e),e.$inject=["$scope","$timeout","$state","$rootScope","APISearchService"]}(),function(){function e(e,t,n,o){o.searchMenu=!1,e.startSearch=function(){t(function(){o.searchMenu=!0})}}angular.module(MODULE_NAME).controller("DeckSettingsController",e),e.$inject=["$scope","$timeout","$state","$rootScope"]}(),function(){function e(e,t,n){e.loadingOptions=!0,Deck.current().getPresets(function(n){e.currentDeck=n.get(t.params.deckSlug),console.log(e.currentDeck),PresetDeck.showAll(function(){PresetSelectionBackBtn.resolve().show(),e.loadingOptions=!1})}),e.openDeck=function(e,n){e.selectOption(n),t.go("app.cards")},e.goBack=function(){PresetDeck.hideAll(function(){PresetSelectionBackBtn.resolve().hide(),t.go("app.decks")})}}angular.module(MODULE_NAME).controller("DeckController",e),e.$inject=["$scope","$state","$timeout"]}(),function(){function e(e){function t(e,t){var n={width:0,height:0},r=.5;return e&&"tablet"===t?(n.height=(i-160)*r,n.width=(o-300)*r):e||"tablet"!==t?e||"tablet"!==!t||(n.width=o*r):(n.height=(i-120)*r,n.width=o*r),n}var n=new Array,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this.activate=function(e,o,i,r){var a=0,s=t(o,i);angular.forEach(e,function(t,o){n=new Array,n[o]=new Image,n[o].onload=function(){t.imageHandle=this.width<s.width&&this.height<s.height,a++,(a>5||a===e.length&&void 0!==r)&&r()},n[o].src=t.profile_image_path})}}angular.module(MODULE_NAME).service("cardsImageCacher",e),e.$inject=["$timeout"]}(),function(){function e(){this.removePossibleDuplicates=function(e,t){return _.filter(e,function(e){return _.findIndex(t,function(t){return t.user_id===e.user_id})===-1})},this.updatedNotViewed=function(e,t,n,o){var i=e.indexOf(t);return i===-1||void 0!==o&&o!==-1?n&&e.push(n):e.splice(i,1),e}}angular.module(MODULE_NAME).service("cardsOrganizer",e)}(),function(){function e(){this.addListenersForScope=function(e){var t=angular.element(document),n=function(e){return e.preventDefault(),!0},o=function(t){switch(t.keyCode){case 39:e.swipeNext();break;case 37:e.swipePrev()}};document.addEventListener("touchmove",n,!1),t.on("keydown",o),e.$on("$stateChangeStart",function(e,t,o,i,r){t.name.indexOf("refer")===-1?document.addEventListener("touchmove",n,!1):document.removeEventListener("touchmove",n,!1)}),e.$on("$destroy",function(){document.removeEventListener("touchmove",n,!1),t.off("keydown",o)})},this.mouseEvents=function(e){var t=document.getElementById("cardblur"),n=document.querySelector("cardview").clientWidth,o=n/4+50,i=document.createEvent("MouseEvents"),r=e?0:n;i.initMouseEvent("mousedown",!0,!0,window,0,r,r,r,r,!1,!1,!1,!1,0,null),t.dispatchEvent(i);for(var a=0;a<=o;a+=50){var s=document.createEvent("MouseEvents"),c=e?a:n-a;s.initMouseEvent("mousemove",!0,!0,window,0,c,c,c,c,!1,!1,!1,!1,0,null),t.dispatchEvent(s)}return!1}}angular.module(MODULE_NAME).service("swipeHandler",e)}(),function(){function e(e){return{restrict:"E",replace:!0,transclude:!0,scope:{orientation:"@",inner:"@",cardEnabled:"@",hasImage:"@"},template:'<div class="split-panes {{orientation}}" ng-transclude></div>',controller:["$scope",function(e){e.panes=[],this.addPane=function(t){return e.panes.push(t),e.panes.length}}],link:function(t,n,o){function i(t){var o=n[0].getBoundingClientRect(),i=(o.bottom-o.top)*(.01*d),h=(o.right-o.left)*(.01*d);if(l&&!f?(s.css("top",i+"px"),c.elem.css("height",i+"px"),u.elem.css("top",i+"px")):l||f||(s.css("left",h+"px"),c.elem.css("width",h+"px"),u.elem.css("left",h+"px")),t&&p){var m=angular.element(n.find(".card-img-horizontal")),g=null,v=null;r?r!=e.innerHeight&&(r=e.innerHeight,m.length>0&&m[0].offsetParent&&m[0].height>m[0].offsetParent.clientHeight&&(v=.85*m[0].offsetParent.clientHeight+"px",g="auto")):r=e.innerHeight,a?a!=e.innerWidth&&(a=e.innerWidth,m.length>0&&m[0].offsetParent&&m[0].width>m[0].offsetParent.clientWidth&&(g=.85*m[0].offsetParent.clientWidth+"px",v="auto")):a=e.innerWidth,v&&g&&m.css({height:v,width:g})}}var r,a,s=angular.element('<div class="split-handler"></div>'),c=t.panes[0],u=t.panes[1],l="vertical"==t.orientation,d=c.minSize||0,f=(u.minSize||0,t.inner),p=t.hasImage;t.$on("resize",function(e){i(e)}),i(),c.elem.after(s)}}}function t(){return{restrict:"E",require:"^bgSplitter",replace:!0,transclude:!0,scope:{minSize:"="},template:'<div class="split-pane{{index}}" ng-transclude></div>',link:function(e,t,n,o){e.elem=t,e.index=o.addPane(e)}}}angular.module(MODULE_NAME).directive("bgSplitter",e),e.$inject=["$window"],angular.module(MODULE_NAME).directive("bgPane",t),t.$inject=[]}(),function(){function e(e){return{restrict:"A",scope:{contributor:"="},templateUrl:function(t,n){return e.PATHS.VIEWS+"decks/card-contribution-panel/"+(n.mobile?"mobile":"desktop")+".html"},link:function(e,t,n){e.title=n.title,e.property=n.property,e.contribution=e.contributor[n.property]}}}angular.module(MODULE_NAME).directive("cardContributionPanel",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n,o,i,r,a){return{restrict:"EA",scope:{auth:"=",dataset:"=",lockDeck:"=",endlessDeck:"=",currentCardUser:"&",cardIsEnabled:"&",template:"&",onUpdateContentWrapper:"&onUpdateContent"},template:["<div class='card-view'>","<div class='deck'>","<div class='card'></div>","<div class='card'></div>","<div class='card'></div>","</div>","</div>"].join(""),link:function(e,s,c){function u(e,n){var o=$(e).find("#profilebackground"),i=$(e).find("#cardbackground");n&&(n.imageHandle&&"tablet"==t.media_query?($(o).removeClass("card-cover").addClass("card-contain"),$(i).css("background-image","url("+p+") ")):$(o).removeClass("card-contain").addClass("card-cover"))}var l,d="",f=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=t.$image("card_bg_blur.jpg");l=f>r.mobile?100:55;var h=function(t,n){e.onUpdateContentWrapper({el:t,data:n})};for(var m in e.dataset)e.dataset[m].groups=e.auth.highlightMutualGroups(e.dataset[m].groups);var g=function(t,o){var i=angular.extend(e.$parent.$new(),{card:o,query:l}),r=n(d)(i);r.bind("$destroy",function(){i.$destroy()}),angular.element(t).html("").append(r),e.currentCardUser({$cardUser:e.dataset[v.currentPageIndex],$direction:v.direction,$currentPageIndex:v.currentPageIndex}),u(t,o),h.call(this,t,o)},v=new CardView(s.children()[0],{direction:"horizontal",dataset:e.dataset,onChangeState:function(t){e.cardIsEnabled({$isEnabled:t})},onUpdateContent:function(t,n){o(angular.bind(this,function(){e.$apply(angular.bind(this,function(){e.prevCardUser=e.dataset[v.currentPageIndex-1],e.nextCardUser=e.dataset[v.currentPageIndex+1],g.call(this,t,n)}))}))}});t.$watch("media_query",function(t){var n=a.view("decks.card."+(e.$parent.frame.isMobile()?"mobile":"desktop"));d=i.get(n),g.call(v,v.cards[v.currCard],e.dataset[v.currentPageIndex])}),e.$watch("lockDeck",function(e){v.lockDeck=e}),e.$watch("endlessDeck",function(e){v.hasLooped=e}),e.$watch("dataset",function(e){v.options.dataset=e})}}}angular.module(MODULE_NAME).directive("cardview",e),e.$inject=["$window","$rootScope","$compile","$timeout","$templateCache","MEDIA_QUERY","Helpers"]}(),function(){function e(e){return{restrict:"E",scope:{item:"=",itemSlug:"=",onSelect:"="},templateUrl:e.PATHS.VIEWS+"decks/list-item.html",link:function(t,n,o){t.deck=t.item,t.deckSlug=t.itemSlug,t.defaultIcon=e.PATHS.IMAGES+NaN}}}angular.module(MODULE_NAME).directive("deckListItem",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n){function o(e,t,n){var o=(parseInt(e)+1)%t.card_display_frequency===0,i="user.profile"===n[e].card_type;return o&&i}({card_type:"advertisement",link:"http://pouryourcup.com",imagePaths:{lg:t.$image("default_ads/card_banner_1000x450.png"),md:t.$image("default_ads/card_banner_800x500.png"),sm:t.$image("default_ads/card_banner_350x450.png"),xs:t.$image("default_ads/card_banner_350x360.png")}});return this.insertAds=function(e,t,n){if(!t.settings.ads.are_enabled)return n(e);for(var i in e)o(i,t.settings.ads,e)&&e.splice(i,0,{card_type:"advertisement"});return n(e)},this.getAdvertisement=function(e){n.getForZone("ProfileCard",e)},this.updateDeck=function(n){n.length&&e.post(t,"cards/update-viewed",{not_viewed:n})},this}angular.module(MODULE_NAME).service("cardsFactory",e),e.$inject=["APIPostService","$rootScope","AdsFactory"]}(),function(){function e(e,t,n,o,i,r){return t.isLoading=!0,e.invitation={emailAddress:o.emailAddress,invitationId:o.invitationId},t.authenticated?(t.isLoading=!1,t.addEmailAccount=function(e){var n={email:e.emailAddress,invitation_id:e.invitationId};i.post(t,"app-invites/combine-email-accounts",n,function(e){t.next(),t.lazySuccessToast("New email account added.","Manage your email accounts from Edit Profile > Settings > Email Accounts")})},void(t.next=function(){n.go(r.appropriate())})):n.go(r.appropriate())}angular.module(MODULE_NAME).controller("AddEmailFromInviteController",e),e.$inject=["$rootScope","$scope","$state","$stateParams","APIPostService","AuthenticatedFactory"]}(),function(){function e(e,t,n,o,i){function r(t){e.errorToast("Error getting contacts")}function a(){t.pickContact().then(function(t){i.getName(t)&&t.emails&&t.emails.length?e.contacts.push(i.build(t,e.$image("default_user.jpg"))):t.emails&&t.emails.length||e.errorToast("","You must select someone with a valid name and email address.")})}e.contacts=[],e.formOpen=!e.cordovaSet,e.newContact={},e.mobileOptions=!1,e.loadingContent=!0,e.$modal=n,e.submitAddContactForm=function(t){e.contacts.push(i.build(t,e.$image("default_user.jpg"),!0)),e.formOpen=!1},e.removeContact=function(t){var n=e.contacts.indexOf(t);e.contacts.splice(n,1)},e.toggleForm=function(t){return o(function(){e.formOpen=t})},e.addContact=function(){e.loadingContent=!1,e.toggleForm(!0)},e.pickFromContacts=function(){MobileDevice.current.checkForContactsPermission(a,r)}}angular.module(MODULE_NAME).controller("InvitesController",e),e.$inject=["$scope","$cordovaContacts","$modalInstance","$timeout","ContactsFactory"]}(),function(){function e(e,t){var n;e.openContacts=function(){n=t.open({templateUrl:e.$view("auth.invites.index"),controller:"InvitesController"}),n.result.then(function(){n.close()})}}angular.module(MODULE_NAME).controller("PromptForSendingInvitationsController",e),e.$inject=["$scope","$modal"]}(),function(){function e(e,t){e.send=function(n,o){var i={emails:_.map(n,"email")};t.post(e.$parent,"app-invites/create",i,function(t){o.close("closed"),e.successToast("Thank you!","Your invitations have been sent.")})}}angular.module(MODULE_NAME).controller("SendInvitationsController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(){function e(e,n,o,i,r){this.id=e,this.metric={type:n,level:o},this.start={x:i.longitude,y:i.latitude},this.end={x:r.longitude,y:r.latitude};var a=new arc.GreatCircle(this.start,this.end);this.feature=t(a.Arc(100,{offset:10})),this.feature!==!1&&(this.startTime=(new Date).getTime(),this.feature.set("arcId",this.id))}function t(e){if(1!==e.geometries.length)return!1;var t=new ol.geom.LineString(e.geometries[0].coords);return t.transform(ol.proj.get("EPSG:4326"),ol.proj.get("EPSG:3857")),new ol.Feature({geometry:t,finished:!1})}function n(e,t){var n=e.time-t;return n*o}var o=.1,i=1;return e.prototype.mapFeature=function(){return this.feature},e.prototype.draw=function(e){e.vectorContext.setFillStrokeStyle(null,this.stroke);var t=this.feature.getGeometry().getCoordinates(),o=n(e.frameState,this.startTime);o>=t.length&&this.finishDrawing();var i=Math.min(o,t.length),r=new ol.geom.LineString(t.slice(0,i));e.vectorContext.drawLineStringGeometry(r,this.feature)},e.prototype.finishDrawing=function(){this.feature.set("finished",!0),this.feature.setStyle(this.style)},e.prototype.setStyle=function(e){this.stroke=new ol.style.Stroke({color:e[this.metric.level-1],width:i}),this.style=new ol.style.Style({stroke:this.stroke})},e.prototype.wasDrawn=function(){return this.feature.get("finished")},e.build=function(t,n,o,i,r){return new e(t,n,o,i,r)},e}angular.module(MODULE_NAME).factory("GeometricArc",e),e.$inject=[]}(),function(){function e(){function e(e){var o=ol.proj.fromLonLat([e.geometry.longitude,e.geometry.latitude]);n.view=new ol.View({center:o,zoom:t}),this.map=new ol.Map(n),this.featureSource=new ol.source.Vector({wrapX:!1,attributions:[new ol.Attribution({html:"PYC"})]}),this.layer=new ol.layer.Vector({source:this.featureSource,style:[]}),this.layer.setMap(this.map)}var t=5,n={layers:[new ol.layer.Tile({source:new ol.source.Stamen({layer:"toner-lite"})})],controls:ol.control.defaults({attributionOptions:{collapsible:!1}}),renderer:"canvas",target:"map"};return e.prototype.clearFeatureSource=function(){this.featureSource.clear(!0)},e.prototype.resetLayer=function(){this.featureSource.clear(!0),this.layer.setMap(null),this.layer=new ol.layer.Vector({source:this.featureSource,style:[]})},e.prototype.reinitMap=function(){this.layer.setMap(this.map)},e.build=function(t){return new e(t)},e}angular.module(MODULE_NAME).factory("GeometricMap",e),e.$inject=[]}(),function(){function e(){function e(e){this.name=e,this.totalConnections=0,this.lastActiveConnectionTotal=0,this.totalActiveConnections=0,this.levels={};for(var n=1;n<=t;n++)this.levels[n]=angular.copy(o)}var t=6,n={reach:{type:"referrals",colors:{cssClass:"md-primary",arc:["#285D63","#316472","#396B80","#42738F","#4A7A9D","#5381AC"]}},gratitude:{type:"thankyous",colors:{cssClass:"md-warn",arc:["#E34E35","#E86237","#ED7539","#F1893C","#F69C3E","#FBB040"]}}},o={total:0,connections:[]};return e.prototype.arcColors=function(){return n[this.name].colors.arc},e.prototype.colorClass=function(){return n[this.name].colors.cssClass},e.prototype.apiRouteForLevel=function(e){return"geometrics/"+n[this.name].type+"/"+e},e.prototype.addConnectionsForLevel=function(e,t){var n=e.length;this.levels[t].total!==n&&(this.levels[t]={total:n,connections:e},this.totalConnections+=n,this.lastActiveConnectionTotal=angular.copy(this.totalActiveConnections),this.totalActiveConnections=angular.copy(this.totalConnections))},e.prototype.connectionsForLevel=function(e){return this.levels[e].connections},e.prototype.setTotalActiveConnections=function(e,t){t?this.totalActiveConnections+=e:this.totalActiveConnections=e},e.build=function(t){return new e(t)},e}angular.module(MODULE_NAME).factory("Geometric",e),e.$inject=[]}(),function(){function e(e,t,n,o,i,r){n(function(){i.enabled(!1,angular.element(document.querySelector("#metrics-carousel"))),t.animateWasDisabled=!0},500),t.mapHeight=function(){var e=$(".navbar")[0].clientHeight+(t.frame.isMobile()?0:150);return{minHeight:r.innerHeight-e}},t.hideCarousel=!0,t.animateWasDisabled=!1,t.metricTitle="Overview",t.referrals=[],t.thankyous=[],t.thankyouChartIsActive=!1,t.referralChartIsActive=!1,t.thankyouEmptyMessage="Send thanks to your connections. Check back here to see how far your gratitude goes.",t.referralEmptyMessage="Help others make connections by referring them to someone you know. Check back here to see how far your reach goes.",o.get(e,"metrics/direct",{},function(e){e.hasOwnProperty("metrics_direct_thankyous")&&(t.thankyous=e.metrics_direct_thankyous),e.hasOwnProperty("metrics_direct_referrals")&&(t.referrals=e.metrics_direct_referrals)}),t.onSlideChanged=function(e){switch(e){case 0:t.mapIsActive=!1,t.thankyouChartIsActive=!1,t.referralChartIsActive=!1,t.metricTitle="Overview";break;case 1:t.mapIsActive=!1,t.thankyouChartIsActive=!0,t.referralChartIsActive=!1,t.metricTitle="Gratitude";break;case 2:t.mapIsActive=!1,t.thankyouChartIsActive=!1,t.referralChartIsActive=!0,t.metricTitle="Reach";break;case 3:t.mapIsActive=!0,t.thankyouChartIsActive=!1,t.referralChartIsActive=!1,t.metricTitle="Map"}return!0}}angular.module(MODULE_NAME).controller("MetricsController",e),e.$inject=["$rootScope","$scope","$timeout","APIGetService","$animate","$window"]}(),function(){function e(e,t){function n(e,t,n){e.$text=n.$text,e.closeDialog=function(){t.hide()}}n.$inject=["$scope","$mdDialog","$rootScope"],e.showInfoModal=function(){t.show({parent:angular.element(document.body),templateUrl:e.$view("metrics.map-info-modal"),controller:n})}}angular.module(MODULE_NAME).controller("GeometricsInfoController",e),e.$inject=["$scope","$mdDialog"]}(),function(){function e(e,t,n,o,i,r){function a(t){l=o.animateArcs(t,f,e,d,l,s)}function s(t,i){return e.inputLevel=t,f[i].levels[t].total>0?(o.buildArcsForConnections(angular.copy(i),e,f[i].levels[t].connections,d),void d.map.on("postcompose",a)):void n.get(e,f[i].apiRouteForLevel(t),function(n){var r=n.geometrics;f[i].addConnectionsForLevel(r,t),o.buildArcsForConnections(angular.copy(i),e,r,d),d.map.on("postcompose",a)})}function c(t,n){f[n].setTotalActiveConnections(0);for(var i=f[n].levels,r=1;r<=t;r++)f[n].setTotalActiveConnections(i[r].total,!0),o.buildArcsForConnections(angular.copy(e.metricType),e,i[r].connections,d,r);d.map.on("postcompose",a)}var u,l=0,d=o.build(e.authenticated.location),f={reach:i.build("reach"),gratitude:i.build("gratitude")},p=r.direct(e.authenticated.metrics.thankyous)+r.indirect(e.authenticated.metrics.thankyous);e.level=1,e.inputLevel=1,e.metricType=0!=p?"gratitude":"reach",e.autoPlay=!0,e.updateType=function(n){o.cancelQueuedArcBuilds(),e.level=1,e.inputLevel=1,e.metricType=n,f={reach:i.build("reach"),gratitude:i.build("gratitude")},l=0,d.resetLayer(),u&&t.cancel(u),u=t(function(){d.reinitMap(),s(e.level,n)},2500)},e.toggleAutoPlay=function(){return e.autoPlay=!e.autoPlay,1==e.autoPlay?void e.updateType(e.metricType):void s(e.level,e.metricType)},e.geometricClass=function(e){return f[e].colorClass()},e.updateLevel=function(t){var n=e.level>t;return e.level=t,e.autoPlay=!1,n?(l=0,d.clearFeatureSource(),void c(t,e.metricType)):void s(e.level,e.metricType)},s(e.level,e.metricType),t(function(){d.map.updateSize()},850)}angular.module(MODULE_NAME).controller("GeometricsController",e),e.$inject=["$scope","$timeout","APIGetService","MapBuilder","Geometric","metricsFactory"]}(),function(){function e(e,t,n,o){function i(){n.get(e,"notifications",{},function(t){if(a=t.notifications,e.newNotificationCount=e.authenticated.notifiers.new_notifications,e.authenticated.notifiers.new_notifications=0,r)for(var n=0,o=a.length;n<o;n++)e.notifications.unshift(a[n]);else e.notifications=t.notifications,r=e.notifications?e.notifications.length:0})}o.refferingUser=!1,o.currentNotification=null,e.notifications=[],e.linksLookup={},e.detailView={},e.networkError=!1;var r=0,a=[];e.$watch("newNotifications",function(t){t&&(i(),e.resetNotifiers())}),e.$on("notification_received",function(e,t){i()}),i(),o.hideDetail=function(){t.go("app.notifications")}}angular.module(MODULE_NAME).controller("NotificationsController",e),e.$inject=["$scope","$state","APIGetService","$rootScope"]}(),function(){function e(e,t){e.editingAuthenticated=angular.copy(e.authenticated),e.hasChangedInput=!1;var n=e.$watch("editingAuthenticated.settings.notifications",function(){e.authenticated.totalActiveNotificationSettings()!==e.editingAuthenticated.totalActiveNotificationSettings()&&(e.hasChangedInput=!0,n())},!0),o=e.$watch("editingAuthenticated.settings.receives_newsletter",function(){e.authenticated.settings.receives_newsletter!==e.editingAuthenticated.settings.receives_newsletter&&(e.hasChangedInput=!0,o())});e.update=function(n){var o=n.settings.notifications;o.receives_newsletter=n.settings.receives_newsletter,t.post(e,"settings/notifications",o,function(t){e.authenticated.settings.notifications=e.editingAuthenticated.settings.notifications,e.authenticated.settings.receives_newsletter=e.editingAuthenticated.settings.receives_newsletter,e.lazySuccessToast("Notification settings updated"),e.index()})}}angular.module(MODULE_NAME).controller("NotificationSettingsController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t,n,o,i,r){function a(e){switch(console.log(e),e.link_type){case"user":return void n.go("app.user",{userId:e.link_id});case"group":return void o.getSlug(e.link_id).then(function(e){n.go("app.network",{groupSlug:e})})}}e.notificationLinkClicked=function(e){a(e)},e.showDetail=function(e){r(function(){t.currentNotification=e,t.notificationDetailView=i.detailViewParams(e)})},e.linkFromDetailClicked=function(){var e=$("#closeNotification");e.trigger("click");var n=_.findIndex(t.currentNotification.message,function(e){return 0!=e.link});a(t.currentNotification.message[n].link)}}angular.module(MODULE_NAME).controller("NotificationController",e),e.$inject=["$scope","$rootScope","$state","groupsFactory","notificationsFactory","$timeout"]}(),function(){function e(e,t){return{restrict:"E",scope:{metricsData:"="},templateUrl:e.PATHS.VIEWS+"metrics/circles.html",link:function(e,n,o){e.directScore=0,e.indirectScore,e.metricsData&&(e.directScore=t.direct(e.metricsData[o.type]),e.indirectScore=t.indirect(e.metricsData[o.type])),e.title=o.title,e.directDescription=o.directDescription,e.indirectDescription=o.indirectDescription}}}angular.module(MODULE_NAME).directive("metricCircles",e),e.$inject=["APP_CONFIG","metricsFactory"]}(),function(e){function t(){function e(e,t,n){$(t).drawDoughnutChart([{title:"Nope, It's all just the web",value:4822,color:"#f3e32b"},{title:"Yep. They are different things with different concerns",value:12339,color:"#35a8ff"}])}return{restrict:"E",link:e}}e.module(MODULE_NAME).directive("metricDonut",t),t.$inject=[]}(angular),function(){function e(e,t){return{restrict:"E",scope:!1,replace:!0,templateUrl:e.PATHS.VIEWS+"metrics/map.html",link:function(e,n,o){var i=0,r=0;i=t.direct(e.authenticated.metrics.thankyous)+t.indirect(e.authenticated.metrics.thankyous),r=t.direct(e.authenticated.metrics.referrals)+t.indirect(e.authenticated.metrics.referrals),e.hasData=function(){return i+r!=0},e.hasThankyouData=function(){return 0!=i},e.hasReferralData=function(){return 0!=r}}}}angular.module(MODULE_NAME).directive("metricMap",e),e.$inject=["APP_CONFIG","metricsFactory"]}(),function(){function e(e,t,n){return{restrict:"E",scope:{metricsData:"=",metricEvents:"=",chartIsActive:"=",emptyMessage:"="},replace:!0,templateUrl:function(t,n){return e.PATHS.VIEWS+"metrics/section-panel/"+(n.mobile?"mobile":"desktop")+".html"},link:function(o,i,r){function a(){o.indirectPercent=0,o.indirectScore>0&&(o.indirectPercent=o.directScore/o.indirectScore*100),o.directPercent=0}function s(){o.indirectPercent=0,o.directPercent=0}o.indirectPieOptions={animate:{
duration:1200,enabled:!0},barColor:"#E13E23",trackColor:"#FBB040",scaleColor:!1,lineWidth:16,lineCap:"circle",size:160},o.directPieOptions={animate:{duration:1200,enabled:!0},barColor:"#FBB040",trackColor:"#E13E23",scaleColor:!1,lineWidth:16,lineCap:"circle",size:160},o.metricsData&&(o.directScore=t.direct(o.metricsData[r.type]),o.indirectScore=t.indirect(o.metricsData[r.type])),o.title=r.title,o.icon=e.PATHS.IMAGES+"icons/"+r.iconName+".png",a(),o.$watch("chartIsActive",function(){n(function(){o.chartIsActive?a():s()},850)})}}}angular.module(MODULE_NAME).directive("metricSectionPanel",e),e.$inject=["APP_CONFIG","metricsFactory","$timeout"]}(),function(){function e(e,t,n){function o(e,t,o,i,s){if(e===t){var c=n.build(r,e,o,i.start,i.end);c.feature&&(a[r]=c,s.featureSource.addFeature(c.feature),r++)}}function i(e,t,n){return t[e.metricType].totalActiveConnections===n&&e.isGetting===!1&&e.level<6&&e.autoPlay===!0}var r=1,a={},s=[];return this.build=function(e){return t.build(e)},this.buildArcsForConnections=function(e,t,n,o,i){for(var r=0;r<n.length;r++){var a=t.autoPlay?500*r:0;this.buildArc(e,t.metricType,i?i:t.level,n[r],a,o)}},this.cancelQueuedArcBuilds=function(){for(var t=0,n=s.length;t<n;t++)s[t]&&e.cancel(s[t]);s=[]},this.buildArc=function(t,n,i,r,a,c){0===a?o(t,n,i,r,c):s.push(e(function(){o(t,n,i,r,c)},a))},this.animateArcs=function(e,t,n,o,r,s){for(var c=o.featureSource.getFeatures(),u=0,l=c.length;u<l;u++){var d=a[c[u].get("arcId")];if(d.setStyle(t[n.metricType].arcColors()),d.wasDrawn()){if(i(n,t,r)){s(++n.level,n.metricType);break}}else n.autoPlay?d.draw(e):d.finishDrawing(),d.wasDrawn()&&r++}return e.frameState.animate=!0,r},this}angular.module(MODULE_NAME).service("MapBuilder",e),e.$inject=["$timeout","GeometricMap","GeometricArc"]}(),function(){function e(e,t){e.authenticated={},e.restrictSubmitForm=function(t){return t.$invalid||e.$parent.isPosting},e.formButtonClass=function(t){return{fadeIn:!t.email.$error.required,fadeOut:t.email.$error.required,"invalid-disabled":e.restrictSubmitForm(t)}},e.sendEmail=function(n){t.post(e.$parent,"password/remind",n,function(){e.lazySuccessToast("The password reminder was sent.","Please check your email for instructions."),e.$state.go("guest.intro")})}}angular.module(MODULE_NAME).controller("PasswordReminderController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){function n(e){return{current_password:e.current_password,password:e.password}}e.auth={current_password:"",password:"",confirmed_password:""},e.$watch("auth",function(){e.hasChangedInput||(e.hasChangedInput=e.auth.current_password.length&&e.auth.password.length&&e.auth.confirmed_password.length)},!0),e.submit=function(o){var i=o.password.length>=6&&o.password===o.confirmed_password;return i?void t.post(e,"settings/password",n(o),function(t){e.lazySuccessToast("Success!","Your password updated."),e.index()}):void e.errorToast("We’re sorry!","A new password must be at least 6 characters long and must match the confirmation.")}}angular.module(MODULE_NAME).controller("ResetPasswordController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){function n(e){return{username:e.username,headline:e.headline,uses_alias:e.settings.uses_alias,could_offer:e.could_offer,could_use:e.could_use,receives_newsletter:e.settings.receives_newsletter,bio:e.bio,interests:e.interests_list,privacy:e.privacySetting()}}e.finishRegistration=function(o){t.post(e.$parent,"profile/update/info",n(o),function(n){e.successToast("You're all set!","Thank you for joining!"),e.setAuth(n.auth),t.post(e,"app-invites/attach-parameters",{},function(e){})})}}angular.module(MODULE_NAME).controller("FinishRegistrationController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t,n){e.registrar=new Registrar(e.$state),e.editingAuthenticated=angular.copy(e.authenticated).resolveProfilePicPath().resolveSettings(),e.settings={privacy:e.editingAuthenticated.privacySetting()},e.editingAuthenticated.settings.receives_newsletter=!0,n.subscribe("registration-data-loss-warning",function(){return"Some of your input may be lost"}),e.$on("$destroy",function(){n.unsubscribe("registration-data-loss-warning")}),e.wysiwygMenu=[["font"],["font-size"],["bold","italic","underline","font-color"],["ordered-list","unordered-list","outdent","indent"],["link","image"]]}angular.module(MODULE_NAME).controller("RegistrationController",e),e.$inject=["$scope","$window","WindowLeaveEvent"]}(),function(e){function t(e,t){e.updated={email:null},e.$watch("updated.email",function(e){console.log(e)}),e.updateEmail=function(){e.requiredEmailForm.$valid&&t.post(e,"register/set-email",e.updated,function(t){e.successToast("Thank you!","Your email has been updated"),e.setAuth(t.auth)})}}e.module(MODULE_NAME).controller("RequireEmailController",t),t.$inject=["$scope","APIPostService"]}(angular),function(){function e(e,t,n,o){function i(t){o.get(e,t,{},function(t){e.setAuth(t.auth)})}function r(){return 3===e.loadingFeedback.length?void(e.loadingFeedback=""):void(e.loadingFeedback+=".")}e.loadingFeedback="...",n(r,500),t.networkName&&i("authenticate/"+t.networkName+"/login?"+t.authToken)}angular.module(MODULE_NAME).controller("SocialRegistrationController",e),e.$inject=["$scope","$stateParams","$interval","APIGetService"]}(),function(){function e(e,t){e.createAccount=function(n){t.post(e,"register/create-account",n,function(t){e.setAuth(t.auth,!0)})}}angular.module(MODULE_NAME).controller("StartRegistrationController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){e.resendEmail=function(){t.post(e,"register/verify",{},"Verification email sent!")}}angular.module(MODULE_NAME).controller("EmailVerificationController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){return{restrict:"E",scope:{adSetting:"="},replace:!0,templateUrl:e.PATHS.VIEWS+"templates/settings/card-ads-display-frequency-option.html",link:function(e,t,n){e.option={name:n.name,value:n.value}}}}angular.module(MODULE_NAME).directive("cardAdsDisplayFrequencyOption",e),e.$inject=["APP_CONFIG","$state"]}(),function(){function e(e,t){return{restrict:"E",scope:{auth:"=auth"},templateUrl:e.PATHS.VIEWS+"notifications/settings-switch-group.html",link:function(e,t,n){var o=n.modelProperty;e.questionPhrase=n.questionPhrase,e.mobileProperty="uses_"+o+"_notifications",e.emailProperty="uses_"+o+"_emails"}}}angular.module(MODULE_NAME).directive("notificationSwitchGroup",e),e.$inject=["APP_CONFIG","$state"]}(),function(){function e(e,t,n){return{restrict:"E",scope:!0,templateUrl:e.PATHS.VIEWS+"settings/section-list-item.html",replace:!0,link:function(e,n,o){e.sectionName=o.name,e.sectionDescription=o.description,e.setting=o.setting,e.show=function(e){return"notifications"===e?t.go("app.settings.notifications"):void t.go("app.settings.type",{fieldName:e})}}}}angular.module(MODULE_NAME).directive("settingsSectionListItem",e),e.$inject=["APP_CONFIG","$state","$stateParams"]}(),function(){function e(e,t,n,o){e.confirm=function(){var t=n.open({templateUrl:e.$view("settings.deactivate.confirm"),controller:"ModalController"});t.result.then(function(){t.close(),e.deactivate()})},e.deactivate=function(){o.post(e.$parent,"settings/deactivate",{},function(t){e.setAuth(null)})}}angular.module(MODULE_NAME).controller("DeactivateAccountController",e),e.$inject=["$scope","$state","$modal","APIPostService"]}(),function(){function e(e,t,n){e.index=function(){t.go("app.settings")}}angular.module(MODULE_NAME).controller("SettingsController",e),e.$inject=["$scope","$state","$stateParams"]}(),function(){function e(e,t,n){e.settings={privacy:e.authenticated.privacySetting()},e.updatePrivacySetting=function(t){n.post(e.$parent,"settings/privacy",t,function(n){e.authenticated.updatePrivacySetting(t.privacy),e.index()})}}angular.module(MODULE_NAME).controller("EditUserPrivacyController",e),e.$inject=["$scope","$state","APIPostService"]}(),function(){function e(e,t){e.showLogin=!0,e.isSaving=!1,e.signupAnimation="",e.loginAnimation="fadeInLeft",e.toggleDesktopSignupAndLoginForms=function(t){e.showLogin=!e.showLogin}}angular.module(MODULE_NAME).controller("SessionsController",e),e.$inject=["$scope","$timeout"]}(),function(){function e(e,t,n,o){e.loginFormHasInput=!1,e.authenticated={},e.showLoginButton=!0,e.login=function(t){o.post(e.$parent,"authenticate",t,function(t){e.setAuth(t.auth,void 0===e.invitation),void 0!==e.invitation&&n.go("add-email-from-invitation",e.invitation)})}}angular.module(MODULE_NAME).controller("LoginController",e),e.$inject=["$scope","$timeout","$state","APIPostService"]}(),function(){function e(e,t,n,o){e.logout=function(){t.post(e.$parent,"logout",{},function(t){e.$state.go("loading"),n.deckOpen=!1,o.clear(),e.setAuth(null)})}}angular.module(MODULE_NAME).controller("LogoutController",e),e.$inject=["$scope","APIPostService","$rootScope","connectionsFactory"]}(),function(){function e(e,t,n,o){function i(t){e.inviter=t.users[0]}function r(t){e.inviter=t.users[0],e.group=t.groups[0],e.auth.group=e.group}function a(n){for(var o in n.users){var i=n.users[o];i.user_id===t.params.referrerId?e.referrer=i:i.user_id===t.params.referredId&&(e.referred=i)}e.auth.referral={referrer:e.referrer,referred:e.referred}}e.auth={email:t.params.email,invitation:t.params.invitationId};var s,c={};switch(t.current.name){case"guest.invitation-signup.app_invite":c.users=[t.params.userId],s=i;break;case"guest.invitation-signup.group_invite":c.users=[t.params.userId],c.groups=[t.params.groupId],s=r;break;case"guest.invitation-signup.referral":c.users=[t.params.referredId,t.params.referrerId],s=a}o.get(e,"signup/lookup",c,function(e){s(e)})}angular.module(MODULE_NAME).controller("SignupFromInviteController",e),e.$inject=["$scope","$state","APIPostService","APIGetService"]}(),function(){function e(e,t,n){e.authenticated={},e.restrictSubmitForm=function(t){return t.$invalid||e.$parent.isPosting},e.formButtonClass=function(t){return{fadeIn:!t.email.$error.required,fadeOut:t.email.$error.required,"invalid-disabled":e.restrictSubmitForm(t)}},e.checkUserEmail=function(o){n.post(e.$parent,"check-email",o,function(n){e.setTemporaryAuth(o),t.go("guest.signup")})}}angular.module(MODULE_NAME).controller("SignupController",e),e.$inject=["$scope","$state","APIPostService"]}(),function(){function e(e,t,n,o,i,r){t.authorizeForNetwork=function(o){var i=t.cordovaSet?t.serverUrl:"",a=i+"/social/authenticate/"+o,s=r.make(a);return t.cordovaSet?(t.networkName=o,void s.cordovaBrowser(e,function(e){var i=t.$config("PATHS.BASE_URL"),r=e.indexOf(i+"#/guest/")!==-1,a=r&&e.indexOf("social")!==-1,s=r&&e.indexOf("intro")!==-1,c=!r&&e.indexOf(o)===-1;return a?n.go("guest.social",{networkName:o,authToken:e.substring(e.indexOf(i+"#/guest/social/"+o))}):s||(c?(t.clearToast(),t.errorToast(),console.log("error site not allowed - "+e),window.hasOwnProperty("Bugsnag")&&void 0!=Bugsnag&&Bugsnag.notifyException("social login",{diagnostics:{cause:"error site not allowed - "+e}})):console.log("site allowed - "+e)),!r&&!c})):s.webBrowser()}}angular.module(MODULE_NAME).controller("SocialAuthenticationController",e),e.$inject=["$rootScope","$scope","$state","$window","$cordovaInAppBrowser","ExternalLink"]}(),function(){function e(e,t){return{restrict:"E",scope:{contribution:"=",edit:"=",onChange:"="},templateUrl:t.view("templates.users.edit-contribution-form"),link:function(t,n,o){var i=t.contribution;t.contributionText=t.contribution.replace("_"," ");var r="PROFILE."+i.toUpperCase();t.title=e.$text(r+".TITLE"),t.info=e.$text(r+".INFO"),console.log(t.onChange)}}}angular.module(MODULE_NAME).directive("profileContributionForm",e),e.$inject=["$rootScope","Helpers"]}(),function(){function e(e){return{restrict:"E",scope:{contributor:"=",edit:"=?",mobile:"=?"},templateUrl:e.PATHS.VIEWS+"templates/profile/contribution-panel.html",link:function(e,t,n){e.title=n.title,e.property=n.property,e.contribution=e.contributor[n.property]}}}angular.module(MODULE_NAME).directive("profileContributionPanel",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e){return{restrict:"E",scope:{auth:"=",edit:"="},templateUrl:e.PATHS.VIEWS+"templates/profile/info-panel.html",link:function(e,t,n){e.title=n.title,e.property=n.property,e.authProperty=e.auth[n.property]}}}angular.module(MODULE_NAME).directive("profileInfoPanel",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t){return{restrict:"E",scope:{messenger:"=",auth:"="},replace:!0,templateUrl:e.PATHS.VIEWS+"templates/profile/messages-widget-panel.html",link:function(e,n,o){e.user=e.messenger,e.containerClass=o.mobile?{"p-0":!0}:{"p-l-10":!0,"p-r-10":!0},e.$state=t}}}angular.module(MODULE_NAME).directive("profileMessagesWidgetPanel",e),e.$inject=["APP_CONFIG","$state"]}(),function(){function e(e){function t(e,t,n){e.menu=!1}return{restrict:"E",scope:!1,templateUrl:e.PATHS.VIEWS+"templates/profile/popup-edit-menu.html",link:t}}angular.module(MODULE_NAME).directive("profilePopupEditMenu",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e){return{restrict:"A",scope:{item:"="},templateUrl:e.PATHS.VIEWS+"templates/users/search-result-item.html",link:function(e,t,n){e.user=e.item}}}angular.module(MODULE_NAME).directive("userSearchResultItem",e),e.$inject=["APP_CONFIG"]}(),function(){function e(e,t,n,o,i){function r(){e.authenticated.could_offer=e.editingAuthenticated.could_offer,e.authenticated.could_use=e.editingAuthenticated.could_use,e.authenticated.bio=e.editingAuthenticated.bio,e.authenticated.interests=e.editingAuthenticated.interests,e.authenticated.interests_list=e.editingAuthenticated.interests_list}function a(e){return{could_offer:e.could_offer,could_use:e.could_use,bio:e.bio,interests:e.interests_list}}function s(t){if(!t)return!1;var n;switch(t){case"bio":n="bio","tablet"===e.media_query&&(e.editingAuthenticated.bio=e.editingAuthenticated.bio?String(e.editingAuthenticated.bio).replace(/<[^>]+>/gm,""):"");break;case"interests":n="interests";break;case"could_offer":case"could_use":n="offer-use"}return e.$view("auth.profile."+n)}e.editingAuthenticated=angular.copy(e.authenticated),e.hasChangedInput=!1,e.propertyName=n.propertyName,e.selectedEditingView=s(n.propertyName),e.profileUpdate=!0,e.wysiwygMenu=[["font"],["font-size"],["bold","italic","underline","font-color"],["ordered-list","unordered-list","outdent","indent"],["link"]],e.inputHasChanged=function(){e.hasChangedInput=!0},e.$on("profile_info_changed",function(t,n){o(function(){e.hasChangedInput=!0})}),e.updateProfileInfo=function(t){i.post(e,"profile/update/info",a(t),function(t){r(),o(function(){e.successToast("Success!","Your profile was updated."),e.closeMenu()},500)})},e.startEditing=function(n){t.go("app.profile.info.property",{propertyName:n,profileUpdate:!0}),e.propertyName=n,e.selectedEditingView=s(n)},e.finishEditing=function(){"tablet"==e.media_query?t.go("app.profile.info"):e.updateProfileInfo(e.editingAuthenticated)}}angular.module(MODULE_NAME).controller("EditUserInfoController",e),e.$inject=["$scope","$state","$stateParams","$timeout","APIPostService"]}(),function(){function e(e,t,n){function o(){e.editingAuthenticated=angular.copy(e.authenticated),e.hasChangedInput=!1}function i(e){return{first_name:e.first_name,last_name:e.last_name,username:e.username,uses_alias:e.settings.uses_alias,headline:e.headline}}o(),e.$watch("editProfile",function(){o()}),e.$watch("editingAuthenticated",function(){e.hasChangedInput||(e.hasChangedInput=e.editingAuthenticated.first_name!==e.authenticated.first_name||e.editingAuthenticated.last_name!==e.authenticated.last_name||e.editingAuthenticated.settings.uses_alias!==e.authenticated.settings.uses_alias||e.editingAuthenticated.username!==e.authenticated.username||e.editingAuthenticated.headline!==e.authenticated.headline)},!0),e.validUsername=function(t,o){var i="";return t.firstName.$error.required&&(i+="Please provide your first name.\n"),t.firstName.$error.required&&(i+="Please provide your last name.\n"),n.check(o)||(i+="Username must be between 6 and 14 characters.\n"),t.headline.$error.maxlength&&(i+="Headline must be less than 50 characters.\n"),!i.length||(e.errorToast("Sorry",i),!1)},e.updateName=function(n){t.post(e,"settings/alias",i(n),function(t){e.authenticated.first_name=e.editingAuthenticated.first_name,e.authenticated.last_name=e.editingAuthenticated.last_name,e.authenticated.username=e.editingAuthenticated.username,e.authenticated.settings.uses_alias=e.editingAuthenticated.settings.uses_alias,e.authenticated.headline=e.editingAuthenticated.headline,e.successToast("Success!","Your profile was updated."),e.closeMenu()})}}angular.module(MODULE_NAME).controller("EditUserNameController",e),e.$inject=["$scope","APIPostService","usernameValidator"]}(),function(){function e(e,t,n,o,i){e.isGetting=!0,e.section=0,e.inputClass="",i.make(e.authenticated.profile_image_path,{always:function(){e.isGetting=!1},failed:function(){angular.element(document.querySelector(".profileimg")).css({"background-image":"url("+o.DEFAULT_PROFILE_IMAGE_PATH+")"})}}),e.setInputVal=function(){e.inputClass="input--filled"},e.toggleAddRemoveNetworks=function(t){n(function(){e.addNetworks=!1,e.removeNetworks=!1})},e.selectFromEditMenu=function(e){return t.go("app.profile."+e)},e.closeMenu=function(){return t.go("app.profile",{},{reload:!0})}}angular.module(MODULE_NAME).controller("EditUserController",e),e.$inject=["$scope","$state","$timeout","PYCUser","ImageResource"]}(),function(e){function t(t,n,o){function i(t){var n=t[0],o=t.controller("mdFabSpeedDial"),i=n.querySelectorAll(".md-fab-action-item"),a=n.querySelector("._md-css-variables"),s=parseInt(window.getComputedStyle(a).zIndex);e.forEach(i,function(e,t){var n=e.style,a=t*r;n.opacity=o.isOpen?1:0,n.transform=n.webkitTransform=o.isOpen?"scale(1)":"scale(0)",n.transitionDelay=(o.isOpen?a:i.length-a)+"ms",n.zIndex=i.length-t+s})}t.menu={open:!1,tooltipState:!1,loaded:!1,init:!1},n(function(){t.menu.loaded=!0,t.$watch("menu.open",function(e,o){var r=$(".md-fab-bottom-right");e?(r&&i(r),n(function(){t.menu.tooltipState=t.menu.open},500)):(t.menu.tooltipState=t.menu.open,r&&i(r))})}),t.$watch("menu.tooltipState",function(e,n){t.menu.open&&(t.menu.tooltipState=!0)},!0);var r=65}e.module(MODULE_NAME).controller("MobilePopupEditMenuController",t),t.$inject=["$scope","$timeout","$state"]}(angular),function(){function e(e,t,n,o){function i(){o.all().then(function(e){r({users:e})})}function r(t){n.search(e,"search","users/search",function(t){e.users=t.users,e.users&&e.users.length||(e.emptySearch=!0)},t)}e.search="",e.users=[],e.emptySearch=!1,e.requestedConnections=!1,e.$watch("search",function(t,n){e.emptySearch=!1,""==t||angular.equals({},e.referredUser)||e.requestedConnections||(e.requestedConnections=!0,i())})}angular.module(MODULE_NAME).controller("SearchUsersController",e),e.$inject=["$scope","$rootScope","APISearchService","connectionsFactory"]}(),function(){function e(e,t,n,o,i,r,a){return e.loadingContent=!0,t.userId?t.userId===e.authenticated.user_id?void n.go("app.profile"):(o.refferingUser=!0,e.user=null,void i.make("users/:userId").get(o,function(t){e.user=r.build(t.user),e.user.groups=e.authenticated.highlightMutualGroups(e.user.groups),a.make(e.user.profile_image_path,{always:function(){e.isGetting=!1},failed:function(){angular.element(document.querySelector(".profileimg")).css({"background-image":"url("+r.DEFAULT_PROFILE_IMAGE_PATH+")"})}}),e.loadingContent=!1},function(t,n){switch(n.code){case i.ERROR_CODE_NOT_FOUND:case i.ERROR_CODE_RESTRICTED:e.userNotFound=!0;break;default:e.networkError=!0}e.loadingContent=!1})):void n.go("app.decks")}angular.module(MODULE_NAME).controller("ProfileController",e),e.$inject=["$scope","$stateParams","$state","$rootScope","APIRequest","PYCUser","ImageResource"]}(),function(){function e(e,t){e.state("app",{url:"/app","abstract":!0,views:{app:{templateUrl:t.base("auth/app.html")},"sidebar@app":{templateUrl:t.base("layout/sidebar.html")},"topbar@app":{templateUrl:t.base("layout/top-navbar.html")}},middleware:"auth"}).state("app.metrics",{url:"/metrics",views:{"content@app":{templateUrl:t.base("metrics/index/container.html"),controller:"MetricsController"},"desktop@app.metrics":{templateUrl:t.base("metrics/index/desktop.html")},"mobile@app.metrics":{templateUrl:t.base("metrics/index/mobile.html")},"settings@app":{template:""}},navigation:{uses_menu_drawer:!0},middleware:"auth"}).state("app.connections",{url:"/connections",views:{"content@app":{templateUrl:t.base("connections/list.html")}},navigation:{uses_menu_drawer:!0},middleware:"auth"}).state("app.connections.auto-connect",{url:"/auto-connect",views:{"content@app":{templateUrl:t.base("connections/auto-setup.html"),controller:"AutoConnectFormController"}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.connections.auto-connect.step",{url:"/:step",views:{"step@app.connections.auto-connect":{templateUrl:function(e){return t.base("connections/auto-"+e.step+".html")}}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.user",{url:"/users/:userId",views:t.splitForMobile("auth/users","app.user","ProfileController"),navigation:{uses_menu_drawer:!1,back_button_state:"app.decks"},middleware:"auth"}).state("app.user.refer",{url:"/refer/:referralAction",navigation:{uses_menu_drawer:!1,back_button_state:"app.user"},middleware:"auth"}).state("app.network",{url:"/networks/:groupSlug",views:{"content@app":{templateUrl:t.base("templates/groups/show.html"),controller:"GroupController"}},navigation:{uses_menu_drawer:!1,back_button_state:"app.user"},middleware:"auth"}).state("app.network-from-signup",{url:"/networks/:groupSlug/fromSignup/:groupPageSubdomain",views:{"content@app":{templateUrl:t.base("templates/groups/show.html"),controller:"GroupController"}},navigation:{uses_menu_drawer:!1,back_button_state:"app.user"},middleware:"auth"}).state("app.help",{url:"/help",views:{"content@app":{templateUrl:t.base("help.html"),controller:"HelpController"}},navigation:{uses_menu_drawer:!1},middleware:"auth"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("app.decks",{url:"/decks",views:{"content@app":{templateUrl:t.base("decks/index.html"),controller:"DecksController"},"tour@app":{templateUrl:t.base("templates/walkthrough/container.html")}},navigation:{uses_menu_drawer:!0},middleware:"auth"}).state("app.decks.show",{url:"/:deckSlug",views:{"content@app":{templateUrl:t.base("decks/show.html"),controller:"DeckController"}},navigation:{uses_menu_drawer:!1,back_button_state:"app.decks",levels_deep:1},middleware:"auth"}).state("app.cards",{url:"/cards",views:{"settings@app":{templateUrl:t.base("decks/filter-button.html"),controller:"DeckSettingsController"},"content@app":{templateUrl:t.base("decks/cards/container.html"),controller:"CardsController"},"desktop@app.cards":{templateUrl:t.base("decks/cards/desktop.html")},"mobile@app.cards":{templateUrl:t.base("decks/cards/mobile.html")},"tour@app":{templateUrl:t.base("templates/walkthrough/container.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.decks",levels_deep:1},middleware:"auth"}).state("app.cards.refer",{url:"/refer/:referralAction",navigation:{uses_menu_drawer:!1,back_button_state:"app.cards",levels_deep:2},middleware:"auth"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("app.profile",{url:"/edit-profile",views:t.splitForMobile("auth/profile","app.profile","EditUserController"),navigation:{uses_menu_drawer:!0},middleware:"auth"}).state("app.profile.name",{url:"/name",views:{"content@app.profile":{templateUrl:t.base("auth/profile/name.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.profile",levels_deep:1},middleware:"auth"}).state("app.profile.image",{url:"/picture",views:{"content@app.profile":{controller:"ProfileEditImageController",templateUrl:t.base("auth/profile/image.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.profile",levels_deep:1},middleware:"auth"}).state("app.profile.info",{url:"/info",views:{"content@app.profile":{templateUrl:t.base("auth/profile/info.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.profile",levels_deep:1},middleware:"auth"}).state("app.profile.info.property",{url:"/:propertyName",navigation:{uses_menu_drawer:!1,back_button_state:"app.profile.info",levels_deep:2},middleware:"auth"}).state("app.profile.location",{url:"/location",views:{"content@app.profile":{templateUrl:t.base("auth/profile/location.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.profile",levels_deep:1},middleware:"auth"}).state("app.profile.groups",{url:"/networks",views:{"content@app.profile":{templateUrl:t.base("auth/profile/groups.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.profile",levels_deep:1},middleware:"auth"}).state("app.profile.groups.manage",{url:"/manage",navigation:{uses_menu_drawer:!1,back_button_state:"app.profile.groups",levels_deep:2},middleware:"auth"}).state("app.settings",{url:"/settings",views:{"content@app":{templateUrl:t.base("settings/index.html"),controller:"SettingsController"}},navigation:{uses_menu_drawer:!0},middleware:"auth"}).state("app.settings.terms",{url:"/terms",views:{"content@app.settings":{templateUrl:t.base("terms.html"),controller:"LegalController"}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.settings.privacy",{url:"/privacy-policy",views:{"content@app.settings":{templateUrl:t.base("privacy-policy.html"),controller:"LegalController"}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.settings.notifications",{url:"/notifications",views:{"content@app.settings":{templateUrl:t.base("notifications/settings.html"),controller:"NotificationSettingsController"}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.settings.type",{url:"/:fieldName",views:{"content@app.settings":{templateUrl:function(e){var n="settings/"+e.fieldName;return"settings/pour-more"===n?n="ads/settings":"settings/social-accounts"===n&&(n+="/index"),t.base(n+".html")}},"ads-enabled-status":{templateUrl:t.base("ads/settings-enabled-status.html")},"cards-ad-frequency":{templateUrl:t.base("ads/settings-card-frequency.html")},beneficiaries:{templateUrl:t.base("ads/settings-beneficiaries.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.settings",levels_deep:2},middleware:"auth"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("app.mailbox",{url:"/conversations",views:{"content@app":{templateUrl:t.base("conversations/index/container.html"),controller:"ConversationsController"},"desktop@app.mailbox":{templateUrl:t.base("conversations/index/desktop.html")},"mobile@app.mailbox":{templateUrl:t.base("conversations/index/mobile.html")},"settings@app":{template:""}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.mailbox.search",{url:"/search",views:{"chat@app.mailbox":{templateUrl:t.base("conversations/search/desktop.html")},"mobile@app.mailbox":{templateUrl:t.base("conversations/search/mobile.html")}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.mailbox.show",{url:"/:conversationId",views:{"chat@app.mailbox":{templateUrl:t.base("conversations/show/desktop.html")},"mobile@app.mailbox":{templateUrl:t.base("conversations/show/mobile.html")}},navigation:{uses_menu_drawer:!1,back_button_state:"app.mailbox"},middleware:"auth"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("app.notifications",{url:"/notifications",views:{"content@app":{templateUrl:t.base("notifications/index.html")}},navigation:{uses_menu_drawer:!1},middleware:"auth"}).state("app.notifications.show",{url:"/:notificationId",navigation:{uses_menu_drawer:!1,back_button_state:"app.notifications"},middleware:"auth"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("guest",{url:"/guest","abstract":!0,views:{app:{template:'<div class="ng-fadeOutZoom ng-fluid guest-container no-scroll" ui-view="" autoscroll="false"></div>'}},middleware:"guest"}).state("guest.intro",{url:"/intro",views:t.splitForMobile("guest","guest.intro","SessionsController",""),middleware:"guest"}).state("guest.password",{url:"/password",views:t.splitForMobile("guest/password-reminder","guest.password","PasswordReminderController",""),middleware:"guest"}).state("guest.social",{url:"/social/:networkName/:authToken",templateUrl:t.base("guest/social/index.html"),controller:"SocialRegistrationController"}).state("guest.signup",{url:"/register",views:t.splitForMobile("guest/register","guest.signup","StartRegistrationController",""),middleware:"guest"}).state("guest.privacy",{url:"/privacy-policy",templateUrl:t.base("privacy-policy.html"),controller:"LegalController",middleware:"guest"})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("guest.invitation-signup",{url:"/signup/:invitationId",templateUrl:t.base("guest/invitation-signup/container.html"),"abstract":!0,controller:"SignupFromInviteController",middleware:"guest",navigation:{uses_menu_drawer:!0}}).state("guest.invitation-signup.app_invite",{url:"/app-invite/:email/from/:userId",views:{"invitation-message":{templateUrl:t.base("guest/invitation-signup/app-invite.html")}},middleware:"guest",navigation:{uses_menu_drawer:!0,back_button_state:"guest.intro"}}).state("guest.invitation-signup.group_invite",{url:"/network-invite/:email/networks/:groupId/from/:userId",views:{"invitation-message":{templateUrl:t.base("guest/invitation-signup/group-invite.html")}},middleware:"guest",navigation:{uses_menu_drawer:!0,back_button_state:"guest.intro"}}).state("guest.invitation-signup.referral",{url:"/referral/:email/to/:referredId/from/:referrerId",views:{"invitation-message":{templateUrl:t.base("guest/invitation-signup/referral.html")}},middleware:"guest",navigation:{uses_menu_drawer:!0,back_button_state:"guest.intro"}})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}(),function(){function e(e,t){e.state("register",{url:"/register",views:{app:{templateUrl:t.base("registration/container.html")}},middleware:"unregistered"}).state("requireEmail",{url:"/register-email",views:{app:{templateUrl:t.base("registration/require-email.html")}},middleware:"invalidEmail"}).state("register.privacy",{url:"/privacy",views:{"child@register":{templateUrl:t.base("privacy-policy.html"),controller:"LegalController"}}}).state("register.terms",{url:"/terms",views:{"child@register":{templateUrl:t.base("terms.html"),controller:"LegalController"}}}).state("register.networks",{url:"/select-networks",views:{"step@register":{templateUrl:t.base("registration/steps/groups.html")}}}).state("register.networks.search",{url:"/search",views:{"content@register.networks":{templateUrl:t.base("templates/groups/search-form.html")}}}).state("register.location",{url:"/add-location",views:{"step@register":{templateUrl:t.base("registration/steps/location.html")}}}).state("register.offer_use",{url:"/profile-card",views:{"step@register":{templateUrl:t.base("registration/steps/offer_use.html")}}}).state("register.image",{url:"/profile-image",views:{"step@register":{templateUrl:t.base("registration/steps/image.html")}}}).state("register.info",{url:"/profile-info",views:{"step@register":{templateUrl:t.base("registration/steps/info.html")}}}).state("register.info.bio",{url:"/bio",views:{"content@register.info":{templateUrl:t.base("registration/steps/bio.html")}}}).state("register.info.interests",{url:"/interests",views:{"content@register.info":{templateUrl:t.base("registration/steps/interests.html")}}})}angular.module(MODULE_NAME).config(e),e.$inject=["$stateProvider","RouteProvider"]}();var MODULE_NAME="pyc";angular.module(MODULE_NAME).directive("walkthrough",["$log","$timeout","$window","$injector","$rootScope","tourFactory","$mdDialog",function(e,t,n,o,i,r,a){
var s=".walkthrough-text",c=".walkthrough-hole",u=".walkthrough-icon",l=".walkthrough-arrow",d="arrowSVG",f="done-button",p=["mouseup","mousedown","click","touch"];return{restrict:"E",transclude:!0,templateUrl:i.$view("templates.walkthrough.step"),scope:{walkthroughType:"@",isActive:"=",icon:"@",focusElementId:"@",buttonCaption:"@",mainCaption:"@",forceCaptionLocation:"@",hasGlow:"=",useButton:"=",hideArrow:"=",dialog:"=",isBindClickEventToBody:"=",onWalkthroughShow:"&",onWalkthroughHide:"&"},link:function(o,h,m,g,v){function y(){o.walkthroughFocusElement=angular.element(document.getElementById(m.focusElementId)),o.walkthroughHoleElements=angular.element(h[0].querySelectorAll(c)),o.walkthroughTextElement=angular.element(h[0].querySelector(s)),o.walkthroughIconElement=angular.element(h[0].querySelector(u)),o.walkthroughArrowElement=angular.element(h[0].querySelector(l)),o.arrowElement=angular.element(h[0].querySelector("#"+d)),o.walkthroughButtonElement=angular.element(h[0].querySelector("#"+f))}function _(e){o.useButton||(e.stopPropagation(),e.preventDefault(),"click"==o.clickEvent?o.onCloseClicked(e):o.onCloseTouched(e),t(function(){b()},1e3))}function w(){o.setFocusOnElement(m.focusElementId,o.icon)}function b(){angular.forEach(p,function(e){angular.element(document.body).off(e,_)})}function E(){t(function(){angular.forEach(p,function(e){angular.element(document.body).on(e,_)})},1e3)}function k(){angular.element(n).on("resize",w)}function $(){angular.element(n).off("resize",w)}o.isReady=!1;var A=function(e){e.clickEvent="click",e.closeWalkthrough=function(){e.onWalkthroughHide(),e.isActive=!1},e.onCloseClicked=function(t){e.closeWalkthrough(),t.stopPropagation()},e.onCloseTouched=function(t){"touch"==e.clickEvent&&e.closeWalkthrough(),t.stopPropagation()},e.closeIcon=i.$image("icons/hotspot-close.png"),e.walkthroughIcon=r.getIcon(e.icon)},C=function(){var e=r.getFocusDimensions(o.walkthroughFocusElement,o.isRound);o.walkthroughHoleElements.attr("style",e)},S=function(){var e=r.getTextDimensions(o.walkthroughTextElement,o.walkthroughButtonElement,o.walkthroughFocusElement);if(o.walkthroughTextElement.attr("style",e),"tablet"==i.media_query)o.walkthroughButtonElement.addClass("bottom");else{o.walkthroughButtonElement.removeClass("bottom");var t=r.getButtonDimensions(o.walkthroughButtonElement,o.walkthroughTextElement,o.walkthroughFocusElement);o.walkthroughButtonElement.attr("style",t)}if(!o.hideArrow){var n=r.getArrowDimensions(o.walkthroughTextElement,o.walkthroughFocusElement),a=document.getElementById(d);a&&a.remove(),o.walkthroughArrowElement.append(n)}};o.setFocusOnElement=function(t,n){if(y(),"dialog"==o.walkthroughType){var i=o.dialog;if(o.walkthroughFocusElement.length>0){var s=r.getOffsetCoordinates(o.walkthroughFocusElement);i._options&&(i._options.openFrom={height:s.height,width:s.width,top:s.top,left:s.left})}a.cancel(),a.show(i)["finally"](function(){o.closeWalkthrough(),i=void 0})}o.walkthroughFocusElement.length>0?(o.isRound=r.isRound(o.walkthroughFocusElement),C(),"arrow"==n&&o.$applyAsync(function(){S()})):t&&e.info("Unable to find element requested to be focused: #"+t)},v(function(e){A(o);var t=e.text().trim();0===t.length&&e.length<=1||(o.hasTransclude=!0)}),o.$watch("isActive",function(n){n?t(function(){if(o.isReady=!0,k(),o.isBindClickEventToBody&&E(),!o.hasTransclude)try{o.setFocusOnElement(m.focusElementId,o.icon)}catch(t){e.warn("failed to focus on element prior to timeout: "+m.focusElementId),e.warn(t)}o.onWalkthroughShow()},400):$()},!0)}}}]),function(){function e(e){e.includeBar=!0,e.includeSpinner=!1,e.latencyThreshold=100,e.parentSelector=".app-container > header"}angular.module(MODULE_NAME).config(e),e.$inject=["cfpLoadingBarProvider"]}(),function(){function e(e,t,n){function o(){t(function(){r&&(r=!1,n.complete())},2500)}var i,r=!1;e.$on("$stateChangeStart",function(e,o,a,s,c){$(".app-container > section").length&&(r||(i=t(function(){n.start()},50)))}),e.$on("$stateChangeSuccess",function(e,o,r,a,s){e.targetScope.$watch("$viewContentLoaded",function(){t.cancel(i),n.complete()})}),e.$on("cfpLoadingBar:started",function(e,t){r=!0,o()}),e.$on("cfpLoadingBar:loaded",function(e,t){r=!1})}angular.module(MODULE_NAME).run(e),e.$inject=["$rootScope","$timeout","cfpLoadingBar"]}(),function(){function e(e,t){function n(n,i){"string"==typeof i&&(i={content:i}),_.forIn(o,function(e,t){i.hasOwnProperty(t)||(i[t]=e)});var r=i.onClose;i.onClose=function(){t.hide(),r&&r()},this.dialog={parent:angular.element(document.body),hasBackdrop:!0,templateUrl:e.view("components.alerts."+n),controller:"AlertDialogController",locals:{bound:i}}}var o={buttonTitle:"Ok!",iconClass:""};return n.prototype.show=function(){t.show(this.dialog)},n.make=function(e,t){return new n(e,t)},n.hide=function(){t.hide()},n.cancel=function(){t.cancel()},n}angular.module(MODULE_NAME).factory("AlertDialog",e),e.$inject=["Helpers","$mdDialog"]}(),function(){function e(e,t){_.forIn(t,function(t,n){e[n]=t}),e.close=function(){t.onClose()}}angular.module(MODULE_NAME).controller("AlertDialogController",e),e.$inject=["$scope","bound"]}(),function(){function e(){function e(e,t,n){if(e.chainedAnimations||(e.chainedAnimations=[]),e.chainedAnimations.push({element:t,animation:n.chainedAnimation}),!t.parents("[chained-animation]").length){var o=1e3;angular.forEach(e.chainedAnimations,function(e,t){var n=$(e.element).offset(),i=.8*n.left+n.top,r=parseFloat(i/o).toFixed(2);setTimeout(function(){$(e.element).css("-webkit-animation-delay",r+"s").css("-o-animation-delay",r+"s").css("animation-delay",r+"s").addClass("animated").addClass(e.animation)},r)})}}return{restrict:"A",link:e}}angular.module(MODULE_NAME).directive("chainedAnimation",e)}(),function(){function e(e,t){return{restrict:"A",link:function(n,o,i){function r(){var e=0;if(o.parent().children().each(function(t,n){var o=a(n);o&&o>0&&(e+=o)}),o.parent()[0].clientHeight>0){var t=o.parent().height(),n=$(o)[0].clientHeight,i=e-n,r=t-i;r&&r>0&&(o.css({height:r}),o.trigger("update.dot"))}}function a(e){e="string"==typeof e?document.querySelector(e):e;var t=window.getComputedStyle(e),n=parseFloat(t.marginTop)+parseFloat(t.marginBottom);return Math.ceil(e.offsetHeight+n)}angular.element(o).ready(function(){e(function(){n.orgContent=o.children().first(),o.dotdotdot({callback:function(e,t){}}),r()},0)}),angular.element(t).on("resize",function(e){o.trigger("destroy.dot"),o.dotdotdot({callback:function(e,t){}}),r()})}}}angular.module(MODULE_NAME).directive("dotdotdot",e),e.$inject=["$timeout","$window"]}(),function(){function e(e){return{restrict:"A",scope:{hoverClass:"@"},link:function(t,n,o){var i=null;o.parent&&(i=n.find("[hover-class]"),n.on("mouseenter",function(){angular.forEach(i,function(e){var t=angular.element(e);t.removeClass(e.getAttribute("no-hover")),t.addClass(e.getAttribute("hover-class"))})}),n.on("mouseleave",function(){angular.forEach(i,function(e){var t=angular.element(e);t.removeClass(e.getAttribute("hover-class")),t.addClass(e.getAttribute("no-hover"))})}),e(function(){angular.forEach(i,function(e){var t=angular.element(e);t.addClass(e.getAttribute("no-hover"))})},500))}}}angular.module(MODULE_NAME).directive("hoverClass",e),e.$inject=["$timeout"]}(),function(){function e(e){return{restrict:"E",scope:{},replace:!0,templateUrl:e.view("templates.common.page-title"),link:function(e,t,n){e.title=n.title}}}angular.module(MODULE_NAME).directive("pageTitle",e),e.$inject=["Helpers"]}(),function(){function e(e,t,n){var o=["wheelSpeed","wheelPropagation","minScrollbarLength","useBothWheelAxes","useKeyboard","suppressScrollX","suppressScrollY","scrollXMarginOffset","scrollYMarginOffset","includePadding"],i={wheelSpeed:.5,minScrollbarLength:50,suppressScrollX:!0,includePadding:!0,wheelPropagation:!1};return{restrict:"EA",transclude:!0,scope:{watchOffset:"=",updateScroll:"="},template:'<div class="touch-enabled" ng-style="containerHeight()" class="perfectly-scrollable"><div ng-transclude></div></div>',replace:!0,link:function(r,a,s,c,u){angular.element(a).ready(function(){function c(e){r.$evalAsync(function(){"true"==s.scrollDown&&setTimeout(function(){$(a).animate({scrollTop:$(a).prop("scrollHeight")},"slow")},500),a.perfectScrollbar("update")})}r.containerHeight=function(){r.offset=s.offset?s.offset:0,void 0!==r.watchOffset&&(r.offset=r.watchOffset);var e=n.frame.containerHeight(r.offset,!0);return s.height&&(e=s.height),{height:e,"overflow-y":n.frame.isMobile()&&void 0===s.mobile?"scroll":"hidden","overflow-x":"hidden",position:"relative"}};for(var l=angular.element(t),d={},f=0,p=o.length;f<p;f++){var h=o[f];void 0!==s[h]?d[h]=e(s[h])():i.hasOwnProperty(h)&&(d[h]=i[h])}n.frame.isMobile()&&void 0===s.mobile?l.on("resize",function(e,t){s.handleKeyboard&&r.$evalAsync(function(){setTimeout(function(){$(a).scrollTop($(a).prop("scrollHeight"))},100),a.perfectScrollbar("update")})}):(r.$evalAsync(function(){a.perfectScrollbar(d);var t=e(s.onScroll);a.scroll(function(){var e=a.scrollTop(),n=a.prop("scrollHeight")-a.height();r.$apply(function(){t(r,{scrollTop:e,scrollHeight:n})})})}),a.bind("mouseenter",c("mouseenter")),l.on("resize",c),r.$watch(function(){return a.is(":visible")},function(){a.perfectScrollbar("update")})),a.bind("$destroy",function(){l.off("resize",c),a.perfectScrollbar("destroy")}),s.scrollDown&&r.$evalAsync(function(){setTimeout(function(){$(a).animate({scrollTop:$(a).prop("scrollHeight")},"fast")},1e3)}),u(r.$parent,function(e,t){}),r.$watch("offset",function(e){null!=e&&a.perfectScrollbar("update")}),s.updateScroll&&r.$watch("updateScroll",function(e){null!=e&&e&&setTimeout(function(){$(a).animate({scrollTop:$(a).prop("scrollHeight")},"slow"),a.perfectScrollbar("update"),r.updateScroll=!1,console.log("update")},500)}),r.updateScroll=function(){a.perfectScrollbar("update")}})}}}angular.module(MODULE_NAME).directive("perfectScrollbar",e),e.$inject=["$parse","$window","$rootScope"]}(),function(){function e(e){function t(t,n,o){var i,r,a,s;n.append('<span class="ripple"></span>'),n.on("click touchstart",function(t){var n=t.type,o=$(this).children(".ripple"),c=o.children(".angular-ripple");c=c.length?c[0]:null,o=o[0],null===c&&(c=document.createElement("span"),$(c).addClass("angular-ripple"),o.insertBefore(c,o.firstChild),c.offsetHeight||c.offsetWidth||(a=Math.max(o.offsetWidth,o.offsetHeight),c.style.width=a+"px",c.style.height=a+"px")),$(c).removeClass("animate"),"click"===n?(i=t.pageX,r=t.pageY):"touchstart"===n&&(i=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY),s=$(c).parent().offset(),c.style.left=i-s.left-a/2+"px",c.style.top=r-s.top-a/2+"px",$(c).addClass("animate"),e(function(){$(c).removeClass("animate")},500)})}return{restrict:"A",link:t}}angular.module(MODULE_NAME).directive("ripple",e),e.$inject=["$timeout"]}(),function(){function e(e){return function(t,n,o){t.$watch(o.showFocus,function(t){e(function(){t&&n.focus()})},!0)}}angular.module(MODULE_NAME).directive("showFocus",e),e.$inject=["$timeout"]}(),function(){function e(e,t){e.currentStatus=angular.copy(e.authenticated.settings.ads.are_enabled),e.updateStatus=function(n){t.post(e.$parent,"settings/ads/toggle-status",{},function(t){e.authenticated.settings.ads.are_enabled=n,e.successToast("Ad Settings Updated")})}}angular.module(MODULE_NAME).controller("UpdateAdSettingsStatusController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){e.setting={display_frequency:angular.copy(e.authenticated.settings.ads.card_display_frequency)},e.updateSetting=function(n){t.post(e.$parent,"settings/ads/cards-display-frequency",n,function(t){e.authenticated.settings.ads.card_display_frequency=n.display_frequency,e.successToast("Ad Settings Updated")})}}angular.module(MODULE_NAME).controller("UpdateAdCardFrequencyController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){function n(e,t){var n=_.findIndex(t,function(t){return t.email_address==e});return n!==-1}e.$watch("newEmailAccount",function(){e.responseError=null}),e.addAccount=function(o){return n(o,e.authenticated.email_accounts)?void e.errorToast("Hmm...","It seems like this email account has already been added."):void t.post(e.$parent,"settings/emails/add",{email:o},function(t){e.successToast("Got it!","Check your email to verify the account."),e.authenticated.email_accounts.push({email_address:e.newEmailAccount,is_default:!1,is_verified:!1}),e.addingEmailAccount=!1,e.newEmailAccount=null})},e.showAddEmailForm=function(){e.newEmailAccount=null,e.addingEmailAccount=!0}}angular.module(MODULE_NAME).controller("AddEmailAccountController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t,n,o,i,r){e.editingDefault=!1;var a=angular.copy(e.authenticated.default_email);o.theme="bs3",i.bs3.inputClass="input",i.bs3.buttonsClass="btn-sm",i.bs3.submitTpl='<button type="submit" class="btn btn-success"><span class="fa fa-check"></span></button>',i.bs3.cancelTpl='<button type="button" class="btn btn-danger" ng-click="$form.$cancel()"><span class="fa fa-times"></span></button>',e.editDefault=function(t){e.editingDefault=!0,t&&t.$show()},e.updateDefault=function(t){if(t!==a){var o=r.defer();return n.post(e.$parent,"settings/emails/default",{email:t},function(n){e.successToast("Success!","The requested email has been set as the default."),e.$parent.updateEmailAccounts(angular.copy(n.email_accounts),t),a=t,o.resolve()}).error(function(){response.reject()}),o.promise}}}angular.module(MODULE_NAME).controller("DefaultEmailAccountController",e),e.$inject=["$scope","$timeout","APIPostService","editableOptions","editableThemes","$q"]}(),function(){function e(e,t){e.emailAccountShown="",e.isSaving=!1,e.defaultEmail=e.authenticated.default_email,e.verifiedEmailAccounts=_.filter(e.authenticated.email_accounts,function(e){return e.is_verified}),e.toggleEmailAccountDetail=function(t){e.emailAccountShown=e.emailAccountShown===t?"":t},e.updateEmailAccounts=function(n,o){t(function(){e.authenticated.email_accounts=n,e.emailAccountShown="",e.defaultEmail=o,e.verifiedEmailAccounts=_.filter(e.authenticated.email_accounts,function(e){return e.is_verified})})}}angular.module(MODULE_NAME).controller("EmailSettingsController",e),e.$inject=["$scope","$timeout"]}(),function(){function e(e,t){e.removeAccount=function(n){t.post(e.$parent,"settings/emails/remove",{email:n},function(t){_.remove(e.authenticated.email_accounts,function(e){return e.email_address===n}),e.successToast("Got it!","The requested email account was removed.")})}}angular.module(MODULE_NAME).controller("RemoveEmailAccountController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t){e.sendEmail=function(n){t.post(e.$parent,"settings/emails/reverify",{email:n},"A verification was sent to your email.")}}angular.module(MODULE_NAME).controller("ReverifyEmailAccountController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t,n,o,i){function r(t){e.$modal("settings.social-accounts.disconnect",{network:t},function(){return e.authenticated.settings.has_password||1!==e.authenticated.totalSocialAccounts()?void s(t):a(t)})}function a(t){e.auth={password:"",confirmed_password:""},e.$modal("settings.social-accounts.password",{network:t,auth:e.auth,validate:function(t){var n=t.auth.password.length>=6&&t.auth.password===t.auth.confirmed_password;return n||e.errorToast("We’re sorry!","A new password must be at least 6 characters long and must match the confirmation."),n}},function(){Request.api("social/password").bind(e.auth).post({success:function(){e.authenticated.settings.has_password=!0,e.auth={},e.successToast("Success"),r(t)},error:function(){e.errorToast()}})})}function s(t){Request.api("social-accounts/"+t+"/detach").post({success:function(n){e.authenticated.settings.social_accounts[t]=!1,e.accounts[t]=!1,e.successToast("Success")},error:function(){e.errorToast()}})}e.accounts=angular.copy(e.authenticated.settings.social_accounts),e.toggleSocialAccount=function(t){if(e.accounts[t])return r(t);var n=i.cordovaSet?i.serverUrl:"",a=n+"/social/"+t+"/attach/",s=o.make(a);return i.cordovaSet?void s.cordovaBrowserWithNoCache(i,function(n){var o=n.indexOf("status=success")!==-1,i=n.indexOf("error=")!==-1;return o?(e.authenticated.settings.social_accounts[t]=!0,e.accounts[t]=!0,e.successToast("Success"),!1):i?(e.clearToast(),e.errorToast(),!1):(console.log("site allowed - "+n),!0)}):s.webBrowser()}}angular.module(MODULE_NAME).controller("EditSocialAccountsController",e),e.$inject=["$scope","$state","$cordovaInAppBrowser","ExternalLink","$rootScope"]}(),function(){function e(e,t,n,o,i,r){function a(t){e.errorToast("Error getting image")}function s(){var t={quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!0,cameraDirection:0,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1,correctOrientation:!0};i.getPicture(t).then(function(t){r(function(){e.profile_image="data:image/jpeg;base64,"+t,e.crop={src:e.profile_image,coords:[0,0,n.widthLimit,n.heightLimit,n.widthLimit,n.heightLimit]},e.file=e.profile_image})},function(t){e.errorToast("We couldn't find your image.","Please try again.")})}function c(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}e.profile_image=null,e.crop={},e.profile_image=t.includes("app.profile.image")?e.authenticated.profile_image_path:e.$parent.editingAuthenticated.profile_image_path,e.crop={src:e.profile_image,coords:[0,0,n.widthLimit,n.heightLimit,n.widthLimit,n.heightLimit]},e.newImage=function(){e.profile_image=t.includes("app.profile.image")?e.authenticated.profile_image_path:e.$parent.editingAuthenticated.profile_image_path,e.crop.coords=[0,0,0,0,n.widthLimit,n.heightLimit],e.$broadcast("refreshSelection",e.profile_image)},e.thumbnailStyle=function(){return"tablet"!==e.media_query?{}:{position:"absolute",left:-1e3,top:-1e3}},e.file,e.$on("JcropChangeSrc",function(t,n,o){e.file=o}),e.uploadMobileImage=function(){MobileDevice.current.checkForCameraPermission(s,a)},e.saveImage=function(t,n){var i;if(e.cordovaSet){var r=document.getElementById("profile-mobile-image");console.log(r),i=c({image_path_x:0,image_path_y:0,image_path_w:r.naturalWidth,image_path_h:r.naturalHeight})}else i=c({image_path_x:t[0],image_path_y:t[1],image_path_w:t[2]-t[0],image_path_h:t[3]-t[1]});console.log(i);var a=new FormData,s=!1;e.file&&(a.append("image_path",e.file),s=!0),o.post(e,"profile/update/image?"+i,a,function(t){var o=t.image_path+"?version="+(new Date).getTime();void 0!==n?(e.$parent.editingAuthenticated.profile_image_path=o,e.lazySuccessToast("Success!","Profile Picture Saved"),n.nextStep()):(e.authenticated.profile_image_path=o,e.successToast("Success!","Profile Updated"),e.closeMenu(0),e.newImage())},s)}}angular.module(MODULE_NAME).controller("ProfileEditImageController",e),e.$inject=["$scope","$state","ngJcropConfig","APIPostService","$cordovaCamera","$timeout"]}(),function(){function e(e,t){e.beneficiaries=[],t.get(e.$parent,"beneficiaries",{},function(t){e.beneficiaries=t.beneficiaries})}angular.module(MODULE_NAME).controller("BeneficiariesController",e),e.$inject=["$scope","APIGetService"]}(),function(){function e(e,t){e.updateSetting=function(n){e.authenticated.settings.ads.are_enabled?t.post(e.$parent,"settings/ads/beneficiary",n,function(t){e.authenticated.settings.ads.selected_beneficiary_id=n.group_id,e.successToast("Ad Settings Updated")}):e.errorToast("","You must turn on advertisements to select a beneficiary")}}angular.module(MODULE_NAME).controller("UpdateBeneficiaryAdSettingController",e),e.$inject=["$scope","APIPostService"]}(),function(){function e(e,t,n){function o(t){e.$modal("settings.donation-modal",{beneficiary:t,auth:e.authenticated},function(){},function(){})}e.donate=function(e){switch(e.donate_method){case"external_url":n.make(e.donation_key).webBrowser();break;case"paypal_email":o(e)}}}angular.module(MODULE_NAME).controller("DonateController",e),e.$inject=["$scope","$mdDialog","ExternalLink"]}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Carbon=function(){function e(t,n){_classCallCheck(this,e),void 0===n&&(this.date=moment(t)),this.date=moment(t,n)}return _createClass(e,[{key:"format",value:function(e){return this.date.format(e)}},{key:"diffForHumans",value:function(){return this.date.fromNow()}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Collection=function(){function e(t){_classCallCheck(this,e),tb.reflect(t).isClass(e)&&(t=t.all()),this.items=t}return _createClass(e,[{key:"all",value:function(){return this.items}},{key:"avg",value:function(e){return void 0!==e?_.meanBy(this.items,e):_.mean(this.items)}},{key:"chunk",value:function(t){return this.items=_.chunk(this.items,t),this.items=e.collect(this.items).transform(function(t){return e.collect(t)}).all(),this}},{key:"combine",value:function(e){}},{key:"contains",value:function(e){return _.includes(this.items,e)}},{key:"count",value:function(){return _.size(this.items)}},{key:"diff",value:function(e){}},{key:"each",value:function(e){_.forIn(this.items,function(t,n){e(t,n)})}},{key:"equals",value:function(e){return _.isEqual(this.items,e)}},{key:"every",value:function(e){}},{key:"except",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.items=_.omit(this.items,t),this}},{key:"filter",value:function(e){return this.items=_.filter(this.items,e),this}},{key:"first",value:function t(){var t;return this.each(function(e,n){t=e}),t}},{key:"flatMap",value:function(e){}},{key:"flatten",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.items=e===!0?_.flattenDeep(this.items):_.flattenDepth(this.items,e),this}},{key:"flip",value:function(){return this.items=_.invert(this.items),this}},{key:"forget",value:function(e){return _.unset(this.items,e),this}},{key:"forPage",value:function(e,t){}},{key:"get",value:function(e){return _.get(this.items,e)}},{key:"groupBy",value:function(e){return this.items=_.groupBy(this.items,e),this}},{key:"has",value:function(e){return this.items.hasOwnProperty(e)}},{key:"implode",value:function(e,t){var n=e;return void 0===t&&(t=n,n=void 0),void 0!==n&&this.pluck(n),this.items.join(t)}},{key:"intersect",value:function(e){}},{key:"isEmpty",value:function(e){return 0==this.count()}},{key:"keyBy",value:function(e){return this.items=_.keyBy(this.items,e),this}},{key:"keys",value:function(){return e.collect(_.keys(this.items))}},{key:"last",value:function(){return _.last(this.values().all())}},{key:"map",value:function(e){}},{key:"max",value:function(e){return void 0!==e?_.maxBy(this.items,e):_.max(this.items)}},{key:"merge",value:function(e){return this.isObject()||(this.items=this.items.concat(e)),this}},{key:"min",value:function(e){return void 0!==e?_.minBy(this.items,e):_.min(this.items)}},{key:"only",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.items=_.pick(this.items,t),this}},{key:"pluck",value:function(e,t){return void 0===t?this.items=_.map(this.items,e):this.keyBy(t).transform(function(t){return t[e]}),this}},{key:"pop",value:function(){return this.items.pop()}},{key:"prepend",value:function(e){return this.items.unshift(e),this}},{key:"pull",value:function(){for(var e,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=_).pull.apply(e,[this.items].concat(n))}},{key:"push",value:function(e){this.items.push(e)}},{key:"put",value:function(e,t){this.items[e]=t}},{key:"random",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 1===e?_.sample(this.items):(this.items=_.sampleSize(this.items,e),this)}},{key:"reduce",value:function(e){}},{key:"reverse",value:function(){return this.items=_.reverse(this.items),this}},{key:"search",value:function(e,t){}},{key:"set",value:function(e,t){return this.items=_.set(this.items,e,t),this}},{key:"shift",value:function(){return this.values().all().shift()}},{key:"shuffle",value:function(){return this.items=_.shuffle(this.items),this}},{key:"slice",value:function(e,t){return this.items=_.slice(this.items,e,t),this}},{key:"sort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return tb.reflect(e).isBool()&&(t=e,e=void 0),void 0!==e?this.items=_.sortBy(this.items,e):tb.reflect(this.first()).isNumber()?this.items.sort(function(e,t){return e-t}):this.items.sort(),t?this.reverse():this}},{key:"splice",value:function(e,t,n){}},{key:"sum",value:function(e){return void 0!==e?_.sumBy(this.items,e):_.sum(this.items)}},{key:"take",value:function(e){return this.items=e>0?_.take(this.items,e):_.takeRight(this.items,e*-1),this}},{key:"toJson",value:function(){return JSON.stringify(this.items)}},{key:"transform",value:function(e){var t=this;return this.each(function(n,o){t.items[o]=e(n,o)}),t}},{key:"union",value:function(e){}},{key:"unique",value:function(e){var t,n=tb.reflect(e);switch(!0){case n.isUndefined():t="uniq";break;case n.isString():t="uniqBy";break;case n.isFunction():t="uniqWith"}return this.items=_[t](this.items,e),this}},{key:"values",value:function(){return e.collect(_.values(this.items))}},{key:"where",value:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.isCollection(),r=e.collect(i?[]:{});return this.each(function(e,a){if(i){if(i){var s=n===e[t];o&&(s=n==e[t]),s&&r.push(e)}}else{var s=t===a&&e===n;o&&(s=t==a&&e==n),s&&r.put(t,n)}}),r}},{key:"whereIn",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},{key:"zip",value:function(e){}},{key:"isFlatArray",value:function(){return tb.reflect(this.items).isArray()&&!tb.reflect(this.first()).isObject()}},{key:"isObject",value:function(){return tb.reflect(this.items).isObject()}},{key:"isCollection",value:function(){return tb.reflect(this.items).isArray()&&tb.reflect(this.first()).isObject()}}],[{key:"collect",value:function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return new(Function.prototype.bind.apply(e,[null].concat(n)))}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Link=function(){function e(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";_classCallCheck(this,e),this.location=document.location,this.host=this.location.host,this.protocol=this.location.protocol,this.port=this.location.port,this.domain=this.location.origin,this.path=this.location.pathname,this.queryString=this.location.search.substr(1);var t=this.queryString.split("&"),n=t.length-1,o=void 0;for(this.params={};n--;)o=t[n].split("="),this.params[o[0]]=o[1]}return _createClass(e,[{key:"hasParam",value:function(e){return this.params.hasOwnProperty(e)}},{key:"updateParam",value:function(e,t){var n=tb.reflect(t);n.isArray()&&(t=t.join(",")),this.params[e]=t;var o="?";for(var i in this.params)o+=i+"="+this.params[i]+"&";document.location.search=tb.str(o).rtrim("&")}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Log=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"__noSuchMethod__",value:function(e,t){var n;(n=console)[e].apply(n,_toConsumableArray(t))}}],[{key:"line",value:function(){var e;(e=console).log.apply(e,arguments)}},{key:"styled",value:function(e,t){var n="";tb.collect(t).each(function(e,t){n+=t+":"+e+";"}),console.log("%c"+e,n)}},{key:"debug",value:function(e){console.debug(e)}},{key:"info",value:function(e){console.info(e)}},{key:"warn",value:function(e){console.warn(e)}},{key:"error",value:function(e){console.error(e)}},{key:"table",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t=tb.collect(t),t.isEmpty()?console.table(e):(tb.reflect(t.first()).isArray()&&(t=t.transform(function(t){var n={};return tb.collect(t).each(function(t,o){n[e[o]]=t}),n})),void console.table(t.all(),e))}},{key:"clock",value:function(e,t){console.time(e),t(),console.timeEnd(e)}},{key:"group",value:function(e,t){var n=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console[o?"groupCollapsed":"group"](e),tb.collect(t).each(function(e){if(tb.reflect(e).isString())n.line(e);else{var t=tb.collect(e).keys().first();n[t].apply(n,_toConsumableArray(e[t]))}}),console.groupEnd()}},{key:"object",value:function(t,n){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=tb.collect(n).transform(function(t,n){return tb.reflect(t).isObject()?e.loggableData(n,t):n+": "+t}).all();e.group(t,i,o)}},{key:"object",value:function(t,n){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[];tb.collect(n).each(function(t,n){tb.reflect(t).isObject()?i.push(e.loggableObject(n,t)):i.push(n+": "+t)}),e.group(t,i,o)}},{key:"loggableObject",value:function(t,n){return{group:[t+": ",tb.collect(n).transform(function(t,n){return tb.reflect(t).isObject()?e.loggableObject(n,t):n+": "+t}).all()]}}}]),e}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Reflection=function(){function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"isArray",value:function(){return Array.isArray(this.value)}},{key:"isBool",value:function(){return"boolean"==typeof this.value}},{key:"isClass",value:function(e){return this.value instanceof e}},{key:"isFunction",value:function(){return"function"==typeof this.value}},{key:"isNumber",value:function(){return!isNaN(parseFloat(this.value))&&isFinite(this.value)}},{key:"isObject",value:function(){return"object"===_typeof(this.value)}},{key:"isString",value:function(){return"string"==typeof this.value}},{key:"isUndefined",value:function(){return void 0===this.value}}],[{key:"reflect",value:function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return new(Function.prototype.bind.apply(e,[null].concat(n)))}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Str=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";_classCallCheck(this,e),this.string=t}return _createClass(e,[{key:"camelCase",value:function(){return _.camelCase(this.string)}},{key:"titleCase",value:function(){return this.string.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}},{key:"snakeCase",value:function(){return _.snakeCase(this.string)}},{key:"studlyCase",value:function(){return _.upperFirst(this.camelCase())}},{key:"slug",value:function(){return _.kebabCase(this.string)}},{key:"random",value:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)this.string+=_.random(t);return this.string}},{key:"endsWith",value:function(e){
return _.endsWith(this.string,e)}},{key:"limit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"...";return _.truncate(this.string,{length:e,separator:/,? +/,omission:t})}},{key:"startsWith",value:function(e){return _.startsWith(this.string,e)}},{key:"contains",value:function(e){return this.string.indexOf(e)!==-1}},{key:"rtrim",value:function(e){return _.trimEnd(this.string,e)}},{key:"finish",value:function(){}},{key:"is",value:function(){}},{key:"singular",value:function t(){if(this.isSingularAndPlural())return this.string;var t={"(quiz)zes$":"$1","(matr)ices$":"$1ix","(vert|ind)ices$":"$1ex","^(ox)en$":"$1","(alias)es$":"$1","(octop|vir)i$":"$1us","(cris|ax|test)es$":"$1is","(shoe)s$":"$1","(o)es$":"$1","(bus)es$":"$1","([m|l])ice$":"$1ouse","(x|ch|ss|sh)es$":"$1","(m)ovies$":"$1ovie","(s)eries$":"$1eries","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","(tive)s$":"$1","(hive)s$":"$1","(li|wi|kni)ves$":"$1fe","(shea|loa|lea|thie)ves$":"$1f","(^analy)ses$":"$1sis","((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$":"$1$2sis","([ti])a$":"$1um","(n)ews$":"$1ews","(h|bl)ouses$":"$1ouse","(corpse)s$":"$1","(us)es$":"$1",s$:""};for(var n in e.IRREGULAR_PLURALIZATIONS){var o=new RegExp(e.IRREGULAR_PLURALIZATIONS[n]+"$","i"),i=n;if(o.test(this.string))return this.string.replace(o,i)}for(var r in t){var o=new RegExp(r,"i");if(o.test(this.string))return this.string.replace(o,t[r])}return this.string}},{key:"plural",value:function n(){if(this.isSingularAndPlural())return this.string;var n={"(quiz)$":"$1zes","^(ox)$":"$1en","([m|l])ouse$":"$1ice","(matr|vert|ind)ix|ex$":"$1ices","(x|ch|ss|sh)$":"$1es","([^aeiouy]|qu)y$":"$1ies","(hive)$":"$1s","(?:([^f])fe|([lr])f)$":"$1$2ves","(shea|lea|loa|thie)f$":"$1ves",sis$:"ses","([ti])um$":"$1a","(tomat|potat|ech|her|vet)o$":"$1oes","(bu)s$":"$1ses","(alias)$":"$1es","(octop)us$":"$1i","(ax|test)is$":"$1es","(us)$":"$1es","([^s]+)$":"$1s"};for(var t in e.IRREGULAR_PLURALIZATIONS){var o=new RegExp(t+"$","i"),i=e.IRREGULAR_PLURALIZATIONS[t];if(o.test(this.string))return this.string.replace(o,i)}for(var r in n){var o=new RegExp(r,"i");if(o.test(this.string))return this.string.replace(o,n[r])}return this.string}},{key:"isSingularAndPlural",value:function(){var e=tb.collect(["sheep","fish","deer","moose","series","species","money","rice","information","equipment"]);return e.contains(this.string.toLowerCase())}}]),e}();Str.IRREGULAR_PLURALIZATIONS={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"},tb.carbon=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(Carbon,[null].concat(t)))},tb.collect=function(){var e;return(e=Collection).collect.apply(e,arguments)},tb.reflect=function(){var e;return(e=Reflection).reflect.apply(e,arguments)},tb.str=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(Str,[null].concat(t)))},tb.url=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(Link,[null].concat(t)))};var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),toolbox={app:null},App=function(){function e(t,n){_classCallCheck(this,e),this.name=t,this.loaded=!1,this.bound={angular:n},this.bind("events",tb.collect({})),this.bind("middleware",tb.collect({})),Event.boot(this),Request.boot(this)}return _createClass(e,[{key:"boot",value:function(){return Auth.boot(this),this.navigator=Navigator.boot(),Auth.resolve(),this}},{key:"load",value:function(){var e=this;return e.navigator.load(),e.bound.angular.$injector.get("$timeout")(function(){e.loaded=!0},500),e}},{key:"resolve",value:function(e){if(e.indexOf(".")===-1)return this.bound[e];var t=tb.collect(this.bound).get(e);if(!t)throw"Cannot resolve "+e+" from app";return t}},{key:"bind",value:function(e,t){return e.indexOf(".")===-1?(this.bound[e]=t,this):(this.bound=tb.collect(this.bound).set(e,t),this)}},{key:"bindEvent",value:function(e,t){var n=Event.all();Event.exists(e.name)||n.put(e.name,[]);var o=n.get(e.name);return o=o.concat(e.listeners),n.put(e.name,o),this}},{key:"bindMiddleware",value:function(e){var t=Middleware.all();return Middleware.exists(e.name)||t.put(e.name,e),this}},{key:"config",value:function(e){return tb.collect(this.resolve("angular.config")).get(e)}}],[{key:"instance",value:function(){return toolbox.app}},{key:"make",value:function(t,n){return toolbox.app=new e(t,n),toolbox.app}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Auth=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"user",value:function(){return e.current}},{key:"exists",value:function(){var t=e.user();return void 0!==t&&null!==t&&!tb.collect(t).isEmpty()}},{key:"resolve",value:function(){Request.api("users/current").get({always:function(e){Event.fire("auth:load",e?e.auth:null),ngTB.app("angular.$injector").get("$timeout")(function(){ngTB.app().load()},500)}})}},{key:"login",value:function(e,t){Request.api("authenticate").bind(e).post({success:function(e){Event.fire("auth:login",e?e.auth:null)},error:t})}},{key:"logout",value:function(){Request.api("logout").post({always:function(t){e.set(),Event.fire("auth:logout")}})}},{key:"boot",value:function(){Event.listen(["auth:load","auth:login","auth:logout"])}},{key:"set",value:function(t){return e.current=t,ngTB.app("angular.$scope").auth=e.current,e}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Event=function(){function e(t,n){_classCallCheck(this,e),this.name=t,void 0===n&&(n=[]),this.listeners=n,e.app.bindEvent(this)}return _createClass(e,null,[{key:"all",value:function(){return tb.collect(e.app.resolve("events"))}},{key:"get",value:function(t){return e.all().get(t)}},{key:"exists",value:function(t){return e.all().has(t)}},{key:"fire",value:function(t,n){if(!e.exists(t))throw"Event with name, "+t+", does not exist";tb.collect(e.all().get(t)).each(function(e,t){e(n)})}},{key:"boot",value:function(t){e.app=t}},{key:"listen",value:function(t,n){if(tb.reflect(t).isString())return new e(t,n);if(tb.reflect(t).isArray()){var o=tb.collect([]);return tb.collect(t).each(function(t,n){tb.reflect(t).isString()&&(n=t,t=void 0),o.push(e.listen(n))}),o}}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Middleware=function(){function e(t,n){_classCallCheck(this,e),this.name=t,this.options=tb.collect(n),this.options.has("before")&&(this.before=this.options.get("before")),this.options.has("after")&&(this.after=this.options.get("after")),ngTB.app().bindMiddleware(this)}return _createClass(e,[{key:"applyBefore",value:function(){if(this.before)return this.before(Request.capture())}},{key:"applyAfter",value:function(){if(this.after)return this.after(Request.capture())}}],[{key:"make",value:function(t,n){return new e(t,n)}},{key:"all",value:function(){return ngTB.app("middleware")}},{key:"exists",value:function(t){return e.all().has(t)}},{key:"get",value:function(t){return e.all().get(t)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),MobileDevice=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){this.loaded=!1}},{key:"onLoad",value:function(e){this.onLoadHandler=e,this.hasLoaded()&&this.onLoadHandler(this)}},{key:"injector",value:function(){if(!this.hasLoaded())return!1;var e=App.instance();return!!e&&e.resolve("angular.$injector")}},{key:"cordovaDevice",value:function(){return this.injected("$cordovaDevice")}},{key:"cordovaGeolocation",value:function(){return this.injected("$cordovaGeolocation")}},{key:"cordovaPush",value:function(){return this.injected("$cordovaPushV5")}},{key:"cordovaBadge",value:function(){return this.injected("$cordovaBadge")}},{key:"cordovaKeyboard",value:function(){return this.injected("$cordovaKeyboard")}},{key:"injected",value:function(e){var t=this.injector();return!!t&&t.get(e)}},{key:"hasLoaded",value:function(){return this.loaded}},{key:"updateBadgeNumber",value:function(e){if(!this.hasLoaded())return!1;var t=this.cordovaBadge();return!!t&&void t.set(e).then(function(){},function(e){})}},{key:"resolve",value:function(){this.loaded=!0;var e=this.cordovaDevice();return!!e&&(this.device=e.getDevice(),this.cordova=e.getCordova(),this.model=e.getModel(),this.platform=e.getPlatform(),this.uuid=e.getUUID(),this.version=e.getVersion(),void 0)}},{key:"info",value:function(){return{device:this.device,cordova:this.cordova,model:this.model,platform:this.platform,uuid:this.uuid,version:this.version}}},{key:"disableKeyboardAutoScroll",value:function(){var e=this.cordovaKeyboard();return!!e&&(e.disableScroll(!0),!0)}},{key:"registerForPushNotifications",value:function(){var e=this,t=this.cordovaPush(),n={android:{senderID:App.instance().config("APP.NOTIFICATIONS.ANDROID_SENDER_ID")},ios:{alert:"true",badge:"true",sound:"true"}};return!!t&&(t.initialize(n).then(function(){t.onNotification(),t.onError(),t.register().then(function(t){e.token=t,Log.object("Device push token found",e),Request.api("mobile-device/update").bind({type:e.platform,token:e.token})})}),App.instance().resolve("angular.$scope").$on("$cordovaPushV5:notificationReceived",function(t,n){if(Log.object("Device push notification received",n),n.additionalData.notifiers&&n.additionalData.notifiers.total&&e.updateBadgeNumber(n.additionalData.notifiers.total),!n.additionalData.foreground)return App.instance().resolve("angular.$state").go(n.additionalData.route.name,n.additionalData.route.params)}),App.instance().resolve("angular.$scope").$on("$cordovaPushV5:errorOcurred",function(e,t){console.log(t)}),!0)}},{key:"isAppleDevice",value:function(){return!!this.hasLoaded()&&"iOS"===this.platform}},{key:"isAndroidDevice",value:function(){return!!this.hasLoaded()&&("platform: Android"===this.platform||"Android"===this.platform)}},{key:"permissions",value:function(){return!("undefined"==typeof cordova||!cordova.hasOwnProperty("plugins")||!cordova.plugins.hasOwnProperty("permissions"))&&cordova.plugins.permissions}},{key:"needsPermission",value:function(){return this.hasLoaded()&&this.permissions()&&this.isAndroidDevice()}},{key:"checkForContactsPermission",value:function(e,t){return this.checkForPermission("READ_CONTACTS",e,t)}},{key:"checkForLocationPermission",value:function(e,t){return this.checkForPermission("ACCESS_FINE_LOCATION",e,t)}},{key:"checkForCameraPermission",value:function(e,t){return this.checkForPermission("CAMERA",e,t)}},{key:"checkForPermission",value:function(e,t,n){return this.needsPermission()?void this.permissions().requestPermission(this.permissions()[e],function(e){e.hasPermission?t():n()},n):t()}}],[{key:"boot",value:function(){document.addEventListener("deviceready",function(){var t=e.current;t.resolve(),t.onLoadHandler&&t.onLoadHandler(t)})}}]),e}();MobileDevice.current=new MobileDevice;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Time=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"cancel",value:function(){this.hasOwnProperty("timeout")&&ngTB.app("angular.$injector").get("$timeout").cancel(this.timeout)}}],[{key:"delay",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=new e;return o.timeout=ngTB.app("angular.$injector").get("$timeout")(function(){t()},1e3*n),o}},{key:"repeat",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:1}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Toast=function(){function e(t,n){_classCallCheck(this,e),this.type=tb.collect(t).keys().first(),this.message=t[this.type],this.show(n)}return _createClass(e,[{key:"show",value:function(t){var n=this;void 0===t&&(t=0),setTimeout(function(){ngTB.app("angular.$mdToast").show({template:n.template(),position:e.POSITION,hideDelay:e.HIDE_DELAY})},t)}},{key:"iconClass",value:function(){switch(this.type){case"success":return"fa-check";case"info":return"fa-info";case"error":return"fa-times"}}},{key:"bgColorClass",value:function(){switch(this.type){case"success":case"info":return"bg-"+this.type+" text-white";case"error":return"bg-danger text-white";case"loading":return"bg-primary"}}},{key:"templateWrapper",value:function(e){return'<md-toast class="'+this.bgColorClass()+'">'+e+"</md-toast>"}},{key:"template",value:function(){return"loading"===this.type?this.loadingTemplate():this.templateWrapper('<i class="fa '+this.iconClass()+' " style="margin-right:20px;font-size:18px;"></i><span flex>'+this.message+"</span>")}},{key:"loadingTemplate",value:function(){return this.templateWrapper('<md-progress-circular md-theme="white" class="md-default" md-mode="indeterminate" md-diameter="20px"></md-progress-circular><span flex>'+this.message+"</span>")}}],[{key:"flash",value:function(t,n){return new e(t,n)}}]),e}();Toast.POSITION="bottom right",Toast.HIDE_DELAY=5e4;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),ngTB=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"app",value:function(e){return void 0===e?App.instance():App.instance().resolve(e)}},{key:"auth",value:function(){return Auth}},{key:"time",value:function(){return Time}},{key:"event",value:function(e,t){Event.fire(e,t)}},{key:"nav",value:function(){return e.app("navigator")}},{key:"request",value:function(){return Request.capture()}},{key:"image",value:function(t){return e.app().config("APP.PATHS.IMAGES")+t}},{key:"link",value:function(t){return e.app().config("APP.PATHS.LINKS."+t)}},{key:"text",value:function(t){var n=t.split("."),o=e.app("angular.$injector").get(n[0]+="_TEXT");n.shift();var i=tb.collect(o).get(n.join("."));return tb.reflect(i).isArray()?i.join("<br>"):i}},{key:"view",value:function(t){return e.app().config("APP.PATHS.VIEWS")+t.replace(/\./g,"/")+".html"}},{key:"bindToScope",value:function(t){t.$app=e.app,t.$nav=e.nav,t.$request=e.request,t.$image=e.image,t.$link=e.link,t.$text=e.text,t.$view=e.view,t.$carbon=tb.carbon,t.$collect=tb.collect,t.$reflect=tb.reflect,t.$str=tb.str}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Request=function(){function e(t){_classCallCheck(this,e),this.url=t,this.params={},this.parseStateParams()}return _createClass(e,[{key:"bind",value:function(e){return this.params=angular.copy(e),this}},{key:"parseStateParams",value:function(){if(this.url){ngTB.app("angular.$stateParams")}}},{key:"get",value:function(t){this.method=e.METHOD_GET;var n=this;return tb.collect(this.params).each(function(e,t){var o=tb.str(n.url).contains("?")?"&":"?";n.url+=o+t+"="+e}),n.submit(t),e}},{key:"post",value:function(t){return this.method=e.METHOD_POST,this.submit(t),e}},{key:"submit",value:function(t){Event.fire("request:"+this.method+":start",{request:this}),this.shouldLog()&&this.logRequest();var n=this;return ngTB.app("angular.$http")[this.method](this.url,this.params).success(function(e,o,i,r){n.handle(t,e,Response.TYPE_SUCCESS,o)}).error(function(e,o,i,r){n.handle(t,e,Response.TYPE_ERROR,o)}),e}},{key:"loggable",value:function(){var e=this;return{Method:e.method,Route:e.url,Params:angular.copy(e.params)}}},{key:"logRequest",value:function(){var e=this;Log.object("API CALL",e.loggable())}},{key:"logResponse",value:function(e,t){var n=this;Log.object("API RESPONSE",{Request:n.loggable(),Data:e,StatusCode:t})}},{key:"handle",value:function(e,t,n,o){this.shouldLog()&&this.logResponse(angular.copy(t),angular.copy(o));var i=Response.make(e,n,t,o);Event.fire("request:"+this.method+":"+n,{request:this,message:i.message,data:i.data}),i.handle(),i.handle("always")}},{key:"shouldLog",value:function(){return ngTB.app().config("APP.TESTING.HIDE_API_REQUESTS")!==!0}}],[{key:"on",value:function(t,n){return Event.listen("request:"+t,n),e}},{key:"make",value:function(t){return new e(t)}},{key:"capture",value:function(){var t=ngTB.app("angular.$state"),n=e.make(t.url);return n.state=t,n.params=ngTB.app("angular.$stateParams"),n.auth=Auth.user(),n}},{key:"boot",value:function(e){Event.listen(["request:get:start","request:get:success","request:get:error","request:get:empty","request:post:start","request:post:success","request:post:error"])}},{key:"apiBase",value:function(){var e=ngTB.app(),t=e.config("APP.API.URL");if(e.config("APP.API.USE_LOCALLY"))return t;var n=e.config("APP.API.REQUEST_FROM_SERVER");return e.config("APP.API."+n+"_SERVER_URL")+t}},{key:"api",value:function(t){return new e(e.apiBase()+t)}}]),e}();Request.METHOD_GET="get",Request.METHOD_POST="post";var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Response=function(){function e(t,n,o,i){_classCallCheck(this,e),this.actions=tb.collect(t),this.type=n,tb.reflect(o).isObject()&&(this.data=o[this.type]?o[this.type].data:o,this.message=o[this.type]?o[this.type].message:void 0),this.status=i}return _createClass(e,[{key:"handle",value:function(t){if(void 0===t&&(t=this.type),this.actions.has(t)){var n=this.actions.get(t);tb.reflect(n).isString()&&n===e.MESSAGE&&(n=500===this.status?"Something went wrong... Please try again.":this.message);var o=e.parseHandler(t,n);o||n(this.data,this.message,this.status)}}}],[{key:"make",value:function(t,n,o,i){return new e(t,n,o,i)}},{key:"preHandle",value:function(t,n,o){var i=t[n];return t[n]=function(){var t=o.apply(void 0,arguments),r=e.parseHandler(n,i);r||i(t)},t}},{key:"parseHandler",value:function(e,t){var n=tb.reflect(t);if(n.isFunction())return!1;if(n.isObject())Toast.flash(t);else if(n.isString()){var o={};o[e]=t,Toast.flash(o)}return!0}}]),e}();Response.TYPE_SUCCESS="success",Response.TYPE_ERROR="error",Response.MESSAGE="tb:request:response";var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),NavigatorHistory=function(){function e(){_classCallCheck(this,e),this.items=tb.collect([])}return _createClass(e,[{key:"add",value:function(e,t){if(""!==e.name){var n=this.last();return n&&n.name===e&&collect(t).equals(n.params)?void this.items.pop():void this.items.push({name:e.name,params:t})}}},{key:"length",value:function(){return this.items.count()}},{key:"all",value:function(){return this.items}},{key:"last",value:function(){return this.items.last()}}],[{key:"make",value:function(){return new e}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),Navigator=function(){function e(){_classCallCheck(this,e),this.history=NavigatorHistory.make(),ngTB.app().bind("navigator",this)}return _createClass(e,[{key:"update",value:function(e,t,n,o,i){var r=this.middleware(t),a=this.apply(r,"Before");return console.log(t.name,r,a),!ngTB.app().loaded&&t.name&&a===!1?(this.intendedState={name:t.name,params:n},e.preventDefault(),!1):a===!1?(e.preventDefault(),!1):(this.handleChange({state:t,params:n},{state:o,params:i}),void this.apply(r,"After"))}},{key:"on",value:function(e,t){Event.listen("navigation:"+e,t)}},{key:"redirect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ngTB.app("angular.$state").go(e,t,{reload:n})}},{key:"intended",value:function(e,t){this.intendedState&&(e=this.intendedState.name,t=this.intendedState.params),this.redirect(e,t)}},{key:"back",value:function(){var e=this.history.last();this.redirect(e.name,e.params)}},{key:"middleware",value:function(e){if(!e)return!1;var t=tb.collect(e.hasOwnProperty("middleware")?e.middleware:{});return t}},{key:"apply",value:function(e,t){if(!e)return!0;var n=!0;return e.each(function(e){n=Middleware.get(e)["apply"+t](),!n}),n}},{key:"handleChange",value:function(e,t){var n=this.history.length();this.history.add(t.state,t.params);var o=this.history.length()<n?"back":"new";ngTB.event("navigation:change",{to:e,from:t}),ngTB.event("navigation:change:"+o,{to:e,from:t})}},{key:"load",value:function(){var e=this;ngTB.app("angular.$scope").$on("$stateChangeStart",function(t,n,o,i,r){console.log(e.history),e.update(t,n,o,i,r),console.log(i),console.log(n),console.log(e.history)})}}],[{key:"make",value:function(){return new e}},{key:"boot",value:function(){var t=e.make();return Event.listen(["navigation:change","navigation:change:back","navigation:change:new"]),t}}]),e}();angular.module("ng-toolbox",[]),function(){function e(e){return{restrict:"A",link:function(t,n,o){var i=n.text();e(function(){tb.str(i).endsWith("...")?i=tb.str(i).rtrim("..."):i+=".",n.text(i)},400)}}}angular.module("ng-toolbox").directive("ngLoadingEllipses",e),e.$inject=["$interval"]}(),function(){function e(e){return{restrict:"A",link:function(t,n,o){t.$watch(e.parseAsHtml(o.ngTrustHtml),function(e){n.html(e||"")})}}}angular.module("ng-toolbox").directive("ngTrustHtml",e),e.$inject=["$sce"]}(),function(){function e(e){return{restrict:"A",link:function(t,n,o){e(function(){n[0].focus()})}}}angular.module("ng-toolbox").directive("ngAutofocus",e),e.$inject=["$timeout"]}(),function(){function e(){return{restrict:"A",link:function(e,t,n){t.bind("load",function(){null!==n.imageonload&&e.$apply(n.imageonload)}),t.bind("error",function(){angular.element(this).attr("src",n.fallbacksrc)})}}}angular.module("ng-toolbox").directive("imageonload",e)}(),function(){function e(e){return{restrict:"A",scope:!1,link:function(t,n,o){var i=e(o.onReadFile);n.on("change",function(e){var n=new FileReader;n.onload=function(e){t.$apply(function(){i(t,{$fileContent:e.target.result})})},n.readAsDataURL((e.srcElement||e.target).files[0])})}}}angular.module("ng-toolbox").directive("onReadFile",e),e.$inject=["$parse"]}(),function(){function e(e,t){return{restrict:"E",replace:!0,scope:!0,template:'<div id="imageLoader" ><div class="thumbloader"></div></div>',link:function(n,o,i){function r(){t(function(){u&&(c=300),$(o[0]).css("z-index","50"),$(l).removeClass("ng-hide"),$(l).addClass("fadeIn"),a()})}function a(){t(function(){s()},2*c)}function s(){t(function(){$(o[0]).remove(),n.$destroy()},10*c)}var c=150,u=!1;t(function(){u=!u},500);var l=o[0].nextElementSibling;if($(l).addClass("ng-hide"),"undefined"!=i.imagesrc){var d=new Image;d.src=i.imagesrc,d.onload=r()}else $(l).bind("load",r());$(l).onerror=function(){this.src=e.PATHS.IMAGES+"logos/logo.png"}}}}angular.module("ng-toolbox").directive("thumbnailProgress",e),e.$inject=["APP_CONFIG","$timeout"]}();